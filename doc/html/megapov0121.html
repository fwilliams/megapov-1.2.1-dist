<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>MegaPOV Documentation</title><link rel="stylesheet" href="megapov.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><meta name="description" content="
      This documentation contains a complete set of information about MegaPOV.
      Here you can find descriptions from either script and patch writer point
      of view. This work is supposed to be an addition to complete the POV-Ray Documentation.
    "></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="id2437388"></a>MegaPOV Documentation</h1></div><div><h2 class="subtitle">
    <img src="img/titlepage.png">
  </h2></div><div><div class="author"><h3 class="author"><span class="surname">MegaPOV-Team</span></h3><div class="affiliation"><div class="address"><p><tt class="email">&lt;<a href="mailto:megapov@megapov.inetart.net">megapov@megapov.inetart.net</a>&gt;</tt></p></div></div></div></div><div><p class="releaseinfo">MegaPOV 1.2.1</p></div><div><p class="copyright">Copyright © 2002-2005 MegaPOV-Team</p></div><div><p class="pubdate">24 August 2005</p></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
      This documentation contains a complete set of information about MegaPOV.
      Here you can find descriptions from either script and patch writer point
      of view. This work is supposed to be an addition to complete the <a href="http://www.povray.org/documentation/" target="_top"><span class="trademark">POV-Ray</span>&#8482; Documentation</a>.
    </p></div></div></div><div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#introduction">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#what">1.1. What is MegaPOV?</a></span></dt><dt><span class="section"><a href="#news">1.2. What's new</a></span></dt><dd><dl><dt><span class="section"><a href="#latest_changes">1.2.1. MegaPOV 1.2.1 - 24 August 2005</a></span></dt><dt><span class="section"><a href="#id2438813">1.2.2. MegaPOV 1.2 - 4 July 2005</a></span></dt><dt><span class="section"><a href="#id2436923">1.2.3. Previous versions of MegaPOV</a></span></dt></dl></dd><dt><span class="section"><a href="#why">1.3. Why should i use MegaPOV?</a></span></dt><dt><span class="section"><a href="#enable">1.4. Enabling MegaPOV features</a></span></dt><dt><span class="section"><a href="#where">1.5. Where do I find MegaPOV?</a></span></dt><dd><dl><dt><span class="section"><a href="#id2437092">1.5.1. Sources and binaries</a></span></dt><dt><span class="section"><a href="#id2437126">1.5.2. Documentation and samples</a></span></dt><dt><span class="section"><a href="#discussion">1.5.3. Discussions</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#references">2. MegaPOV References</a></span></dt><dd><dl><dt><span class="section"><a href="#options">2.1. Options</a></span></dt><dd><dl><dt><span class="section"><a href="#frame_step">2.1.1. Frame_Step</a></span></dt><dt><span class="section"><a href="#hdr_write">2.1.2. HDR (High Dynamic Range) image output</a></span></dt></dl></dd><dt><span class="section"><a href="#expressions">2.2. Expressions</a></span></dt><dd><dl><dt><span class="section"><a href="#id2499336">2.2.1. Language directives</a></span></dt><dt><span class="section"><a href="#tokens">2.2.2. Built-in tokens</a></span></dt><dt><span class="section"><a href="#functions">2.2.3. Functions</a></span></dt><dt><span class="section"><a href="#internal_functions">2.2.4. Internal functions</a></span></dt><dt><span class="section"><a href="#polynomial_solver">2.2.5. Polynomial solver in parser</a></span></dt><dt><span class="section"><a href="#splines">2.2.6. Splines</a></span></dt><dt><span class="section"><a href="#transforms">2.2.7. Transforms</a></span></dt></dl></dd><dt><span class="section"><a href="#camera">2.3. Camera</a></span></dt><dd><dl><dt><span class="section"><a href="#user_defined_camera">2.3.1. user_defined camera type</a></span></dt></dl></dd><dt><span class="section"><a href="#objects">2.4. Objects</a></span></dt><dd><dl><dt><span class="section"><a href="#common_features">2.4.1. Common features</a></span></dt><dt><span class="section"><a href="#text">2.4.2. Text</a></span></dt><dt><span class="section"><a href="#cloth">2.4.3. Cloth simulation</a></span></dt><dt><span class="section"><a href="#isosurface">2.4.4. Isosurface</a></span></dt><dt><span class="section"><a href="#light">2.4.5. Light Sources</a></span></dt></dl></dd><dt><span class="section"><a href="#effects">2.5. Effects</a></span></dt><dd><dl><dt><span class="section"><a href="#glow">2.5.1. Glow</a></span></dt><dt><span class="section"><a href="#motion_blur">2.5.2. Motion blur</a></span></dt><dt><span class="section"><a href="#fur">2.5.3. Fur</a></span></dt></dl></dd><dt><span class="section"><a href="#patterns">2.6. Textures and patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#aoi_pattern">2.6.1. Angle of incidence</a></span></dt><dt><span class="section"><a href="#listed_pattern">2.6.2. Listed pattern</a></span></dt><dt><span class="section"><a href="#projection_pattern">2.6.3. Projection pattern</a></span></dt><dt><span class="section"><a href="#displace_warp">2.6.4. Displace warp for patterns</a></span></dt><dt><span class="section"><a href="#noisepigment">2.6.5. Noise pigment</a></span></dt><dt><span class="section"><a href="#hdr">2.6.6. HDR (High Dynamic Range) image type</a></span></dt><dt><span class="section"><a href="#bicubic_image">2.6.7. Bicubic interpolation for images</a></span></dt><dt><span class="section"><a href="#camera_view">2.6.8. New camera_view pigment</a></span></dt></dl></dd><dt><span class="section"><a href="#global_settings">2.7. Global Settings</a></span></dt><dd><dl><dt><span class="section"><a href="#film_exposure">2.7.1. Film exposure simulation</a></span></dt><dt><span class="section"><a href="#tone_mapping">2.7.2. Custom tone mapping function</a></span></dt><dt><span class="section"><a href="#radiosity">2.7.3. Radiosity</a></span></dt><dt><span class="section"><a href="#mechsim">2.7.4. Mechanics simulation patch</a></span></dt><dt><span class="section"><a href="#post_processing">2.7.5. Post processing</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#include">3. MegaPOV Include files</a></span></dt><dd><dl><dt><span class="section"><a href="#mp_functions.inc">3.1. The 'mp_functions.inc' include file</a></span></dt><dt><span class="section"><a href="#mp_consts.inc">3.2. The 'mp_consts.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#mp_consts_camera_view">3.2.1. Output types for camera_view pigment</a></span></dt></dl></dd><dt><span class="section"><a href="#mp_types.inc">3.3. The 'mp_types.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#id2553742">3.3.1. The Type_Of(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555017">3.3.2. The Type_Of_Spline(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555084">3.3.3. The Type_Of_Object(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555156">3.3.4. The Type_Of_Camera(Id) macro</a></span></dt></dl></dd><dt><span class="section"><a href="#mechsim.inc">3.4. The 'mechsim.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#mechsim_inc_general">3.4.1. general aspects</a></span></dt><dt><span class="section"><a href="#mechsim_inc_const">3.4.2. constants</a></span></dt><dt><span class="section"><a href="#mechsim_inc_vector_function">3.4.3. The Vector_Function() macro</a></span></dt><dt><span class="section"><a href="#mechsim_inc_object">3.4.4. The Object generation macros</a></span></dt><dt><span class="section"><a href="#mechsim_inc_topology">3.4.5. The topology generation macros</a></span></dt></dl></dd><dt><span class="section"><a href="#inc_pprocess.inc">3.5. The 'pprocess.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#post_proc_macros">3.5.1. Macros with effects</a></span></dt><dt><span class="section"><a href="#shared_effects">3.5.2. Shared predefined effects</a></span></dt></dl></dd><dt><span class="section"><a href="#tone_mapping.inc">3.6. The 'tone_mapping.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#id2567246">3.6.1. The Clip_Colors() macro</a></span></dt><dt><span class="section"><a href="#id2568434">3.6.2. The Film_Exposure() macro</a></span></dt><dt><span class="section"><a href="#id2568502">3.6.3. The Film_Exposure_Invert() macro</a></span></dt><dt><span class="section"><a href="#id2568567">3.6.4. The Gamma_Correct() macro</a></span></dt><dt><span class="section"><a href="#id2568630">3.6.5. The Brightness_Contrast() macro</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#tutorials">4. Tutorials</a></span></dt><dd><dl><dt><span class="section"><a href="#tutorials_objects">4.1. Objects</a></span></dt><dd><dl><dt><span class="section"><a href="#id2573903">4.1.1. Cloth simulation</a></span></dt></dl></dd><dt><span class="section"><a href="#tutorials_simulation">4.2. Simulation</a></span></dt><dd><dl><dt><span class="section"><a href="#mechsim_tutorial">4.2.1. Mechanics simulation tutorial</a></span></dt></dl></dd><dt><span class="section"><a href="#tutorials_hdri">4.3. HDRI (High dynamic range illumination)</a></span></dt><dd><dl><dt><span class="section"><a href="#hdri_tutorial">4.3.1. HDRI tutorial</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#internals">5. Internals</a></span></dt><dd><dl><dt><span class="section"><a href="#sources">5.1. Sources</a></span></dt><dd><dl><dt><span class="section"><a href="#architecture">5.1.1. Understanding the POV-Ray source structure</a></span></dt><dt><span class="section"><a href="#patching">5.1.2. Creating your own patches</a></span></dt></dl></dd><dt><span class="section"><a href="#binaries">5.2. Binaries</a></span></dt><dd><dl><dt><span class="section"><a href="#windows_compile">5.2.1. compiling on Windows systems</a></span></dt><dt><span class="section"><a href="#mac_compile">5.2.2. compiling on Macintosh systems</a></span></dt><dt><span class="section"><a href="#unix_compile">5.2.3. compiling on Unix systems</a></span></dt></dl></dd><dt><span class="section"><a href="#parser">5.3. Parser</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_tokens">5.3.1. Adding tokens</a></span></dt></dl></dd><dt><span class="section"><a href="#internals_patterns">5.4. Patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_mem_patterns">5.4.1. Reducing memory usage</a></span></dt></dl></dd><dt><span class="section"><a href="#internals_expressions">5.5. Expressions</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_polynomials">5.5.1. Polynomial solver</a></span></dt></dl></dd><dt><span class="section"><a href="#multiformat_documentation">5.6. Multi-format Documentation with DocBook</a></span></dt><dd><dl><dt><span class="section"><a href="#docbook_environment">5.6.1. Environment for DocBook documentation</a></span></dt><dt><span class="section"><a href="#docbook_editing">5.6.2. Editing DocBook documentation</a></span></dt><dt><span class="section"><a href="#docbook_conversion">5.6.3. Converting DocBook documents</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#appendices">6. Appendices</a></span></dt><dd><dl><dt><span class="section"><a href="#megapov_authors">6.1. MegaPOV-Team</a></span></dt><dt><span class="section"><a href="#contribution">6.2. Contribution</a></span></dt><dt><span class="section"><a href="#old_megapov">6.3. MegaPOV before POV-Ray 3.6</a></span></dt><dd><dl><dt><span class="section"><a href="#id2600959">6.3.1. MegaPOV history</a></span></dt><dt><span class="section"><a href="#old_authors">6.3.2. Authors of patches in MegaPOV below version 1.0</a></span></dt></dl></dd></dl></dd><dt><span class="index"><a href="#megapov_index">Index</a></span></dt></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>2.1. <a href="#id2526851">Force based environment collisions illustration</a></dt><dt>2.2. <a href="#id2526910">Impact based environment collisions illustration</a></dt><dt>2.3. <a href="#id2527077">Mass-mass collisions illustration</a></dt><dt>2.4. <a href="#id2527095">Mass-face collisions illustration</a></dt><dt>2.5. <a href="#id2527112">Connection-connection collisions illustration</a></dt><dt>3.1. <a href="#id2560478">patch connection numbers</a></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>2.1. <a href="#id2501699">The following time formatting strings are available:</a></dt><dt>2.2. <a href="#id2519204">HDR image ambient variations</a></dt><dt>2.3. <a href="#id2520929">Exposure influence comparison</a></dt><dt>2.4. <a href="#id2521418">internal sequence</a></dt><dt>2.5. <a href="#id2521534">halton sequence</a></dt><dt>3.1. <a href="#id2557362">MechSim_Show_Grid() variations</a></dt><dt>3.2. <a href="#id2557746">MechSim_Show_Patch() variations</a></dt><dt>3.3. <a href="#id2558703">MechSim_Show_Patch() variations</a></dt><dt>4.1. <a href="#id2582523">Example for high dynamic range of raytraced scene</a></dt><dt>4.2. <a href="#id2582636">Views and illumination maps from the scene</a></dt><dt>4.3. <a href="#id2582734">The illumination maps being used in a scene</a></dt><dt>6.1. <a href="#id2598230">Current MegaPOV-Team Members</a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>2.1. <a href="#id2499847">Influence of Frame_Step on generated files</a></dt><dt>2.2. <a href="#id2499366">Using the #set directive</a></dt><dt>2.3. <a href="#id2501642">date function usage</a></dt><dt>2.4. <a href="#id2501537">Using the timer function</a></dt><dt>2.5. <a href="#id2501223">Averaging frames with output_filename function</a></dt><dt>2.6. <a href="#id2507860">Polynomial solver usage</a></dt><dt>2.7. <a href="#id2506293">Conversion from the sor object definition to the sor_spline type in spline</a></dt><dt>2.8. <a href="#id2511852">Alternative forms of user_defined camera type definition</a></dt><dt>2.9. <a href="#id2519179">HDR image example</a></dt><dt>2.10. <a href="#id2519018">Bicubic interpolation for an image map</a></dt><dt>2.11. <a href="#id2521004">Various values for film exposure simulations</a></dt><dt>2.12. <a href="#id2520810">Exponential tone mapping</a></dt><dt>2.13. <a href="#id2526500">Adaptive time stepping</a></dt><dt>2.14. <a href="#id2527253">An example for a complete collision{} section:</a></dt><dt>2.15. <a href="#id2528291">Mass interaction</a></dt><dt>2.16. <a href="#id2528416">Constant downward force in Mechanics simulation</a></dt><dt>2.17. <a href="#id2528522">Attachment in Mechanics simulation</a></dt><dt>2.18. <a href="#id2529508">The simulation data file format</a></dt><dt>2.19. <a href="#id2534727">The internal post process function asking for red color at the middle of image</a></dt><dt>2.20. <a href="#id2534858">Post processing which does nothing (only duplicate the original image)</a></dt><dt>2.21. <a href="#id2535014">Post processing which turns the rendered image into a gray scale image</a></dt><dt>3.1. <a href="#id2556810">MechSim_Show_Objects() macro usage</a></dt><dt>3.2. <a href="#id2557036">MechSim_Show_All_Objects() macro usage</a></dt><dt>3.3. <a href="#id2557321">MechSim_Show_Grid() macro usage</a></dt><dt>3.4. <a href="#id2557706">MechSim_Show_Patch() macro usage</a></dt><dt>3.5. <a href="#id2558057">MechSim_Show_Sphere() macro usage</a></dt><dt>3.6. <a href="#id2558338">VE_Elements array generation</a></dt><dt>3.7. <a href="#id2558833">MechSim_Generate_Grid_Fn() macro usage</a></dt><dt>3.8. <a href="#id2559157">MechSim_Generate_Grid() macro usage</a></dt><dt>3.9. <a href="#id2559477">MechSim_Generate_Grid_Std() macro usage</a></dt><dt>3.10. <a href="#id2559797">MechSim_Generate_Box() macro usage</a></dt><dt>3.11. <a href="#id2560134">MechSim_Generate_Block() macro usage</a></dt><dt>3.12. <a href="#id2560495">MechSim_Generate_Patch() macro usage</a></dt><dt>3.13. <a href="#id2560820">MechSim_Generate_Patch_Std() macro usage</a></dt><dt>3.14. <a href="#id2561068">MechSim_Generate_Line() macro usage</a></dt><dt>3.15. <a href="#id2561279">MechSim_Generate_Line() macro usage</a></dt><dt>3.16. <a href="#id2561512">MechSim_Generate_Sphere() macro usage</a></dt><dt>3.17. <a href="#id2567694">Find edge macro</a></dt><dt>5.1. <a href="#id2588585">Typical patch markup</a></dt></dl></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="introduction"></a>Chapter 1. Introduction</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#what">1.1. What is MegaPOV?</a></span></dt><dt><span class="section"><a href="#news">1.2. What's new</a></span></dt><dd><dl><dt><span class="section"><a href="#latest_changes">1.2.1. MegaPOV 1.2.1 - 24 August 2005</a></span></dt><dt><span class="section"><a href="#id2438813">1.2.2. MegaPOV 1.2 - 4 July 2005</a></span></dt><dt><span class="section"><a href="#id2436923">1.2.3. Previous versions of MegaPOV</a></span></dt></dl></dd><dt><span class="section"><a href="#why">1.3. Why should i use MegaPOV?</a></span></dt><dt><span class="section"><a href="#enable">1.4. Enabling MegaPOV features</a></span></dt><dt><span class="section"><a href="#where">1.5. Where do I find MegaPOV?</a></span></dt><dd><dl><dt><span class="section"><a href="#id2437092">1.5.1. Sources and binaries</a></span></dt><dt><span class="section"><a href="#id2437126">1.5.2. Documentation and samples</a></span></dt><dt><span class="section"><a href="#discussion">1.5.3. Discussions</a></span></dt></dl></dd></dl></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="what"></a>1.1. What is MegaPOV?</h2></div></div><div></div></div><p xmlns="">
      MegaPOV is a custom and unofficial patched version of <span class="trademark">POV-Ray</span>&#8482;.
      It is a compilation of separately released patches and techniques
      released within the <span class="trademark">POV-Ray</span>&#8482; Community and dedicated work of the MegaPOV-Team.
    </p><p xmlns="">
      Many patches from MegaPOV 0.7 were included in official <span class="trademark">POV-Ray</span>&#8482; 3.5.
      It will probably not be the case with patches included in MegaPOV 1.0 and later
      in such a large scale because current official <span class="trademark">POV-Ray</span>&#8482; development involves larger 
      changes that make it less straight away to integrate MegaPOV patches.
    </p></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="news"></a>1.2. What's new</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="latest_changes"></a>1.2.1. MegaPOV 1.2.1 - 24 August 2005</h3></div></div><div></div></div><p xmlns="">
        MegaPOV 1.2.1 is a bugfix release and contain the following changes:
      </p><div xmlns="" class="orderedlist"><ol type="1" compact><li>Several Mechsim bugfixes</li><li>Improved compatibility of the PPM/PGM reader with the standard</li><li>Resolution of problems of the Windows version</li></ol></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2438813"></a>1.2.2. MegaPOV 1.2 - 4 July 2005</h3></div></div><div></div></div><p xmlns="">
        MegaPOV 1.2 includes the following new features and changes:
      </p><div xmlns="" class="orderedlist"><ol type="1" compact><li>Control up to which trace level area lights are calculated (see <a href="#area_light_mtl" title="2.4.5.1. Area Light max_trace_level">Section 2.4.5.1, &#8220;Area Light max_trace_level&#8221;</a>)</li><li>Bicubic interpolation for images (see <a href="#bicubic_image" title="2.6.7. Bicubic interpolation for images">Section 2.6.7, &#8220;Bicubic interpolation for images&#8221;</a>)</li><li>Custom tone mapping feature that offers detailed control of how the 
        colors are mapped to the resulting image and how this interacts with antialiasing (see <a href="#tone_mapping" title="2.7.2. Custom tone mapping function">Section 2.7.2, &#8220;Custom tone mapping function&#8221;</a>)</li><li>Radiosity improvements:
        	<div class="itemizedlist"><ul type="disc" compact><li>new adaptive pretrace mode (see <a href="#radiosity_adaptive_pretrace" title="2.7.3.6. Adaptive radiosity pretrace">Section 2.7.3.6, &#8220;Adaptive radiosity pretrace&#8221;</a>)</li><li>adaptive search radius/<tt class="function">error_bound</tt> (see <a href="#radiosity_error_bound_adaptive" title="2.7.3.4. Adaptive radiosity error_bound">Section 2.7.3.4, &#8220;Adaptive radiosity error_bound&#8221;</a>)</li><li>more detailed radiosity statistics (see <a href="#radiosity_additional_statistics" title="2.7.3.5. Additional radiosity statistics">Section 2.7.3.5, &#8220;Additional radiosity statistics&#8221;</a>)</li><li>sampling visualizations (see <a href="#radiosity_visualize" title="2.7.3.7. Radiosity visualizations">Section 2.7.3.7, &#8220;Radiosity visualizations&#8221;</a>)</li><li>bug fixes for randomized radiosity sampling directions (see <a href="#radiosity_randomize" title="2.7.3.3. Randomized radiosity sampling directions">Section 2.7.3.3, &#8220;Randomized radiosity sampling directions&#8221;</a>)</li></ul></div>
        	</li><li>Mechsim changes (see <a href="#mechsim" title="2.7.4. Mechanics simulation patch">Section 2.7.4, &#8220;Mechanics simulation patch&#8221;</a>):
        	<div class="itemizedlist"><ul type="disc" compact><li>improved collision bounding/hashing system</li><li>viscoelastic connections</li><li>global fixation in 1 or 2 dimensions</li><li>attachments can be limited to 1 or two dimensions (free movement in the others)</li><li>adaptive time stepping for 4th order Runge-Kutta method</li><li>new simulation data file format</li><li>custom forces that can be applied to individual masses</li><li>more detailed simulation statistics</li><li>access to simulation forces from SDL</li><li>various bug fixes and improvements</li></ul></div>
        	</li><li>Bug fix for problem with alpha channel output and bright colors</li><li>Bug fix <tt class="function">crand</tt> in textures resulting in negative color values</li></ol></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2436923"></a>1.2.3. Previous versions of MegaPOV</h3></div></div><div></div></div><p xmlns="">
    		For an overview of the previous versions, (see <a href="#old_megapov" title="6.3. MegaPOV before POV-Ray 3.6">Section 6.3, &#8220;MegaPOV before POV-Ray 3.6&#8221;</a>)
    	</p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="why"></a>1.3. Why should i use MegaPOV?</h2></div></div><div></div></div><p xmlns="">
			In case you are new to <span class="trademark">POV-Ray</span>&#8482; and maybe have not even used the official <span class="trademark">POV-Ray</span>&#8482; before it is
			not recommended to use MegaPOV.  Instead get the official <span class="trademark">POV-Ray</span>&#8482; from the <a href="http://www.povray.org/" target="_top"><span class="trademark">POV-Ray</span>&#8482; website</a>.  
    </p><p xmlns="">		
			MegaPOV will be interesting for more advanced <span class="trademark">POV-Ray</span>&#8482; users who are particularly interested
			in the additional functionality the patches offer.  We try to ensure a relatively high quality of the 
			patches added to MegaPOV but still some of these patches are still under development
			so you have to expect that not everything will run as smoothly as on official <span class="trademark">POV-Ray</span>&#8482; and that features
			will possibly change in future versions.			
    </p><p xmlns="">
      Some people may wonder why a MegaPOV version is still maintained when most MegaPOV features have been incorporated and
      improved in <span xmlns="" class="trademark">POV-Ray</span>&#8482; 3.5. Here are some reasons why:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>There are already several patched versions of <span class="trademark">POV-Ray</span>&#8482; 3.5;</li><li>Many patched versions are only available for a specific platform;</li><li>You often need to switch between patched versions for different features;</li><li>The next update of <span class="trademark">POV-Ray</span>&#8482; will probably take some time;</li><li>MegaPOV is a public test version. Features which prove to be popular and more or less bug free might get the
        attention of the <span class="trademark">POV-Team</span>&#8482; and make it into the next <span class="trademark">POV-Ray</span>&#8482;.</li></ul></div><p xmlns="">
      So the MegaPOV-Team collects available patches, tries to merge them into one
      patch collection and makes it available for the most common platforms.
    </p></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="enable"></a>1.4. Enabling MegaPOV features</h2></div></div><div></div></div><p xmlns="">
      MegaPOV features are enabled by using:
      </p><pre xmlns="" class="programlisting">#<tt class="function">version</tt> unofficial megapov 1.2;  // version number may be different</pre><p xmlns="">
      The new features are disabled by default, and only the official version's syntax will be accepted. The above line of POV code must be included
      in every include file with MegaPOV features as well, not just the main POV file.
      Once the unofficial features have been enabled, they can be again disabled by using:
      </p><pre xmlns="" class="programlisting">#version 3.6;</pre><p xmlns="">
      This is useful to allow backwards compatibility for some features.
    </p></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="where"></a>1.5. Where do I find MegaPOV?</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2437092"></a>1.5.1. Sources and binaries</h3></div></div><div></div></div><p xmlns="">
        Packages with compiled binaries are available for the most common
        platforms.  They can be obtained at the
        <a xmlns="" href="http://megapov.inetart.net/" target="_top">MegaPOV site</a>
        where you can also find the source code.
        </p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">The Mac version with its special user interface is maintained separately on
        <a xmlns="" href="http://users.skynet.be/smellenbergh/" target="_top">Smellenbergh's site</a>.
      </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2437126"></a>1.5.2. Documentation and samples</h3></div></div><div></div></div><p xmlns="">
        An online version of the MegaPOV documentation as well as downloadable
        archives in various formats are located at the
        <a href="http://megapov.inetart.net/documentation/" target="_top">MegaPOV site - documentation section</a>.
      </p><p xmlns="">
        A preview of the samples coming with MegaPOV can be found in our
        <a href="http://megapov.inetart.net/samples.html" target="_top">demo section</a>.
        The thumbnails there have a link to a larger image (640*480)
				and an mpeg file in case of animations and some description is available there as well.
      </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
          None of the MegaPOV packages includes the official <span class="trademark">POV-Ray</span>&#8482; documentation, samples
          and include files although these are essential for using MegaPOV.  If you do not
          already have installed <span class="trademark">POV-Ray</span>&#8482; you should get the official version from the
          <a href="http://www.povray.org/" target="_top"><span class="trademark">POV-Ray</span>&#8482; website</a>.
        </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="discussion"></a>1.5.3. Discussions</h3></div></div><div></div></div><p xmlns="">
        We don't maintain our own forum for discussions.
        MegaPOV is an unofficial patch to <span class="trademark">POV-Ray</span>&#8482;
        and the MegaPOV-Team is just part of the <span class="trademark">POV-Ray</span>&#8482; Community.
        That's why you can use the povray.unofficial.patches group
        for discussions related to MegaPOV.
        You can also use povray.binaries.* and povray.text.* groups
        to upload files related to MegaPOV. All mentioned groups
        are located on <a href="news://news.povray.org" target="_top">news.povray.org</a>.
      </p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="references"></a>Chapter 2. MegaPOV References</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#options">2.1. Options</a></span></dt><dd><dl><dt><span class="section"><a href="#frame_step">2.1.1. Frame_Step</a></span></dt><dt><span class="section"><a href="#hdr_write">2.1.2. HDR (High Dynamic Range) image output</a></span></dt></dl></dd><dt><span class="section"><a href="#expressions">2.2. Expressions</a></span></dt><dd><dl><dt><span class="section"><a href="#id2499336">2.2.1. Language directives</a></span></dt><dt><span class="section"><a href="#tokens">2.2.2. Built-in tokens</a></span></dt><dt><span class="section"><a href="#functions">2.2.3. Functions</a></span></dt><dt><span class="section"><a href="#internal_functions">2.2.4. Internal functions</a></span></dt><dt><span class="section"><a href="#polynomial_solver">2.2.5. Polynomial solver in parser</a></span></dt><dt><span class="section"><a href="#splines">2.2.6. Splines</a></span></dt><dt><span class="section"><a href="#transforms">2.2.7. Transforms</a></span></dt></dl></dd><dt><span class="section"><a href="#camera">2.3. Camera</a></span></dt><dd><dl><dt><span class="section"><a href="#user_defined_camera">2.3.1. user_defined camera type</a></span></dt></dl></dd><dt><span class="section"><a href="#objects">2.4. Objects</a></span></dt><dd><dl><dt><span class="section"><a href="#common_features">2.4.1. Common features</a></span></dt><dt><span class="section"><a href="#text">2.4.2. Text</a></span></dt><dt><span class="section"><a href="#cloth">2.4.3. Cloth simulation</a></span></dt><dt><span class="section"><a href="#isosurface">2.4.4. Isosurface</a></span></dt><dt><span class="section"><a href="#light">2.4.5. Light Sources</a></span></dt></dl></dd><dt><span class="section"><a href="#effects">2.5. Effects</a></span></dt><dd><dl><dt><span class="section"><a href="#glow">2.5.1. Glow</a></span></dt><dt><span class="section"><a href="#motion_blur">2.5.2. Motion blur</a></span></dt><dt><span class="section"><a href="#fur">2.5.3. Fur</a></span></dt></dl></dd><dt><span class="section"><a href="#patterns">2.6. Textures and patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#aoi_pattern">2.6.1. Angle of incidence</a></span></dt><dt><span class="section"><a href="#listed_pattern">2.6.2. Listed pattern</a></span></dt><dt><span class="section"><a href="#projection_pattern">2.6.3. Projection pattern</a></span></dt><dt><span class="section"><a href="#displace_warp">2.6.4. Displace warp for patterns</a></span></dt><dt><span class="section"><a href="#noisepigment">2.6.5. Noise pigment</a></span></dt><dt><span class="section"><a href="#hdr">2.6.6. HDR (High Dynamic Range) image type</a></span></dt><dt><span class="section"><a href="#bicubic_image">2.6.7. Bicubic interpolation for images</a></span></dt><dt><span class="section"><a href="#camera_view">2.6.8. New camera_view pigment</a></span></dt></dl></dd><dt><span class="section"><a href="#global_settings">2.7. Global Settings</a></span></dt><dd><dl><dt><span class="section"><a href="#film_exposure">2.7.1. Film exposure simulation</a></span></dt><dt><span class="section"><a href="#tone_mapping">2.7.2. Custom tone mapping function</a></span></dt><dt><span class="section"><a href="#radiosity">2.7.3. Radiosity</a></span></dt><dt><span class="section"><a href="#mechsim">2.7.4. Mechanics simulation patch</a></span></dt><dt><span class="section"><a href="#post_processing">2.7.5. Post processing</a></span></dt></dl></dd></dl></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="options"></a>2.1. Options</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="frame_step"></a>2.1.1. <tt class="function">Frame_Step</tt></h3></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2436812"></a><a xmlns="" class="indexterm" name="id2436779"></a><p xmlns="">
    The <tt class="function">Frame_Step</tt>=<i class="parameter"><tt>n</tt></i> (<tt class="function">+STP</tt><i class="parameter"><tt>n</tt></i>)
    option introduces breaks in the order of rendered steps.
    It splits the order of rendered frames into a 'virtual' and a 'real' order.
  </p><p xmlns="">
    'Virtual' order is the same as the traditional (used in <span class="trademark">POV-Ray</span>&#8482; 3.5) order
    described with <tt class="function">Initial_Frame</tt>, <tt class="function">Final_Frame</tt>,
    <tt class="function">Initial_Clock</tt>, <tt class="function">Final_Clock</tt>,
    <tt class="function">Subset_Start_Frame</tt>, <tt class="function">Subset_End_Frame</tt>.
    This order is what the scripts reads from <tt class="function">initial_frame</tt>, <tt class="function">clock_delta</tt>
    and other animation related build-in tokens in SDL.
  </p><p xmlns="">
    'Real' order is a  subset of 'virtual' order. It is every <span class="emphasis"><em>n</em></span>-th
    frame where <span class="emphasis"><em>n</em></span> is the value of <tt class="function">Frame_Step</tt>. Selected
    frames are reordered (with ascending or descending order) according to
    the sign of <tt class="function">Frame_Step</tt> option.
  </p><p xmlns="">
    <tt class="function">Frame_Step</tt> is supposed to use parallel rendering over one source
    with one location shared between instances of renderer.
  </p><div xmlns="" class="example"><a name="id2499847"></a><p class="title"><b>Example 2.1. Influence of <tt class="function">Frame_Step</tt> on generated files</b></p><p xmlns="">
      The following command line:
      </p><pre class="screen">megapov +Iscene.pov Initial_Frame=1 Final_Frame=5 +FN</pre><p xmlns="">
      causes the creation of files in such order:
      </p><pre class="screen">scene1.png
scene2.png
scene3.png
scene4.png
scene5.png</pre><p xmlns="">
      while when using <tt xmlns="" class="function">Frame_Step</tt>:
      </p><pre class="screen">megapov +Iscene.pov Initial_Frame=1 Final_Frame=5 +FN Frame_Step=-2</pre><p xmlns="">
      causes a subset of it in the following order:
      </p><pre class="screen">scene5.png
scene3.png
scene1.png</pre><p xmlns="">
    </p></div><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      <tt class="function">Frame_Step</tt> different than <i class="parameter"><tt>1</tt></i> works fine for
      those animations where variables are not passed between frames when using
      external files and where the next frame does not use values derived from a previous
      (in the meaning of virtual order) frame by other ways.
    </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="hdr_write"></a>2.1.2. HDR (High Dynamic Range) image output</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2498812"></a><a xmlns="" class="indexterm" name="id2498835"></a><p xmlns="">
    Apart from reading HDR images as image maps (see <a href="#hdr" title="2.6.6. HDR (High Dynamic Range) image type">Section 2.6.6, &#8220;HDR (High Dynamic Range) image type&#8221;</a>)
    MegaPOV also supports this file format for image output.  Further information
    on this file format can be found in <a href="#hdr" title="2.6.6. HDR (High Dynamic Range) image type">Section 2.6.6, &#8220;HDR (High Dynamic Range) image type&#8221;</a> as well.
  </p><p xmlns="">
    The file format identification character is <tt xmlns="" class="function">H</tt>.
    Writing this file format is activated by the command line option

    </p><pre xmlns="" class="programlisting">+FH</pre><p xmlns="">

    or the ini option

    </p><pre xmlns="" class="programlisting">Output_File_Type=H</pre><p xmlns="">
  </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="expressions"></a>2.2. Expressions</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2499336"></a>2.2.1. Language directives</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="set"></a>2.2.1.1. Set directive</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></h3></div></div></div><div></div></div><p xmlns="">
    The <tt class="function">#set</tt><a class="indexterm" name="id2499454"></a>
    keyword modifies the most recently created version of a variable. So, if a variable has been created previously with either <tt class="function">#declare</tt> or <tt class="function">#local</tt>,
    its value can be changed with the <tt class="function">#set</tt> directive.
  </p><div xmlns="" class="example"><a name="id2499366"></a><p class="title"><b>Example 2.2. Using the #set directive</b></p><pre class="programlisting"><tt class="function">#declare</tt> MyCounter = 0:
<tt class="function">#set</tt> MyCounter = MyCounter + 1;</pre><p xmlns="">
    One advantage is that it makes it more visually clear where variables are 'created', and where they are only 'changed'.
  </p></div><p xmlns="">
    Another advantage is that if you try to change a variable that doesn't yet exist, it produces an error.
    This could happen if you make a typing mistake, like this:
    </p><pre xmlns="" class="programlisting"><tt class="function">#declare</tt> MyCounter = 0;
<tt class="function">#while</tt> (MyCounter &lt; 10)
  <tt class="function">#declare</tt> MyCountr = MyCounter+1;
<tt class="function">#end</tt></pre><p xmlns="">
    This would normally cause an infinite loop, and may take a while to track down, especially in complex scenes and with typos
    that "look right" at a glance. If <tt xmlns="" class="function">#set</tt> was used, it would cause an error ("#set cannot assign to uninitialized identifier MyCountr.")
    at that line, pointing you directly at the problem.
  </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="tokens"></a>2.2.2. Built-in tokens</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="additional_tokens"></a>2.2.2.1. Additional tokens in function syntax</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    <span class="trademark">POV-Ray</span>&#8482; 3.5 in its official release does not accept all built-in constants
    and variables to be used in functions. Following tokens are recognized
    additionally in VM since MegaPOV 1.0:
    <span class="simplelist"><tt class="function">clock_delta</tt><a class="indexterm" name="id2499265"></a>, <tt class="function">clock_on</tt><a class="indexterm" name="id2500406"></a>, <tt class="function">false</tt><a class="indexterm" name="id2499303"></a>, <tt class="function">final_clock</tt><a class="indexterm" name="id2499319"></a>, <tt class="function">final_frame</tt><a class="indexterm" name="id2500543"></a>, <tt class="function">frame_number</tt><a class="indexterm" name="id2500582"></a>, <tt class="function">initial_clock</tt><a class="indexterm" name="id2500564"></a>, <tt class="function">initial_frame</tt><a class="indexterm" name="id2500553"></a>, <tt class="function">image_height</tt><a class="indexterm" name="id2500601"></a>, <tt class="function">image_width</tt><a class="indexterm" name="id2500335"></a>, <tt class="function">no</tt><a class="indexterm" name="id2500318"></a>, <tt class="function">off</tt><a class="indexterm" name="id2500333"></a>, <tt class="function">on</tt><a class="indexterm" name="id2500374"></a>, <tt class="function">true</tt><a class="indexterm" name="id2500373"></a>, <tt class="function">version</tt><a class="indexterm" name="id2500349"></a>, <tt class="function">yes</tt><a class="indexterm" name="id2500370"></a></span>
    . All mentioned tokens return the same values as in the whole SDL parser.
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="frame_step_token"></a>2.2.2.2. <tt class="function">frame_step</tt> key-word</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
          <a class="indexterm" name="id2499162"></a>
          As other animation options, also <tt class="function">Frame_Step</tt> has its own equivalent in SDL.
          You can use the <tt class="function">frame_step</tt> key-word to get the value which was passed to <tt class="function">Frame_Step</tt>
          (see <a href="#frame_step" title="2.1.1. Frame_Step">Section 2.1.1, &#8220;Frame_Step&#8221;</a>). Default value is 1.
        </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="functions"></a>2.2.3. Functions</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="time_date"></a>2.2.3.1. Time and date functions</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Yvo</span> <span class="surname">Smellenbergh</span></h3></div></div></div><div></div></div><p xmlns="">
    With the keyword <tt xmlns="" class="function">date</tt>, time and/or a date can be used in your images.
    This might be useful in a macro to place a time stamp in your images, along with your name.
    The keyword <tt xmlns="" class="function">date</tt> works like other string functions, except that you have to supply a format string.
    </p><div xmlns="" class="example"><a name="id2501642"></a><p class="title"><b>Example 2.3. <tt class="function">date</tt> function usage</b></p><p>
        Suppose it's Saturday 1 January. The following script:
        </p><pre class="programlisting"><tt class="function">#declare</tt> TheString=<tt class="function">date</tt>("%a %B")</pre><p>
        will return the string: Sat January
      </p></div><p xmlns="">
    The most flexible implementation was chosen (which is probably not the easiest ...) because not all countries write
    dates in the same way. Just think of the difference between the USA and most parts of Europe.

    These are the possible specifiers for the format string:

    Please note that these should be equal for all platforms but if you don't get the expected result, contact the
    person who compiled your version to find out if there are differences.

    </p><div xmlns="" class="table"><a name="id2501699"></a><p class="title"><b>Table 2.1. The following time formatting strings are available:</b></p><table summary="The following time formatting strings are available:" border="0" style="border-collapse: collapse;"><colgroup><col><col></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">a  </td><td style="border-bottom: 0.5pt solid ; ">Abbreviated weekday name.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">A</td><td style="border-bottom: 0.5pt solid ; ">Full weekday name.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">b</td><td style="border-bottom: 0.5pt solid ; ">Abbreviated month name.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">B</td><td style="border-bottom: 0.5pt solid ; ">Full month name.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">c</td><td style="border-bottom: 0.5pt solid ; ">The strftime() format equaling the format string of "%x %X".</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">d</td><td style="border-bottom: 0.5pt solid ; ">Day of the month as a decimal number.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">H</td><td style="border-bottom: 0.5pt solid ; ">The hour (24-hour clock) as a decimal number from 00 to 23.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">I</td><td style="border-bottom: 0.5pt solid ; ">The hour (12-hour clock) as a decimal number from 01 to 12</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">j</td><td style="border-bottom: 0.5pt solid ; ">The day of the year as a decimal number from 001 to 366</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">m</td><td style="border-bottom: 0.5pt solid ; ">The month as a decimal number from 01 to 12.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">M</td><td style="border-bottom: 0.5pt solid ; ">The minute as a decimal number from 00 to 59.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">p</td><td style="border-bottom: 0.5pt solid ; ">"AM" or "PM".</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">S</td><td style="border-bottom: 0.5pt solid ; ">The seconds as a decimal number from 00 to 59.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">U</td><td style="border-bottom: 0.5pt solid ; ">The week number of the year as a decimal number from 00 to 52. Sunday is considered the first day of the week.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">w</td><td style="border-bottom: 0.5pt solid ; ">The weekday as a decimal number from 0 to 6. Sunday is (0) zero.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">W</td><td style="border-bottom: 0.5pt solid ; ">The week of the year as a decimal number from 00 to 51. Monday is the first day of the week.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">x</td><td style="border-bottom: 0.5pt solid ; ">The date representation of the current locale.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">X</td><td style="border-bottom: 0.5pt solid ; ">The time representation of the current locale.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">y</td><td style="border-bottom: 0.5pt solid ; ">The last two digits of the year as a decimal number.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Y</td><td style="border-bottom: 0.5pt solid ; ">The century as a decimal number.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">z</td><td style="border-bottom: 0.5pt solid ; ">The time zone name or nothing if it is unknown.</td></tr><tr><td style="border-right: 0.5pt solid ; ">%  </td><td style="">The percent sign is displayed.</td></tr></tbody></table></div><p xmlns="">
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note:"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note:</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        To use the '%' character in the result, use it twice: <tt class="function">date</tt>("%%")
      </p></td></tr></table></div><p xmlns="">
    Refer to <tt xmlns="" class="filename">date.pov</tt> for an example scene.
    Please note that you might have to write the result in a file if you want to abort the rendering and continue later
    on. Otherwise you could get a different result because time goes on :-)
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="timer"></a>2.2.3.2. Timer function</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Yvo</span> <span class="surname">Smellenbergh</span></h3></div></div></div><div></div></div><p xmlns="">
    The keyword <tt xmlns="" class="function">start_chrono</tt> sets an internal variable and returns the current internal clock counter of your computer.
    The return value is not important. However, you must assign this return value from <tt xmlns="" class="function">start_chrono</tt> otherwise you get
    an error.
    Use it like this:
    </p><pre xmlns="" class="programlisting"><tt class="function">#declare</tt> Stopwatch = <tt class="function">start_chrono</tt>;</pre><p xmlns="">
    or use it like this:
    </p><pre xmlns="" class="programlisting"><tt class="function">#if</tt> (<tt class="function">start_chrono</tt>)</pre><p xmlns="">
    but not:
    </p><pre xmlns="" class="programlisting"><tt class="function">start_chrono</tt> //parsing stops with a fatal error</pre><p xmlns="">

    The keyword <tt xmlns="" class="function">current_chrono</tt> returns the time in full seconds (no fractions of seconds) between <tt xmlns="" class="function">start_chrono</tt> and
    <tt xmlns="" class="function">current_chrono</tt>. The start value is not changed. A second <tt xmlns="" class="function">current_chrono</tt> will still return the seconds between
    <tt xmlns="" class="function">start_chrono</tt> and the second <tt xmlns="" class="function">current_chrono</tt>.

    </p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">If you don't call <tt xmlns="" class="function">start_chrono</tt> somewhere before you call <tt xmlns="" class="function">current_chrono</tt>, you will get the seconds elapsed since the
    beginning of the current render (parsing).
    </p><div xmlns="" class="example"><a name="id2501537"></a><p class="title"><b>Example 2.4. Using the timer function</b></p><pre class="programlisting">//reset the chrono and return the internal clock counter
<tt class="function">#declare</tt> ParseStart = <tt class="function">start_chrono</tt>; 

<i class="parameter"><tt>... syntax to be parsed</tt></i>

//read the seconds elapsed since chrono_start
<tt class="function">#declare</tt> ParseEnd = <tt class="function">current_chrono</tt>;
<tt class="function">#debug</tt> <tt class="function">concat</tt>("\nParsing took ",str((ParseEnd, 1, 0)," seconds\n")</pre><p>
    </p></div><p xmlns="">
    Refer to <tt xmlns="" class="function">chrono.pov</tt> for a demo scene.
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="output_filename"></a>2.2.3.3. Filename with frame number</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    Some animators want to use filenames of previous, already rendered frames to average them
    to mimic motion_blur in one turn. But the concatenation of filename with frame number is not a trivial thing
    and can be platform dependant. MegaPOV allows you to get <i class="parameter"><tt>n</tt></i>-th filename of current
    animation. For stills it always returns filename without numbers.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2501204"></a>
    </p><pre xmlns="" class="synopsis">#declare File_Name=<tt class="function">output_filename</tt>(<i class="parameter"><tt>Frame_Number</tt></i>)</pre><p xmlns="">
  </p><div xmlns="" class="example"><a name="id2501223"></a><p class="title"><b>Example 2.5. Averaging frames with <tt class="function">output_filename</tt> function</b></p><p>
      You can force every 10th frame to be averaged content of previous nine frames, this way:
    </p><pre class="programlisting"><tt class="function">#if</tt>(<tt class="function">mod</tt>(<tt class="function">frame_number</tt>,10)=9)
  <tt class="function">#declare</tt> Averaged_Frames=<tt class="function">pigment</tt>{
    <tt class="function">average</tt>
    <tt class="function">#local</tt> Counter=1;
    <tt class="function">#while</tt>(Counter&lt;10)
      [1 <tt class="function">image_map</tt>{<tt class="function">output_filename</tt>(<tt class="function">frame_number</tt>-Counter)}]
      <tt class="function">#set</tt> Counter=Counter+1;
    <tt class="function">#end</tt>
  }
  // placing of pigment in output area
<tt class="function">#else</tt>
  // conventional scene
<tt class="function">#end</tt></pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="images_sizes"></a>2.2.3.4. Sizes of images</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    You probably already know that the <tt class="function">image_width</tt> and <tt class="function">image_height</tt>
    keywords return the sizes of a rendered image. But there are cases when you would like
    to change the content of a scene depending on the sizes of the images used for maps. For this
    purpose the <tt class="function">image_width</tt> and <tt class="function">image_height</tt> keywords are extended with an
    optional parameter which is the identifier of an item using an image.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2503425"></a>
    <a xmlns="" class="indexterm" name="id2503436"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">#declare</tt> Identifier=<tt class="function">image_width</tt> [ (ITEM_WITH_IMAGE) ];
<tt class="function">#declare</tt> Identifier=<tt class="function">image_height</tt> [ (ITEM_WITH_IMAGE) ];

ITEM_WITH_IMAGE: PIGMENT_ID | NORMAL_ID | TEXTURE_ID</pre><p xmlns="">
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="vectors_dimensions"></a>2.2.3.5. Dimensions of vectors</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    The usage of the <tt class="function">dimension_size</tt> is extended since MegaPOV 1.1 with a measurement of
    floats, vectors and colors. If you want to write a universal script which works differently
    depending on the number of components in an identifier, you can use the <tt class="function">dimension_size</tt> to
    get 1,2,3,4 or 5 as number of the components in the given identifier.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2501030"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">#declare</tt> Identifier=<tt class="function">dimension_size</tt> ( FLOAT | VECTOR | COLOR );</pre><p xmlns="">
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="is"></a>2.2.3.6. Type checking</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    MegaPOV 1.1 allows the verification of the type (and in some cases subtypes) of identifiers.
    It is possible thanks to the <tt class="function">is</tt> function which tests the internal type of an identifier.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2501161"></a>
    <a xmlns="" class="indexterm" name="id2501169"></a>
    <a xmlns="" class="indexterm" name="id2501124"></a>
    <a xmlns="" class="indexterm" name="id2501134"></a>
    <a xmlns="" class="indexterm" name="id2501145"></a>
    <a xmlns="" class="indexterm" name="id2503187"></a>
    <a xmlns="" class="indexterm" name="id2503198"></a>
    <a xmlns="" class="indexterm" name="id2503209"></a>
    <a xmlns="" class="indexterm" name="id2503220"></a>
    <a xmlns="" class="indexterm" name="id2503230"></a>
    <a xmlns="" class="indexterm" name="id2503241"></a>
    <a xmlns="" class="indexterm" name="id2503252"></a>
    <a xmlns="" class="indexterm" name="id2503263"></a>
    <a xmlns="" class="indexterm" name="id2503274"></a>
    <a xmlns="" class="indexterm" name="id2503285"></a>
    <a xmlns="" class="indexterm" name="id2503296"></a>
    <a xmlns="" class="indexterm" name="id2503307"></a>
    <a xmlns="" class="indexterm" name="id2503318"></a>
    <a xmlns="" class="indexterm" name="id2504035"></a>
    <a xmlns="" class="indexterm" name="id2504046"></a>
    <a xmlns="" class="indexterm" name="id2504057"></a>
    <a xmlns="" class="indexterm" name="id2504068"></a>
    <a xmlns="" class="indexterm" name="id2504078"></a>
    <a xmlns="" class="indexterm" name="id2504089"></a>
    <a xmlns="" class="indexterm" name="id2504100"></a>
    <a xmlns="" class="indexterm" name="id2504112"></a>
    <a xmlns="" class="indexterm" name="id2504122"></a>
    <a xmlns="" class="indexterm" name="id2504134"></a>
    <a xmlns="" class="indexterm" name="id2504144"></a>
    <a xmlns="" class="indexterm" name="id2504155"></a>
    <a xmlns="" class="indexterm" name="id2504166"></a>
    <a xmlns="" class="indexterm" name="id2504177"></a>
    <a xmlns="" class="indexterm" name="id2504188"></a>
    <a xmlns="" class="indexterm" name="id2504200"></a>
    <a xmlns="" class="indexterm" name="id2504210"></a>
    <a xmlns="" class="indexterm" name="id2504221"></a>
    <a xmlns="" class="indexterm" name="id2504232"></a>
    <a xmlns="" class="indexterm" name="id2504243"></a>
    <a xmlns="" class="indexterm" name="id2504254"></a>
    <a xmlns="" class="indexterm" name="id2504265"></a>
    <a xmlns="" class="indexterm" name="id2504276"></a>
    <a xmlns="" class="indexterm" name="id2504287"></a>
    <a xmlns="" class="indexterm" name="id2504298"></a>
    <a xmlns="" class="indexterm" name="id2504309"></a>
    <a xmlns="" class="indexterm" name="id2504320"></a>
    <a xmlns="" class="indexterm" name="id2504331"></a>
    <a xmlns="" class="indexterm" name="id2504342"></a>
    <a xmlns="" class="indexterm" name="id2504353"></a>
    <a xmlns="" class="indexterm" name="id2504364"></a>
    <a xmlns="" class="indexterm" name="id2504375"></a>
    <a xmlns="" class="indexterm" name="id2504386"></a>
    <a xmlns="" class="indexterm" name="id2504397"></a>
    <a xmlns="" class="indexterm" name="id2504408"></a>
    <a xmlns="" class="indexterm" name="id2504419"></a>
    <a xmlns="" class="indexterm" name="id2504430"></a>
    <a xmlns="" class="indexterm" name="id2504440"></a>
    <a xmlns="" class="indexterm" name="id2504451"></a>
    <a xmlns="" class="indexterm" name="id2504462"></a>
    <a xmlns="" class="indexterm" name="id2504473"></a>
    <a xmlns="" class="indexterm" name="id2504484"></a>
    <a xmlns="" class="indexterm" name="id2504495"></a>
    <a xmlns="" class="indexterm" name="id2504506"></a>
    <a xmlns="" class="indexterm" name="id2504517"></a>
    <a xmlns="" class="indexterm" name="id2504528"></a>
    <a xmlns="" class="indexterm" name="id2504539"></a>
    <a xmlns="" class="indexterm" name="id2504550"></a>
    <a xmlns="" class="indexterm" name="id2504561"></a>
    <a xmlns="" class="indexterm" name="id2504572"></a>
    <a xmlns="" class="indexterm" name="id2504583"></a>
    <a xmlns="" class="indexterm" name="id2504594"></a>
    <a xmlns="" class="indexterm" name="id2504605"></a>
    <a xmlns="" class="indexterm" name="id2504616"></a>
    <a xmlns="" class="indexterm" name="id2504627"></a>
    <a xmlns="" class="indexterm" name="id2504638"></a>
    <a xmlns="" class="indexterm" name="id2504649"></a>
    <a xmlns="" class="indexterm" name="id2504660"></a>
    <a xmlns="" class="indexterm" name="id2504671"></a>
    <a xmlns="" class="indexterm" name="id2504682"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">#declare</tt> Identifier=<tt class="function">is</tt> ( IDENTIFIER , TYPE | SUBTYPE );

TYPE: <tt class="function">array</tt> | <tt class="function">camera</tt> | <tt class="function">color</tt> | 
      <tt class="function">color_map</tt> | <tt class="function">density</tt> | <tt class="function">density_map</tt> | 
      <tt class="function">finish</tt> | <tt class="function">float</tt> | <tt class="function">fog</tt> | 
      <tt class="function">function</tt> | <tt class="function">interior</tt> | <tt class="function">light_source</tt> | 
      <tt class="function">material</tt> | <tt class="function">media</tt> | <tt class="function">normal</tt> | 
      <tt class="function">normal_map</tt> | <tt class="function">object</tt> | <tt class="function">pigment</tt> | 
      <tt class="function">pigment_map</tt> | <tt class="function">rainbow</tt> | <tt class="function">sky_sphere</tt> | 
      <tt class="function">slope_map</tt> | <tt class="function">spline</tt> | <tt class="function">string</tt> | 
      <tt class="function">texture</tt> | <tt class="function">texture_map</tt> | <tt class="function">transform</tt> | 
      <tt class="function">vector</tt>

SUBTYPE: SPLINE_TYPE | OBJECT_TYPE | CAMERA_TYPE

SPLINE_TYPE: <tt class="function">akima_spline</tt> | <tt class="function">basic_x_spline</tt> | 
             <tt class="function">cubic_spline</tt> | <tt class="function">extended_x_spline</tt> | 
             <tt class="function">general_x_spline</tt> | <tt class="function">linear_spline</tt> | 
             <tt class="function">natural_spline</tt> | <tt class="function">quadratic_spline</tt> | 
             <tt class="function">sor_spline</tt> | <tt class="function">tcb_spline</tt> 

OBJECT_TYPE: <tt class="function">bicubic_patch</tt> | <tt class="function">blob</tt> | <tt class="function">box</tt> | 
             <tt class="function">cone</tt> | <tt class="function">cubic</tt> | <tt class="function">cylinder</tt> | 
             <tt class="function">disc</tt> | <tt class="function">height_field</tt> | <tt class="function">intersection</tt> | 
             <tt class="function">isosurface</tt> | <tt class="function">julia_fractal</tt> | <tt class="function">lathe</tt> | 
             <tt class="function">merge</tt> | <tt class="function">mesh</tt> | <tt class="function">parametric</tt> | 
             <tt class="function">plane</tt> | <tt class="function">poly</tt> | <tt class="function">polygon</tt> | 
             <tt class="function">prism</tt> | <tt class="function">quadric</tt> | <tt class="function">quartic</tt> | 
             <tt class="function">smooth_triangle</tt> | <tt class="function">sor</tt> | <tt class="function">sphere</tt> | 
             <tt class="function">sphere_sweep</tt> | <tt class="function">superellipsoid</tt> | <tt class="function">text</tt> | 
             <tt class="function">torus</tt> | <tt class="function">triangle</tt> | <tt class="function">union</tt>

CAMERA_TYPE: <tt class="function">cylinder</tt> | <tt class="function">fisheye</tt> | <tt class="function">omnimax</tt> | 
             <tt class="function">orthographic</tt> | <tt class="function">panoramic</tt> | <tt class="function">perspective</tt> | 
             <tt class="function">spherical</tt> | <tt class="function">ultra_wide_angle</tt> | <tt class="function">user_defined</tt></pre><p xmlns="">
  </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
       <a class="indexterm" name="id2504710"></a>
       <a class="indexterm" name="id2505241"></a>
       Internally <tt class="function">mesh2</tt> is stored as <tt class="function">mesh</tt>. Similar <tt class="function">difference</tt>
       is stored as <tt class="function">intersection</tt>.
    </p></td></tr></table></div><p xmlns="">
    An example using the <tt class="function">is</tt> keyword can be found in the <tt class="filename">mp_types.inc</tt> include file
    (see <a href="#mp_types.inc" title="3.3. The 'mp_types.inc' include file">Section 3.3, &#8220;The 'mp_types.inc' include file&#8221;</a>).
  </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="internal_functions"></a>2.2.4. Internal functions</h3></div></div><div></div></div><p xmlns="">
        MegaPOV delivers new pre-defined functions. These new internal functions can be accessed
        through the <tt class="filename">mp_functions.inc</tt> include file, so it should be included
        in your scene to make use of them.
      </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="f_triangle"></a>2.2.4.1. <tt class="function">f_triangle</tt></h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2505697"></a><p xmlns="">
    <tt xmlns="" class="function">f_triangle</tt> function has 10 parameters:
    </p><div xmlns="" class="funcsynopsis"><p><code class="funcdef">FLOAT <b class="fsfunc">f_triangle</b>(</code>FLOAT <var class="pdparam">V1x</var>, FLOAT <var class="pdparam">V1y</var>, FLOAT <var class="pdparam">V1z</var>, FLOAT <var class="pdparam">V2x</var>, FLOAT <var class="pdparam">V2y</var>, FLOAT <var class="pdparam">V2z</var>, FLOAT <var class="pdparam">V3x</var>, FLOAT <var class="pdparam">V3y</var>, FLOAT <var class="pdparam">V3z</var>, FLOAT <var class="pdparam">Thickness</var><code>)</code>;</p></div><p xmlns="">
    The parameters <i xmlns="" class="parameter"><tt>V1x</tt></i>, <i xmlns="" class="parameter"><tt>V1y</tt></i>, <i xmlns="" class="parameter"><tt>V1z</tt></i>
    describe the coordinates of the first vertex in the triangle.
    </p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">The parameters <i xmlns="" class="parameter"><tt>V2x</tt></i>, <i xmlns="" class="parameter"><tt>V2y</tt></i>, <i xmlns="" class="parameter"><tt>V2z</tt></i>
    describe the coordinates of the second
    vertex in the triangle.
    </p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">The parameters <i xmlns="" class="parameter"><tt>V3x</tt></i>, <i xmlns="" class="parameter"><tt>V3y</tt></i>, <i xmlns="" class="parameter"><tt>V3z</tt></i>
    describe the coordinates of the third vertex in the triangle.
    </p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">The parameter <i xmlns="" class="parameter"><tt>Thickness</tt></i> describes how thick the triangle is.
  </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      In order to achieve the fastest calculation, try to pass the parameters so that the side
      <i class="parameter"><tt>V1</tt></i>-<i class="parameter"><tt>V2</tt></i> represents the longest side and
      <i class="parameter"><tt>V1</tt></i>-<i class="parameter"><tt>V3</tt></i> represents the shortest side.
    </p></td></tr></table></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="polynomial_solver"></a>2.2.5. Polynomial solver in parser</h3></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    The polynomial solver is accessible from scripts via the float functions <tt xmlns="" class="function">n_roots</tt>
    <a xmlns="" class="indexterm" name="id2506058"></a>
    and <tt xmlns="" class="function">nth_root</tt><a xmlns="" class="indexterm" name="id2506722"></a>
    with the following syntax:
    </p><div xmlns="" class="funcsynopsis"><p><code class="funcdef">INT <b class="fsfunc">n_roots</b>(</code>FLOAT <var class="pdparam">an</var>, <var class="pdparam">...</var>, FLOAT <var class="pdparam">a0</var>, BOOL <var class="pdparam">sturm_flag</var>, FLOAT <var class="pdparam">epsilon</var><code>)</code>;</p><p><code class="funcdef">FLOAT <b class="fsfunc">nth_root</b>(</code>FLOAT <var class="pdparam">nth</var>, FLOAT <var class="pdparam">an</var>, <var class="pdparam">...</var>, FLOAT <var class="pdparam">a0</var>, BOOL <var class="pdparam">sturm_flag</var>, FLOAT <var class="pdparam">epsilon</var><code>)</code>;</p></div><p xmlns="">
  </p><p xmlns="">
    <tt class="function">n_roots</tt> returns the number of roots derived from the polynomial given by the parameters
    <i class="parameter"><tt>a<sub>n</sub></tt></i>, <i class="parameter"><tt>...</tt></i>, <i class="parameter"><tt>a<sub>0</sub></tt></i>
    and calculated under the conditions specified by the parameters
    <i class="parameter"><tt>sturm_flag</tt></i> and <i class="parameter"><tt>epsilon</tt></i>.
  </p><p xmlns="">
    <tt class="function">nth_root</tt> returns the value of the <i class="parameter"><tt>nth</tt></i> root of a given polynomial.
  </p><p xmlns="">
    The sturm flag turns on a different algorithm of calculation.
    Its usage influences the number of returned roots.
    Epsilon (positive) value means that the roots below Epsilon value are ignored.
    Epsilon=0 means that none of the roots are ignored.
  </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      You don't have to call <tt class="function">n_roots</tt> before <tt class="function">nth_root</tt>, but if you do call
      <tt class="function">nth_root</tt> with the wrong root number then it causes an error and breaks parsing.
      It is better to call <tt class="function">n_roots</tt> first to verify the number of available roots.
    </p></td></tr></table></div><div xmlns="" class="example"><a name="id2507860"></a><p class="title"><b>Example 2.6. Polynomial solver usage</b></p><p xmlns="">
      Imagine that we have
        x<sup xmlns="">3</sup>+6*x<sup xmlns="">2</sup>-x-6
      and that we are interested in its roots for further calculations. So if we declare:
      </p><pre class="programlisting"><tt class="function">#declare</tt> N=<tt class="function">n_roots</tt>(1, 6, -1, -6, <tt class="function">off</tt>, 0);</pre><p xmlns="">
      then N has value 3 because the mentioned equation has 3 roots.
      If we are interested in what roots it has, we can use the following calls:
      </p><pre class="programlisting"><tt class="function">#declare</tt> R0=<tt class="function">nth_root</tt>(0, 1, 6, -1, -6, <tt class="function">off</tt>, 0);
<tt class="function">#declare</tt> R1=<tt class="function">nth_root</tt>(1, 1, 6, -1, -6, <tt class="function">off</tt>, 0);
<tt class="function">#declare</tt> R2=<tt class="function">nth_root</tt>(2, 1, 6, -1, -6, <tt class="function">off</tt>, 0);</pre><p xmlns="">
      And it returns R0=-6, R1=1 and R2=-1. So finally we know that
        x<sup xmlns="">3</sup>+6*x<sup xmlns="">2</sup>-x-6=(x+6)*(x-1)*(x+1)
      .
    </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="splines"></a>2.2.6. Splines</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="sor_spline"></a>2.2.6.1. <tt class="function">spline</tt> follows <tt class="function">sor</tt></h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2506230"></a><a xmlns="" class="indexterm" name="id2507673"></a><p xmlns="">
    Splines in <span class="trademark">POV-Ray</span>&#8482; can be used to create objects through rotation,
    translation or by being a border of a surface.
    Usually it is hard to match those surfaces with calculations developed in SDL because they are mostly
    hard-coded within the source core code of <span class="trademark">POV-Ray</span>&#8482;. The <tt class="function">spline</tt> feature introduced in <span class="trademark">POV-Ray</span>&#8482; 3.5
    makes such operations much easier but some spline types are still missing. <tt class="function">sor_spline</tt> is
    introduced to access the surface of the <tt class="function">sor</tt> object in SDL.
  </p><p xmlns="">
    To use the data from the <tt class="function">sor</tt> object in a <tt class="function">sor_spline</tt>, the order of coordinates has to be
    changed. The old <tt class="function">y</tt> coordinate is now the clock value in the spline.
    The advantage is that one <tt class="function">sor_spline</tt> can hold data from five old <tt class="function">sor</tt>-s.
    That's because every <tt class="function">spline</tt> can operate up to five dimensions along the clock value.
  </p><div xmlns="" class="example"><a name="id2506293"></a><p class="title"><b>Example 2.7. Conversion from the <tt class="function">sor</tt> object definition to the <tt class="function">sor_spline</tt> type in <tt class="function">spline</tt></b></p><pre class="programlisting"><tt class="function">spline</tt>{
   <tt class="function">sor_spline</tt>
  -1.000000,0.000000*<tt class="function">x</tt>
   0.000000,0.118143*<tt class="function">x</tt>
   0.540084,0.620253*<tt class="function">x</tt>
   0.827004,0.210970*<tt class="function">x</tt>
   0.962025,0.194093*<tt class="function">x</tt>
   1.000000,0.286920*<tt class="function">x</tt>
   1.033755,0.468354*<tt class="function">x</tt>
}

<tt class="function">sor</tt>{
  7
  &lt;0.000000, -1.000000&gt;
  &lt;0.118143,  0.000000&gt;
  &lt;0.620253,  0.540084&gt;
  &lt;0.210970,  0.827004&gt;
  &lt;0.194093,  0.962025&gt;
  &lt;0.286920,  1.000000&gt;
  &lt;0.468354,  1.033755&gt;
}</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="akima_spline"></a>2.2.6.2. akima <tt class="function">spline</tt></h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2508769"></a><a xmlns="" class="indexterm" name="id2508780"></a><p xmlns="">
    An <tt xmlns="" class="function">akima_spline</tt> is a spline that goes smoothly (pleasingly for some) through 
    all points. ACM Press abstracts original work of Hiroshi Akima:
    </p><div xmlns="" class="blockquote"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
        This method is devised in such a way that the resultant curve will pass through 
        the given points and will appear smooth and natural. It is based on a piecewise 
        function composed of a set of polynomials, each of degree three, at most, and 
        applicable to successive intervals of the given points. In this method, the slope 
        of the curve is determined at each given point locally, and each polynomial 
        representing a portion of the curve between a pair of given points is determined by 
        the coordinates of and the slopes at the points. Comparison indicates that the curve 
        obtained by this new method is closer to a manually drawn curve than those drawn by 
        other mathematical methods.
      </p></td><td width="10%" valign="top"> </td></tr><tr><td colspan="2" align="right" valign="top">--<span class="attribution"><a href="http://portal.acm.org/" target="_top"><i class="citetitle">The Guide to Computing Literature.</i></a></span></td><td width="10%" valign="top"> </td></tr></table></div><p xmlns="">
  </p><p xmlns="">
    Syntax is:
  </p><pre xmlns="" class="synopsis"><tt class="function">spline</tt> {
  <tt class="function">akima_spline</tt>
  <i class="parameter"><tt>time_Val_1</tt></i>, &lt;<i class="parameter"><tt>Vector_1</tt></i>&gt; [,]
  <i class="parameter"><tt>time_Val_2</tt></i>, &lt;<i class="parameter"><tt>Vector_2</tt></i>&gt; [,]
    ...
  <i class="parameter"><tt>time_Val_n</tt></i>, &lt;<i class="parameter"><tt>Vector_n</tt></i>&gt;
}</pre><p xmlns="">
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="tcb_spline"></a>2.2.6.3. tcb <tt class="function">spline</tt></h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2508928"></a><a xmlns="" class="indexterm" name="id2508939"></a><p xmlns="">
    This spline is also known as Kochanek-Bartels spline.
  </p><p xmlns="">
    Syntax is:
  </p><pre xmlns="" class="synopsis"><tt class="function">spline</tt> {
  <tt class="function">tcb_spline</tt> [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>]
  <i class="parameter"><tt>time_Val_1</tt></i> [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>], &lt;<i class="parameter"><tt>Vector_1</tt></i>&gt; [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>][,]
  <i class="parameter"><tt>time_Val_2</tt></i> [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>], &lt;<i class="parameter"><tt>Vector_2</tt></i>&gt; [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>][,]
    ...
  <i class="parameter"><tt>time_Val_n</tt></i> [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>], &lt;<i class="parameter"><tt>Vector_n</tt></i>&gt; [<i class="parameter"><tt>TCB_PARAMETERS</tt></i>]
}

<i class="parameter"><tt>TCB_PARAMETERS</tt></i>:
  [<tt class="function">tension</tt> <i class="parameter"><tt>FLOAT</tt></i>] [<tt class="function">continuity</tt> <i class="parameter"><tt>FLOAT</tt></i>] [<tt class="function">bias</tt> <i class="parameter"><tt>FLOAT</tt></i>]</pre><p xmlns="">
    The <tt xmlns="" class="function">tension</tt>, <tt xmlns="" class="function">continuity</tt> and <tt xmlns="" class="function">bias</tt> are fully optional. Depending on the place
    where they appear, they control the spline in different ways:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
          Placed right after the <tt class="function">tcb_spline</tt> keyword, they set the default values for
          all ends of the spline segments. This placement is ignored in case of copying spline 
          without adding new controls because previous defaults were already propagated to each 
          side of control points.
        </li><li>
          Placed between the time_value and the corresponding vector, the tcb parameters determine the
          properties of the spline segment ending in the vector that follows these parameters.
        </li><li>
          For tcb parameters following a vector, the properties of the spline segment beginning after
          this vector are set.
        </li></ul></div><p xmlns="">
  </p><p xmlns="">
    What is controlled by these parameters?
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">tension</tt> controls how sharply the curve bends.</li><li><tt class="function">continuity</tt> controls how rapid speed and direction change.</li><li><tt class="function">bias</tt> controls the direction of the curve as it passes through the control point.</li></ul></div><p xmlns="">
  </p><p xmlns="">
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top">A <tt class="function">tcb_spline</tt> needs additional control points before and after the spline. This is
      required to control the first and last segment of the spline.
    </td></tr></table></div><p xmlns="">
  </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="x_splines"></a>2.2.6.4. x splines</h4></div></div><div></div></div><p xmlns="">
    A very nice property of x splines is that they can go through a control point as well as
    just approximate it.
  </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="basic_x_spline"></a>2.2.6.4.1. basic x spline</h5></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2509297"></a><a xmlns="" class="indexterm" name="id2509308"></a><p xmlns="">
      Syntax is:
    </p><pre xmlns="" class="synopsis"><tt class="function">spline</tt> {
  <tt class="function">basic_x_spline</tt> [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i>]
  <i class="parameter"><tt>time_Val_1</tt></i>, &lt;<i class="parameter"><tt>Vector_1</tt></i>&gt; [,]
  <i class="parameter"><tt>time_Val_2</tt></i>, &lt;<i class="parameter"><tt>Vector_2</tt></i>&gt; [,]
  ...
  <i class="parameter"><tt>time_Val_n</tt></i>, &lt;<i class="parameter"><tt>Vector_n</tt></i>&gt;
}</pre><p xmlns="">
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top">A <tt class="function">basic_x_spline</tt> needs additional control points before and after the spline. This is
      required to control the first and last segment of the spline.
    </td></tr></table></div><p xmlns="">
  </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="extended_x_spline"></a>2.2.6.4.2. extended x spline</h5></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2509439"></a><a xmlns="" class="indexterm" name="id2509450"></a><p xmlns="">
      The <tt class="function">extended_x_spline</tt> offers the possibility to mix smooth curves and sharp edges in an
      unrestricted way in one spline.
    </p><p xmlns="">
      Syntax is:
    </p><pre xmlns="" class="synopsis"><tt class="function">spline</tt> {
  <tt class="function">extended_x_spline</tt> [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i>]
  <i class="parameter"><tt>time_Val_1</tt></i>, &lt;<i class="parameter"><tt>Vector_1</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ][,]
  <i class="parameter"><tt>time_Val_2</tt></i>, &lt;<i class="parameter"><tt>Vector_2</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ][,]
  ...
  <i class="parameter"><tt>time_Val_n</tt></i>, &lt;<i class="parameter"><tt>Vector_n</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
}</pre></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="general_x_spline"></a>2.2.6.4.3. general x spline</h5></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2509614"></a><a xmlns="" class="indexterm" name="id2509624"></a><p xmlns="">
      Syntax is:
    </p><pre xmlns="" class="synopsis"><tt class="function">spline</tt> {
  <tt class="function">general_x_spline</tt> [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i>]
  <i class="parameter"><tt>time_Val_1</tt></i>, &lt;<i class="parameter"><tt>Vector_1</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ][,]
  <i class="parameter"><tt>time_Val_2</tt></i>, &lt;<i class="parameter"><tt>Vector_2</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ][,]
  ...
  <i class="parameter"><tt>time_Val_n</tt></i>, &lt;<i class="parameter"><tt>Vector_n</tt></i>&gt; [<tt class="function">freedom_degree</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
}</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="spline_like_array"></a>2.2.6.5. Spline accessed like array</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2509858"></a><a xmlns="" class="indexterm" name="id2509868"></a><a xmlns="" class="indexterm" name="id2511069"></a><p xmlns="">
    Since MegaPOV 1.0 it is possible to read values stored in a <tt class="function">spline</tt> with a notation similar to an <tt class="function">array</tt>.
    Previously once the <tt class="function">spline</tt> was declared, it was only possible to evaluate it for a specified argument. Now two new
    usages are possible: you can get the number of entries and read the exact values placed in splines.
  </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>SPLINE_USAGE</tt></i>:
  <i class="parameter"><tt>SPLINE_EVALUATION</tt></i> | <i class="parameter"><tt>SPLINE_MEASUREMENT</tt></i> | <i class="parameter"><tt>SPLINE_ENTRY</tt></i>

<i class="parameter"><tt>SPLINE_EVALUATION</tt></i>:
  <tt class="function">#declare</tt> Spline_Value = MySpline(Val);
  <tt class="function">#declare</tt> Spline_Value = MySpline(Val, SPLINE_TYPE);

<i class="parameter"><tt>SPLINE_MEASUREMENT</tt></i>:
  <tt class="function">#declare</tt> Number_Of_Entries = <tt class="function">dimension_size</tt>( MySpline );

<i class="parameter"><tt>SPLINE_ENTRY</tt></i>:
  <tt class="function">#declare</tt> Float_Time_Parameter = MySpline[ Counter ][ 0 ];
  <tt class="function">#declare</tt> Vector_Value_Of_Entry = MySpline[ Counter ][ 1 ];</pre></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="transforms"></a>2.2.7. Transforms</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="normal_transform"></a>2.2.7.1. The normal modifier for transforms</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2509952"></a><a xmlns="" class="indexterm" name="id2509963"></a><p xmlns="">
    This patch adds a new option to the <tt class="function">transform</tt> syntax
    that modifies the transform to be suited for transforming normal vectors.
  </p><p xmlns="">
    When a mesh is transformed by the transformation matrix <tt class="function">M</tt>
    the normals need to be transformed with the transpose of the inverse
    of <tt class="function">M</tt>.  This is handled automatically by this patch.
  </p><p xmlns="">Syntax is:
	</p><pre xmlns="" class="synopsis"><tt class="function">transform</tt> {
  ...
  <tt class="function">normal</tt> <i class="parameter"><tt>on</tt></i>|<i class="parameter"><tt>off</tt></i>
}</pre><p xmlns="">
  </p><p xmlns="">
    The default value is <tt class="function">off</tt> so you get a standard transform.
  </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="camera"></a>2.3. Camera</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="user_defined_camera"></a>2.3.1. <tt class="function">user_defined</tt> camera type</h3></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    Instead of patching <span class="trademark">POV-Ray</span>&#8482; with new camera types MegaPOV provides a tool to define any projection
    type directly inside the scene scripts. This tool is named <tt class="function">user_defined</tt> camera type. It allows
    starting camera rays from any point in any direction. Both the location and direction of rays is specified
    as a set of three functions or as one pigment.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2511753"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">camera</tt> {
  <tt class="function">user_defined</tt>
  <tt class="function">location</tt> { FUNCTION_VECTOR }
  <tt class="function">direction</tt> { FUNCTION_VECTOR }
}

FUNCTION_VECTOR:
  PIGMENT | 3_USER_DEFINED_FUNCTIONS ...

3_USER_DEFINED_FUNCTIONS:
  USER_DEFINED_FUNCTION
  USER_DEFINED_FUNCTION
  USER_DEFINED_FUNCTION</pre><p xmlns="">
  </p><p xmlns="">
    In the case of 3 functions used to define location or direction, please remember that those functions operate
    on screen coordinates (<tt class="function">u</tt> and <tt class="function">v</tt>) in the area &lt;0,0&gt;-&lt;1,1&gt; so that they are independent
    of the image resolution. If you want to convert the value from the range 0-1 to the range 0-image_width or
    0-image_height you can use the function <tt class="function">adj_range</tt> from the <tt class="filename">math.inc</tt>
    include file.
  </p><p xmlns="">
    In the case of a pigment used to define location or direction, please remember that the values of the pigment
    are taken from the area &lt;0,0,0&gt;-&lt;1,1,0&gt;.
  </p><div xmlns="" class="example"><a name="id2511852"></a><p class="title"><b>Example 2.8. Alternative forms of <tt class="function">user_defined</tt> camera type definition</b></p><p xmlns="">
      Let's imagine we want to recreate the orthographic camera using a user_defined camera:
      </p><pre class="programlisting"><tt class="function">camera</tt>{
  <tt class="function">orthographic</tt>
  <tt class="function">location</tt> &lt;.5,.5,0&gt;
  <tt class="function">direction</tt> <tt class="function">z</tt>
  <tt class="function">up</tt> <tt class="function">y</tt>
  <tt class="function">right</tt> <tt class="function">x</tt>
}</pre><p xmlns="">
    </p><p xmlns="">
      Written as a set of functions it would be:
      </p><pre class="programlisting"><tt class="function">camera</tt>{
  <tt class="function">user_defined</tt>
  <tt class="function">location</tt>{
    <tt class="function">function</tt>{<tt class="function">u</tt>}
    <tt class="function">function</tt>{<tt class="function">v</tt>}
    <tt class="function">function</tt>{0}
  }
  <tt class="function">direction</tt>{
    <tt class="function">function</tt>{0}
    <tt class="function">function</tt>{0}
    <tt class="function">function</tt>{1}
  }
}</pre><p xmlns="">
    </p><p xmlns="">
      Defined with pigments it would be:
      </p><pre class="programlisting"><tt class="function">camera</tt>{
  <tt class="function">user_defined</tt>
  <tt class="function">location</tt>{
    <tt class="function">pigment</tt>{
      <tt class="function">gradient</tt> <tt class="function">x</tt>
      <tt class="function">pigment_map</tt>{
        [0 <tt class="function">gradient</tt> <tt class="function">y</tt> <tt class="function">color_map</tt>{[0 <tt class="function">rgb</tt> 0][1 <tt class="function">rgb</tt> <tt class="function">x</tt>]}]
        [1 <tt class="function">gradient</tt> <tt class="function">y</tt> <tt class="function">color_map</tt>{[0 <tt class="function">rgb</tt> <tt class="function">y</tt>][1 <tt class="function">rgb</tt> <tt class="function">x</tt>+<tt class="function">y</tt>]}]
      }
    }
  }
  <tt class="function">direction</tt>{
    <tt class="function">pigment</tt>{<tt class="function">rgb</tt> <tt class="function">z</tt>}
  }
}</pre><p xmlns="">
    </p><p xmlns="">
      Of course if it can make the script shorter, you can mix notations. You can use both functions
      and pigments in one camera definition:
      </p><pre class="programlisting"><tt class="function">camera</tt>{
  <tt class="function">user_defined</tt>
  <tt class="function">location</tt>{
    <tt class="function">function</tt>{<tt class="function">u</tt>}
    <tt class="function">function</tt>{<tt class="function">v</tt>}
    <tt class="function">function</tt>{0}
  }
  <tt class="function">direction</tt>{
    <tt class="function">pigment</tt>{<tt class="function">rgb</tt> <tt class="function">z</tt>}
  }
}</pre><p xmlns="">
    </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects"></a>2.4. Objects</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="common_features"></a>2.4.1. Common features</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="inside_bounding"></a>2.4.1.1. Bounding used in inside tests</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Micha</span> <span class="surname">Riser</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2511226"></a><p xmlns="">
    With MegaPOV, in every test using <tt class="function">Inside</tt> of objects
    the bounding object has now priority. It first tests if the point is inside the bounding.
    If it is not then it knows that it can already decide that the point is
    outside (if the object is not inversed) or that the point is inside (if the
    object is inversed).
  </p><p xmlns="">
    This should increase rendering speed of complicated CSG objects, since it could eliminate
    a lot of computing steps. The inside test is firstly done for the bounding object. Only when
    this test is inside the bounding, the tests against each of the objects composing the CSG object
    will be done.
  </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="text"></a>2.4.2. Text</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="text_align"></a>2.4.2.1. Text enhancements</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Yvo &amp; René</span> <span class="surname">Smellenbergh</span></h3></div></div></div><div></div></div><p xmlns="">
	Based on the text enhancement idea of Jamis Buck and Noel Bundy, but modified and extended.
  </p><p xmlns="">
	Syntax is:
	</p><pre xmlns="" class="synopsis"><tt class="function">text</tt> {
  <i class="parameter"><tt>the usual text stuff</tt></i>
  <i class="parameter"><tt>...</tt></i>
  [ <tt class="function">h_align_left</tt> | <tt class="function">h_align_center</tt> | <tt class="function">h_align_right</tt> ]
  [ <tt class="function">v_align_top</tt> | <tt class="function">v_align_center</tt> | <tt class="function">v_align_bottom</tt> ]
}</pre><p xmlns="">
  </p><p xmlns="">
	<tt class="function">h_align_left</tt><a class="indexterm" name="id2511654"></a>
	By adding this keyword to the text block, the text string (including horizontal offset) is aligned horizontally so that its most
	left point touches the y-axis. This is identical to the default alignment.
  </p><p xmlns="">
	<tt class="function">h_align_center</tt><a class="indexterm" name="id2513191"></a>
	By adding this keyword to the text block, the text string (including horizontal offset) is aligned horizontally so that it extends
	equally on both sides of the y-axis.
  </p><p xmlns="">
	<tt class="function">h_align_right</tt><a class="indexterm" name="id2513214"></a>
	By adding this keyword to the text block, the text string (including horizontal offset) is aligned horizontally so that its most
	right point touches the y-axis.
  </p><p xmlns="">
	<tt class="function">v_align_top</tt><a class="indexterm" name="id2513238"></a>
	By adding this keyword to the text block, the  text string (including vertical offset) is aligned vertically so that its highest
	point touches the x-axis.
  </p><p xmlns="">
	<tt class="function">v_align_center</tt><a class="indexterm" name="id2513260"></a>
	By adding this keyword to the text block, the text string (including vertical offset) is aligned vertically so that its middle
	height sits on the x-axis.
  </p><p xmlns="">
	<tt class="function">v_align_bottom</tt><a class="indexterm" name="id2513284"></a>
	By adding this keyword to the text block, the text string (including vertical offset) is aligned vertically so that its lowest point
	sits on the x-axis.
  </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
    When no alignment is specified, the <span class="trademark">POV-Ray</span>&#8482; defaults are used. Horizontally to the left and vertically on the base line.
   </p><p>
	The old keyword "position" of previous MegaPOV versions is no longer supported.
  </p></td></tr></table></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="cloth"></a>2.4.3. Cloth simulation</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christophe</span> <span class="surname">Bouffartigue</span></h3></div></div></div><div></div></div><p xmlns="">
    <tt class="function">simcloth</tt> allows to simulate cloth in MegaPOV. The cloth patch is rectangular, and interacts with its
    environment (gravity, some obstructing objects, wind, ...).
  </p><p xmlns="">Syntax is:
    </p><pre xmlns="" class="synopsis">  <tt class="function">simcloth</tt> {
    [ <tt class="function">environment</tt> <i class="parameter"><tt>OBJECT-IDENTIFIER</tt></i> ]
    [ <tt class="function">friction</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
    [ <tt class="function">gravity</tt> <i class="parameter"><tt>VECTOR</tt></i> ]
    [ <tt class="function">wind</tt> { <i class="parameter"><tt>PIGMENT</tt></i> } ]
    [ <tt class="function">viscosity</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
    [ <tt class="function">neighbors</tt> <i class="parameter"><tt>0</tt></i> | <i class="parameter"><tt>1</tt></i> ]
    [ <tt class="function">internal_collision</tt> <tt class="function">on</tt> | <tt class="function">off</tt> ]
    [ <tt class="function">damping</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
    [ <tt class="function">intervals</tt> <i class="parameter"><tt>FLOAT</tt></i> ]
    [ <tt class="function">iterations</tt> <i class="parameter"><tt>INTEGER</tt></i> ]
    <tt class="function">input</tt> <i class="parameter"><tt>STRING</tt></i>
    [ <tt class="function">output</tt> <i class="parameter"><tt>STRING</tt></i> ]
    [ <tt class="function">mesh_output</tt> <i class="parameter"><tt>STRING</tt></i> ]
    [ <tt class="function">smooth_mesh</tt> <tt class="function">on</tt> | <tt class="function">off</tt> ]
    [ <tt class="function">uv_mesh</tt> <tt class="function">on</tt> | <tt class="function">off</tt> ]
  }</pre><p xmlns="">
  </p><p xmlns="">
    <tt class="function">environment</tt>   is followed by an object identifier. The object should be declared before <tt class="function">simcloth</tt> {}.
    This object defines the environment that will interact with the cloth. Although any object can be used, it is recommended
    to use objects which have well-defined interiors.
  </p><p xmlns="">
    <tt class="function">friction</tt>  is a coefficient specifying energy loss when the cloth touches the environment.
    A low value (&lt;= 0) means a lot of friction and strongly slows the movement of the cloth.
    A high value (&gt;= 1) will allow the cloth to slide over the objects (but not to bounce off ...).
    Default value is 1.0
   </p><p xmlns="">
     <tt class="function">gravity</tt>  Specifies the direction and the strength of gravity. The default value is &lt;0, 0, 0&gt;.
   </p><p xmlns="">
     <tt class="function">wind</tt>  A pigment is used to define the direction and strength of the wind in every space location.
     At a given point, the wind is defined by the red, green and blue components of the pigment at this point.
     You can explicitly declare the pigment, or use an already declared identifier. Don't forget that the color
     components can take any value you want (negative ones, greater than one, ...)
   </p><p xmlns="">
     <tt class="function">viscosity</tt>  Specifies the influence of the wind and air friction on the cloth. The default value
     is 0 (no influence).
   </p><p xmlns="">
     <tt class="function">neighbors</tt>  Specifies the number of neighbors that are joined by springs at each point. <tt class="function">neighbors</tt> 0
     is for 8 neighbors (faster but rougher calculation), and <tt class="function">neighbors</tt> 1 (default value) is for 24 neighbors
     (slower calculation, but better results).
   </p><p xmlns="">
     <tt class="function">internal_collision</tt>  Activates or deactivates internal collision management (cloth against itself). This
     problem is handled by added springs between points that are too close together. System instability probability
     is increased, and you must, most often, decrease the intervals parameter (see below). Deactivated by default
     (warning: much longer parsing when activated).
   </p><p xmlns="">
     <tt class="function">damping</tt>  General energy loss parameter, it limits the accumulation of the model approximations and
     errors. A value lower than 0.95 (default value) is strongly recommended.
   </p><p xmlns="">
     <tt class="function">intervals</tt>  specifies the time interval between each iteration. Keep it low. Default value is 0.05.
   </p><p xmlns="">
     <tt class="function">iterations</tt>  It's the number of iterations to calculate.
   </p><p xmlns="">
     <tt class="function">input</tt> Filename of the starting *.cth file. The only required parameter, since you need a cloth to start with.
     For a complete description of the *.cth file format, see below.
   </p><p xmlns="">
     <tt class="function">output</tt>  Filename of the ending *.cth file. If this parameter is specified, the result of the simulation
     is saved. Useful for animations, or for a multi-stage calculation.
   </p><p xmlns="">
     <tt class="function">mesh_output</tt>  Allow the program to output a file (with specified name), containing tons of triangles,
     corresponding to the cloth points after the simulation. It allows you to save the result of a simulation, in
     a format usable by other <span class="trademark">POV-Ray</span>&#8482; versions (official or unofficial).
   </p><p xmlns="">
     <tt class="function">smooth_mesh</tt> Activate or deactivate the creation of smooth_triangle's if the mesh_output option is activated.
     Deactivated by default.
   </p><p xmlns="">
     <tt class="function">uv_mesh</tt>  Activates or deactivates uv coordinates within the triangle (or smooth_triangle) if the mesh_output
     option is activated. UV coordinates go from  &lt;0, 0&gt; to &lt;1, 1&gt;. Deactivated by default.
   </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2514107"></a>2.4.3.1. Description of the .cth file format:</h4></div></div><div></div></div><p xmlns="">
       The file format is simple: the first line describes the cloth dimensions (number of points <i class="parameter"><tt>n1</tt></i> and
       <i class="parameter"><tt>n2</tt></i>, normalized length between 2 neighbors <i class="parameter"><tt>nlng</tt></i>), and the springs strength
       <i class="parameter"><tt>ks</tt></i>. The other lines describe the location in space and velocity of each point. All values (3 for
       location, 3 for speed) are separated by commas, and each line is terminated by a comma as well.
     </p><p xmlns="">
       Then, there are the constraints definitions. Constraints are 3 coefficients (1 for each axis) that will control
       the velocity vector of a given point of the cloth. It will be possible, for instance, to slow down a corner of the
       cloth along one axis, to completely stop it along another axis, and let it free along the last one. A constraint is
       defined by an integer (index), and 3 floating point coefficients, representing the constraint
       (respectively on x, y, z axis), all this on the same line and separated by commas. The index is the rank of the
       point (beginning at 0) in order of declaration of the cloth points. Constraints can be declared in any order.
     </p><p xmlns="">
       You could see the cloth as 2 arrays of vectors Points[n1][n2], and Velocity[n1][n2], and its constraints
       <tt xmlns="" class="function">Index</tt><i xmlns="" class="parameter"><tt>n</tt></i>, <tt xmlns="" class="function">coef</tt><i xmlns="" class="parameter"><tt>n</tt></i>.
       The <tt xmlns="" class="filename">*.cth</tt> file will look like this:
     </p><pre xmlns="" class="programlisting">n1, n2, nlng, ks,
Points[0][0], Velocity[0][0],
Points[0][1], Velocity[0][1],
...
Points[0][n2-1], Velocity[0][n2-1],
Points[1][0], Velocity[1][0],
Points[1][1], Velocity[1][1],
...
Points[1][n2-1], Velocity[1][n2-1],
Points[2][0], Velocity[2][0],
...
...
Points[n1-1][n2-1], Velocity[n1-1][n2-1],
Index1, coef1[x], coef1[y], coef1[z],
Index2, coef2[x], coef2[y], coef2[z],
Index3, coef3[x], coef3[y], coef3[z],</pre><p xmlns="">
      For an example of a macro writing such a file (see <a xmlns="" href="#writecloth" title="4.1.1.1.1. Writing a *.cth file">Section 4.1.1.1.1, &#8220;Writing a *.cth file&#8221;</a>).
    </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="isosurface"></a>2.4.4. Isosurface</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="iso_message"></a>2.4.4.1. Control of max gradient message</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Yvo &amp; René</span> <span class="surname">Smellenbergh</span></h3></div></div></div><div></div></div><p xmlns="">
	In <span class="trademark">POV-Ray</span>&#8482; 3.5 the messages concerning the <tt class="function">max_gradient</tt> follow a heuristic method to be displayed.
	This means that the message only appears when the difference with the set <tt class="function">max_gradient</tt> is more
	than a certain percentage. Also when using a loop with hundreds of isosurfaces which have different
	<tt class="function">max_gradient</tt>'s, you need to wait after the render for all those messages to be displayed: this can
	take several minutes. Basically, you cannot control these messages.
  </p><p xmlns="">
	In MegaPOV 1.0 you can use the keyword <tt xmlns="" class="function">message</tt><a xmlns="" class="indexterm" name="id2511083"></a> to control the message flow:
	</p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">message</tt> <tt class="function">on</tt>  will always show all max_gradient messages</li><li><tt class="function">message</tt> <tt class="function">off</tt>  will never show a max_gradient message</li><li>without a <tt class="function">message</tt> keyword the default heuristic method will be used</li></ul></div><p xmlns="">
	This keyword is used in the <tt xmlns="" class="function">isosurface</tt>{} block and should be used after the <tt xmlns="" class="function">function</tt>{} block and before any material.
  </p><p xmlns="">
  By using conditional expressions, you can now control messages in a loop.
  </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="light"></a>2.4.5. Light Sources</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="area_light_mtl"></a>2.4.5.1. Area Light <tt class="function">max_trace_level</tt></h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
	Normally area lights are handled as area lights in all situations.  This means that 
  every shadow ray test against an area light source is sampled across the area of the 
  light source.  This patch allows to specify a <tt class="function">max_trace_level</tt> for the area 
  light which turns off the soft shadows above the specified trace level. 
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2515276"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">light_source</tt> {
  <i class="parameter"><tt>LOCATION</tt></i>, <i class="parameter"><tt>COLOR</tt></i>
  [LIGHT_MODIFIERS...]
  <tt class="function">max_trace_level</tt> <i class="parameter"><tt>INTEGER</tt></i>
}</pre><p xmlns="">
  </p><p xmlns="">
    If you for example specify:
    </p><pre xmlns="" class="programlisting"><tt class="function">light_source</tt> {
  &lt;1.0,2.0,2.0&gt;
  color rgb 1.0
  area_light 0.5*x 0.5*y 9,9 jitter adaptive 1 circular orient
  <tt class="function">max_trace_level</tt> 1
}</pre><p xmlns="">

    this will only result in soft shadows on directly visible surfaces.  In reflections, 
    refractions and radiosity the light source will be treated as a point light.
  </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="effects"></a>2.5. Effects</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="glow"></a>2.5.1. Glow</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></h3></div></div></div><div></div></div><p xmlns="">
	This atmospheric glow effect makes a fast-rendering glow effect. It is based on the light source glow effect from
	POV-AFX, written by Marcos Fajardo, but has been heavily modified.
  </p><p xmlns="">Syntax is:
	<a xmlns="" class="indexterm" name="id2513635"></a>
	<a xmlns="" class="indexterm" name="id2513646"></a>
	</p><pre xmlns="" class="synopsis"><tt class="function">glow</tt> {
  <tt class="function">type</tt> <i class="parameter"><tt>0 | 1 | 2 | 3</tt></i>
  <tt class="function">location</tt> <i class="parameter"><tt>VECTOR</tt></i>
  <tt class="function">size</tt> <i class="parameter"><tt>FLOAT</tt></i>
  <tt class="function">radius</tt> <i class="parameter"><tt>FLOAT</tt></i>
  <tt class="function">fade_power</tt> <i class="parameter"><tt>FLOAT</tt></i>
  <tt class="function">color</tt> <i class="parameter"><tt>COLOR</tt></i>
  <i class="parameter"><tt>TRANSFORMATIONS</tt></i>
}</pre><p xmlns="">
	You can specify glows individually, or attached to a light_source. If created in a light source, they will be
	automatically initialized with the light's position and color (though transforming the light source will not give the
	expected result).
  </p><p xmlns="">
	Choose a glow <tt class="function">type</tt><a class="indexterm" name="id2515040"></a>
	from 0, 1, 2 or 3. Type 2 and 3 glows are not completely implemented yet, but 2 will be
	based on the exp() function and 3 will simulate a sphere with constant density.
  </p><p xmlns="">
	The <tt class="function">size</tt><a class="indexterm" name="id2515063"></a>
	keyword adjusts the scale of the glow effect. It is not an absolute size, just a scaling amount (because
	some glows are infinite). It does not quite work properly yet, it causes strange effects with changing distances of
	objects behind the glow.
  </p><p xmlns="">
	The <tt class="function">radius</tt><a class="indexterm" name="id2515087"></a>
	keyword specifies a clipping radius confining the glow to a circular area perpendicular to the ray. If
	the glow is still visible at this radius, it will make a sudden transition.
  </p><p xmlns="">
	The <tt class="function">fade_power</tt><a class="indexterm" name="id2515110"></a>
	keyword allows you to provide an exponent to adjust the falloff with.
  </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      A glow is not an object, it is an atmospheric effect. Therefore glows cannot be used in CSG operations.
    </p><p>
      Transformations on a glow only affect the <tt class="function">location</tt> vector. So will <tt class="function">scale</tt> not change the size or shape
      of a glow, but scale the location coordinates.
    </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="motion_blur"></a>2.5.2. Motion blur</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Nathan</span> <span class="surname">Kopp</span></h3></div></div></div><div></div></div><p xmlns="">
    A <tt class="function">motion_blur</tt> object is created by averaging many transformed copies of
    that object. Because only part of the image has to go through some extra calculations, this
    internal motion blur is usually faster than averaging whole images with an external program.
  </p><p xmlns="">
    This patch only does <span class="emphasis"><em>per-object</em></span> motion blur. The camera cannot be blurred
    using this method.
  </p><p xmlns="">
    Also lights can be blurred using this method: the performance is comparable to the performance
    of area lights.
  </p><p xmlns="">
    To initialize motion blur, add the following to your <tt xmlns="" class="function">global_settings</tt> block:
</p><pre xmlns="" class="synopsis">  <tt class="function">global_settings</tt> {
    <tt class="function">motion_blur</tt> SAMPLES, SHUTTER-TIME
  }</pre><p xmlns="">
    <span xmlns="" class="emphasis"><em>SAMPLES</em></span> is the number of time-frames that will be sampled. More samples
    will give smoother results, but will take longer to render.
  </p><p xmlns="">  
    <span xmlns="" class="emphasis"><em>SHUTTER-TIME</em></span> is the amount of time the shutter is open in POV-clock
    units. Depending on the specified type, this time interval will be centered around, or added
    to the clock value for the current frame.
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        Especially in animations it will give more natural results when this value is kept close
        to the <tt class="function">clock_delta</tt> value. You could #declare Shutter_time = <tt class="function">clock_delta</tt>*Small_factor;
      </p></td></tr></table></div><p xmlns="">
  </p><p xmlns="">To create a Motion Blur object, use the following syntax:
	  <a xmlns="" class="indexterm" name="id2516198"></a>
	  <a xmlns="" class="indexterm" name="id2516209"></a>
	  </p><pre xmlns="" class="synopsis">  <tt class="function">motion_blur</tt> {
    <tt class="function">type</tt> <i class="parameter"><tt>0</tt></i> | <i class="parameter"><tt>1</tt></i>
    OBJECT | LIGHT-SOURCE
    OBJECT-MODIFIERS
  }</pre><p xmlns="">
  	<span xmlns="" class="emphasis"><em>Type 0</em></span> will oscillate the motion blur around the current clock value. Half of
  	the <span xmlns="" class="emphasis"><em>SHUTTER-TIME</em></span> value is subtracted from, the other half added to that
  	clock value. Type 0 is the default.
  </p><p xmlns="">
    <span class="emphasis"><em>Type 1</em></span>	will add the full <span class="emphasis"><em>SHUTTER-TIME</em></span> value to the
    current clock value.
  </p><p xmlns="">
    Motion blur is triggered by the keyword <tt class="function">clock</tt>. Any modifier in the <tt class="function">motion_blur</tt> block
    that contains the <tt class="function">clock</tt> keyword will show a blurring effect on that modifier.
  </p><p xmlns="">
    Example:
</p><pre xmlns="" class="programlisting">  <tt class="function">motion_blur</tt> {
    <tt class="function">sphere</tt> { 0, 1  <tt class="function">material</tt> { My_material <tt class="function">rotate</tt> x*<tt class="function">clock</tt>}}
    <tt class="function">translate</tt> x*<tt class="function">clock</tt>
  }</pre><p xmlns="">
    Here the <tt xmlns="" class="function">clock</tt> keyword within the material will trigger a rotational blurring of this
    material and the <tt xmlns="" class="function">clock</tt> keyword within the motion_blur block will trigger a motion blur
    in the translation of the sphere.
  </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      A motion_blur object contains many copies of the blurred object (one copy for each time
      sample). For this reason, adding this kind of motion blur can use a lot of memory.
      Be careful of this. (Remember that multiple copies of mesh objects do not use much memory, though.)
    </p></td></tr></table></div><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      The blurring is achieved by parsing the contents of the motion_blur object (everything
      between the curly braces) many times (once for each time sample). Anything outside of the
      motion_blur block is only parsed once. This means that only one copy gets created of any
      item declared outside the blur object. And this static copy is applied to each copy of the
      motion-blurred object.
    </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="fur"></a>2.5.3. Fur</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Thomas</span> <span class="surname">Willhalm</span></h3></div></div></div><div></div></div><p xmlns="">
    The fur patch extends media to generate faked three dimensional fur. This is done by "filling"
    a media container with a new scattering type <i class="parameter"><tt>6</tt></i>. The light is scattered inside the
    container approximately like a lot of hairs would scatter them. Furthermore, the density is varied between
    dense regions ("Here is a hair.") and sparse regions ("Space between the hairs").
  </p><p xmlns="">The syntax is:
    <a xmlns="" class="indexterm" name="id2515835"></a>
    <a xmlns="" class="indexterm" name="id2515846"></a>
    <a xmlns="" class="indexterm" name="id2515856"></a>
    <a xmlns="" class="indexterm" name="id2515867"></a>
    <a xmlns="" class="indexterm" name="id2515878"></a>
    <a xmlns="" class="indexterm" name="id2515889"></a>
    <a xmlns="" class="indexterm" name="id2515900"></a>
    <a xmlns="" class="indexterm" name="id2515910"></a>
    <a xmlns="" class="indexterm" name="id2515921"></a>
    <a xmlns="" class="indexterm" name="id2515932"></a>
    <a xmlns="" class="indexterm" name="id2515943"></a>
    <a xmlns="" class="indexterm" name="id2515954"></a>
    <a xmlns="" class="indexterm" name="id2515964"></a>
    <a xmlns="" class="indexterm" name="id2515975"></a>
    <a xmlns="" class="indexterm" name="id2515986"></a>
    <a xmlns="" class="indexterm" name="id2515997"></a>
    <a xmlns="" class="indexterm" name="id2516008"></a>
    <a xmlns="" class="indexterm" name="id2516018"></a>
</p><pre xmlns="" class="synopsis"><tt class="function">scattering</tt> { 6, COLOUR
	[ <tt class="function">structure</tt> { OBJECT_TYPE } ]
	[ <tt class="function">ratio</tt> FLOAT ]
	[ <tt class="function">falloff</tt> FLOAT ]
	[ <tt class="function">frequency</tt> FLOAT ]
	[ <tt class="function">diffuse</tt> FLOAT ]
	[ <tt class="function">reflection</tt> FLOAT ]
	[ <tt class="function">reflection_exponent</tt> FLOAT ]
	[ <tt class="function">force</tt> VECTOR ]
	[ <tt class="function">waves</tt> FLOAT ]
	[ <tt class="function">pigment</tt> PIGMENT ]
}

OBJECT_TYPE:
  <tt class="function">sphere</tt> { VECTOR, FLOAT } |
  <tt class="function">torus</tt> { FLOAT, FLOAT } |
  <tt class="function">box</tt> { VECTOR, VECTOR } |
  <tt class="function">cylinder</tt> { VECTOR, VECTOR, FLOAT } |
  <tt class="function">cone</tt> { VECTOR, VECTOR, FLOAT } |
  <tt class="function">plane</tt> { VECTOR, FLOAT } |
  <tt class="function">smooth_triangle</tt> { VECTOR, VECTOR, VECTOR, VECTOR, VECTOR, VECTOR }</pre><p xmlns="">
  </p><p xmlns="">
    In order to simulate fur, we need a <tt class="function">structure</tt> to which we attach the hairs.
    The <tt class="function">structure</tt> provides the positions and directions in which the hairs grow.
    The possible object types <tt class="function">sphere</tt>, <tt class="function">torus</tt>, <tt class="function">box</tt>, <tt class="function">cylinder</tt>,
    <tt class="function">cone</tt>, <tt class="function">plane</tt>, and <tt class="function">smooth_triangle</tt> and their respective parameters
    are known from <span class="trademark">POV-Ray</span>&#8482;. Remark however, that the provided <tt class="function">structure</tt> is not
    necessarily tied to the type of container you use. You are free to fill a (complicated)
    container with a different (approximating) structure. The default structure is a sphere
    at the origin with radius 1.
  </p><p xmlns="">
    With the next three parameters you can influence the way hairs are grown. The <tt class="function">ratio</tt>
    is the ratio between hairs and empty space (default: <i class="parameter"><tt>0.3</tt></i>). The
    <tt class="function">falloff</tt> value describes how fast the density changes from dense (hair) to sparse
    (space). It you change the default value <i class="parameter"><tt>0.9</tt></i>, you can create sharper
    hairs or more fluffy fur. The <tt class="function">frequency</tt> (default 200.0) determines the scale of the
    fur (lots of thin hairs vs. fewer thicker hairs).
  </p><p xmlns="">
    The next three parameters describe how light is reflected in the media. The <tt class="function">diffuse</tt>
    component is similar to the diffuse reflection in usual textures. The default value however
    is <i class="parameter"><tt>5.0</tt></i>. The <tt class="function">reflection</tt> component creates highlights on the
    hairs. The default reflection is <i class="parameter"><tt>1.0</tt></i>. The appearance of the reflection
    can be modified by the <tt class="function">reflection_exponent</tt> varying from bright spots to soft areas.
    The default exponent is <i class="parameter"><tt>1.0</tt></i>.
  </p><p xmlns="">
    With the parameter <tt class="function">force</tt> you can simulate a force pulling the hairs in one direction.
    Applications include gravity and wind. The vector that you provide determines the direction and
    the strength of the force.
  </p><p xmlns="">
    Curly fur can be created by setting the parameter <tt class="function">waves</tt>. The larger this parameter is,
    the bigger the turbulence of the hairs.
  </p><p xmlns="">
    Last but not least the fur patch provides a convenient way of setting a pigment of the fur.
    If you're modelling a tiger or a cow, you can realize the colors by using pigment.
    The default value is the usual colour of the media. Using a <tt class="function">pigment</tt> overrides this colour.
  </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="patterns"></a>2.6. Textures and patterns</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="aoi_pattern"></a>2.6.1. Angle of incidence</h3></div><div><div class="author"><h3 class="author"><span class="surname">Mael</span></h3></div></div></div><div></div></div><p xmlns="">
    The value returned by this pattern is proportional to the angle between a
    certain ray and the (perturbed) normal at the surface of the object. The
    range of returned values goes from 0 to 1.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2517017"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">pigment</tt> { <tt class="function">aoi</tt> [ <i class="parameter"><tt>POINT</tt></i> ] }</pre><p xmlns="">
  </p><p xmlns="">
    When no <i xmlns="" class="parameter"><tt>POINT</tt></i> is given, the incident ray of rendering
    is used.  This is not necessarily the ray coming from the camera, it can
    also be a secondary ray from reflection or refraction effects.

    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>With this option and without reflection and refraction, the range
    of return values on the visible surfaces goes from 0 to 0.5 since the angle
    between ray and normal can only be less than 90 degrees</p></td></tr></table></div><p xmlns="">
  </p><p xmlns="">
    When a <i class="parameter"><tt>POINT</tt></i> is specified, the reference ray
    for measuring the angle will be the ray between this specified point and
    the intersection point on the object.
  </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      This pattern can only be used in situations where the intersection information
      of the rendering process is available.  This applies for usage in pigments, textures
      and normals but not in media densities or functions.
    </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="listed_pattern"></a>2.6.2. Listed pattern</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></h3></div></div></div><div></div></div><p xmlns="">Syntax is:
	<a xmlns="" class="indexterm" name="id2517009"></a>
	</p><pre xmlns="" class="synopsis"><tt class="function">pigment</tt> {
  <tt class="function">listed</tt> <i class="parameter"><tt>FLOAT</tt></i>
  <tt class="function">color_map</tt> { <i class="parameter"><tt>color_map stuff }</tt></i> } |
  <tt class="function">pigment_map</tt> { <i class="parameter"><tt>pigment_map stuff }</tt></i> }
}

<tt class="function">normal</tt> {
  <tt class="function">listed</tt> <i class="parameter"><tt>FLOAT</tt></i>
  <tt class="function">normal_map</tt> { <i class="parameter"><tt>normal_map stuff }</tt></i> }
}</pre><p xmlns="">
	This "pattern" is simply a solid pattern, the value of <i xmlns="" class="parameter"><tt>FLOAT</tt></i> is used as the return value of the
	pattern. This means that the pattern listed at the specified <i xmlns="" class="parameter"><tt>FLOAT</tt></i> value is used as the pattern for the
	whole object.
  </p><p xmlns="">
	This is very useful in having a progression of objects blending from one texture to another, and can also be useful in animating
	textures.
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="projection_pattern"></a>2.6.3. Projection pattern</h3></div><div><div class="author"><h3 class="author"><span class="surname">Mael</span></h3></div></div></div><div></div></div><p xmlns="">
    In this pattern the pattern value is determined by shooting a ray
    in a certain direction.  When this ray hits a specified object it returns 1, if
    not it returns 0. There are a few options to specify the direction of this ray.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2517903"></a>
    </p><pre xmlns="" class="synopsis">
pigment { ... | <i class="parameter"><tt>PROJECTION_PATTERN</tt></i> }
normal { ... | <i class="parameter"><tt>PROJECTION_PATTERN</tt></i> }

<i class="parameter"><tt>PROJECTION_PATTERN</tt></i>:
  projection { <i class="parameter"><tt>PROJECTION_OBJECT</tt></i> <i class="parameter"><tt>PROJECTION_TYPE</tt></i> [<i class="parameter"><tt>BLUR_MODIFIER</tt></i>] }

<i class="parameter"><tt>PROJECTION_OBJECT</tt></i>:
  <i class="parameter"><tt>OBJECT_IDENTIFIER</tt></i> |
  object { ... }

<i class="parameter"><tt>PROJECTION_TYPE</tt></i>:
  point <i class="parameter"><tt>VECTOR</tt></i> |
  parallel <i class="parameter"><tt>VECTOR</tt></i> |
  normal [on|off]

<i class="parameter"><tt>BLUR_MODIFIER</tt></i>:
  blur <i class="parameter"><tt>BLUR_AMOUNT</tt></i>, <i class="parameter"><tt>BLUR_SAMPLES</tt></i>
    </pre><p xmlns="">
  </p><p xmlns="">
    With <tt class="function">point</tt> <i class="parameter"><tt>VECTOR</tt></i> specified the rays
    are shot in direction of this point. When a ray hits the specified object,
    the value 1 is returned, otherwise 0.
  </p><p xmlns="">
    When the keyword <tt class="function">parallel</tt> is used, a ray is shot from each intersection
    point in the specified direction. When a ray hits the specified object, the value
    1 is returned, otherwise 0.
  </p><p xmlns="">
    When the keyword <tt class="function">normal</tt> is used, a ray direction is determined by
    the normal vector of the surface.  This variation can only be used when the intersection
    information is available, i.e. in pigments, textures and normals. It does not work in
    media density and functions.
  </p><p xmlns="">
    With the <tt xmlns="" class="function">blur</tt> option, a number of <i xmlns="" class="parameter"><tt>BLUR_SAMPLES</tt></i> rays is sent, more or less modified
    spread over an area determined by the specified <i xmlns="" class="parameter"><tt>BLUR_AMOUNT</tt></i> value.
    The pattern value returned is the percentage of rays that intersect with the object.
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>When no blur is used the pattern returns either 0 and 1.  When used in a pigment
      only the colors for the values 0 and 1 in the <tt class="function">color_map</tt> are used.  </p><p>With blur on, the pattern can also return other values.</p></td></tr></table></div><p xmlns="">
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="displace_warp"></a>2.6.4. Displace warp for patterns</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></h3></div></div></div><div></div></div><p xmlns="">Syntax is:
	<a xmlns="" class="indexterm" name="id2517662"></a>
	<a xmlns="" class="indexterm" name="id2516804"></a>
	</p><pre xmlns="" class="synopsis"><tt class="function">warp</tt> {
  <tt class="function">displace</tt> {
    <i class="parameter"><tt>PATTERN</tt></i> | <i class="parameter"><tt>FUNCTION</tt></i>, <i class="parameter"><tt>COLOR_MAP</tt></i>
    <tt class="function">type</tt> <i class="parameter"><tt>0</tt></i> | <i class="parameter"><tt>1</tt></i>
  }
}</pre><p xmlns="">
	 Displaces the pattern by an amount determined by the PATTERN or FUNCTION and COLOR_MAP at each point.
  </p><p xmlns="">
	 In <tt class="function">type</tt> 0, the rgb values of the pigment at each point are used as xyz displacement amounts.
  </p><p xmlns="">
	In <tt class="function">type</tt> 1, the brightness of the pigment color determines the directions and amounts points are pushed.
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="noisepigment"></a>2.6.5. Noise pigment</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></h3></div></div></div><div></div></div><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2517372"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">pigment</tt> { <tt class="function">noise_pigment</tt> { <i class="parameter"><tt>TYPE</tt></i>, <i class="parameter"><tt>MIN_COLOR</tt></i>, <i class="parameter"><tt>MAX_COLOR</tt></i> } }
</pre><p xmlns="">
    TYPE:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><i class="parameter"><tt>0</tt></i> - plain color</li><li><i class="parameter"><tt>1</tt></i> - plain monochrome</li><li><i class="parameter"><tt>2</tt></i> - Gaussian color</li><li><i class="parameter"><tt>3</tt></i> - Gaussian monochrome</li></ul></div><p xmlns="">
    Produces a "static" effect. This is a pigment, like an image_map, not a pattern. Anti-aliasing tends to mess
    it up when used in textures, and it is not animation-safe (unless you want an animated static effect).
    It can be used in an average map to add some noise to a pigment.
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="hdr"></a>2.6.6. HDR (High Dynamic Range) image type</h3></div><div><div class="author"><h3 class="author"><span class="surname">Mael</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2518086"></a><a xmlns="" class="indexterm" name="id2518097"></a><a xmlns="" class="indexterm" name="id2519039"></a><a xmlns="" class="indexterm" name="id2519050"></a><p xmlns="">
    This patch introduces support for a new image file format for
    reading in <tt class="function">image_map</tt>, <tt class="function">image_pattern</tt>
    and other cases.  A usual image file stores the color values
    with 8 bit resolution which means a dynamic range of 255:1.  In other words
    in the dark areas of an image color nuances can only be represented down to
    1/255 of the maximum brightness of the image.  All darker parts are completely
    black.  High dynamic range images support a wider range of color
    values than common image files.
  </p><p xmlns="">
    The HDR file format supported by MegaPOV is the
    <span class="emphasis"><em>rgbe format</em></span> developed by
    <span class="emphasis"><em>Greg Ward</em></span> for the RADIANCE software package.
    It stores the color values in four bytes: three for the red, green and blue color value
    and one as a common exponent.  Further information and image files in this
    format can be found on:
  </p><p xmlns="">
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="http://www.debevec.org/Research/HDR/" target="_top">http://www.debevec.org/Research/HDR/</a></li><li><a href="http://www.rna.hr/home.htm" target="_top">http://www.rna.hr/home.htm</a></li><li><a href="http://radiosity.tripod.co.jp/hdri/lightprobe3.htm" target="_top">http://radiosity.tripod.co.jp/hdri/lightprobe3.htm</a></li><li><a href="http://radsite.lbl.gov/radiance/" target="_top">http://radsite.lbl.gov/radiance/</a></li></ul></div><p xmlns="">
  </p><p xmlns="">
    Syntax for an image map is:

    </p><pre xmlns="" class="synopsis">image_map {
  hdr "file.hdr"
  [map_type 7]
}</pre><p xmlns="">

    The	new <tt xmlns="" class="function">map_type</tt> 7 allows correct mapping of the
    omnidirectional light probes that can be found on
    <a xmlns="" href="http://www.debevec.org/Probes/" target="_top">Paul Debevec's website</a> and elsewhere.
  </p><div xmlns="" class="example"><a name="id2519179"></a><p class="title"><b>Example 2.9. HDR image example</b></p><p xmlns="">
      Varying the ambient finish shows the high dynamic range of the image

      </p><pre class="programlisting">camera {
  orthographic
  location &lt;.5,.5,-5&gt;
  right 1*x
  up 1*y
  look_at &lt;.5,.5,0&gt;
}

plane {
  z,0
  pigment {
    image_map { hdr "rosette.hdr" once interpolate 2}
  }
  finish { ambient 1.0 diffuse 0 }
}</pre><p xmlns="">
    </p><p xmlns="">
      </p><div class="table"><a name="id2519204"></a><p class="title"><b>Table 2.2. HDR image ambient variations</b></p><table summary="HDR image ambient variations" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/hdr1.png"></div></td><td style="" align="center"><div><img src="img/hdr2.png"></div></td><td style="" align="center"><div><img src="img/hdr3.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>ambient 1.0</em></span></td><td style="" align="center"><span class="emphasis"><em>ambient 10</em></span></td><td style="" align="center"><span class="emphasis"><em>ambient 30</em></span></td></tr></tbody></table></div><p xmlns="">
    </p></div><p xmlns="">
    HDR images can be most useful for illuminating scenes with a realistic
    light distribution.  Reflections become more realistic and with
    <tt class="function">radiosity</tt> you can get a nice appearance of diffuse
    surfaces as well.  A sample scene for this technique can be found in the
    MegaPOV package.  A short tutorial on that matter can be found in
    <a href="#hdri_tutorial" title="4.3.1. HDRI tutorial">Section 4.3.1, &#8220;HDRI tutorial&#8221;</a>.
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="bicubic_image"></a>2.6.7. Bicubic interpolation for images</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Lutz</span> <span class="othername">Peter</span> <span class="surname">Hooge</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2518957"></a><p xmlns="">
    <span class="trademark">POV-Ray</span>&#8482; offers two interpolation methods for images: <tt class="function">2</tt> (bilinear) and 
    <tt class="function">4</tt> (normalized distance).  This patch implements a bicubic interpolation
    as method 3.
  </p><div xmlns="" class="example"><a name="id2519018"></a><p class="title"><b>Example 2.10. Bicubic interpolation for an image map</b></p><p xmlns="">
      The following code activates bicubic interpolation in an <tt xmlns="" class="function">image_map</tt> pigment.

      </p><pre class="programlisting">pigment {
  image_map {
    png "my_image.png"
    interpolate 3
  }
}</pre><p xmlns="">

    </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="camera_view"></a>2.6.8. New <tt class="function">camera_view</tt> pigment</h3></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    In order to obtain the content rendered by some camera as an <tt class="function">image_map</tt> - without the need for
    multiple renderings - there is now a new <tt class="function">camera_view</tt> pigment type introduced in MegaPOV 1.1.
  </p><p xmlns="">Syntax is:
    <a xmlns="" class="indexterm" name="id2519882"></a>
    <a xmlns="" class="indexterm" name="id2519892"></a>
    </p><pre xmlns="" class="synopsis"><tt class="function">pigment</tt> { <tt class="function">camera_view</tt>{ [CAMERA_ITEMS...] [<tt class="function">output</tt> <i class="parameter"><tt>OUTPUT_TYPE</tt></i>] } }

<i class="parameter"><tt>OUTPUT_TYPE</tt></i>:
  0 | 1 | 2 | 3 | 4 | 5

  // 0 - classic color output (default)
  // 1 - intersection point components as color components
  // 2 - components of normal vector at intersection point
  // 3 - components of perturbed normal vector 
  // 4 - depth (distance between camera location and intersection)
  // 5 - components of uv coordinates at intersection
</pre><p xmlns="">
  </p><p xmlns="">
    The scene viewed by this camera is rendered directly within the area &lt;0,0&gt;-&lt;1,1&gt;.
    Additional <tt class="function">output</tt> keyword allows other rendering data to be presented (see <a href="#mp_consts_camera_view" title="3.2.1. Output types for camera_view pigment">Section 3.2.1, &#8220;Output types for camera_view pigment&#8221;</a>).
  </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
      The <tt class="function">camera_view</tt> pigment is calculated using structures created <span class="emphasis"><em>after</em></span> parsing which
      makes it impossible to evaluate it during parsing of scene.
    </p><p>
      When using the camera_view in a recursive way (image in image) the <tt class="function">max_trace_level</tt> controls the number
      of times the image is showed. Raise <tt class="function">max_trace_level</tt> when at a certain recursion level the image gets the
      background color.
    </p></td></tr></table></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="global_settings"></a>2.7. Global Settings</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="film_exposure"></a>2.7.1. Film exposure simulation</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Kari</span> <span class="surname">Kivisalo</span></h3></div></div></div><div></div></div><p xmlns="">
    This addition simulates decrease of reactive chemicals in film
    emulsion during exposure. The areas that have received more
    light react less than other areas. Useful for high contrast
    scenes as it brings up the dark areas and limit bright areas.
  </p><a xmlns="" class="indexterm" name="id2520076"></a><a xmlns="" class="indexterm" name="id2520086"></a><p xmlns="">
    There are two new keywords in the <tt xmlns="" class="function">global_settings</tt> block:
    </p><pre xmlns="" class="synopsis"><tt class="function">exposure</tt> <i class="parameter"><tt>FLOAT</tt></i>
<tt class="function">exposure_gain</tt> <i class="parameter"><tt>FLOAT</tt></i></pre><p xmlns="">
    where <tt xmlns="" class="function">exposure_gain</tt> is optional and has default value 1.
    Both parameters have to be greater than 0 to influence rendering.
  </p><p xmlns="">
    <tt class="function">exposure</tt> can be thought as film speed, aperture and exposure time
    multiplied together. The value is not absolute. If the light source
    intensities in the scene are multiplied by 10 and exposure value is
    divided by 10 the resulting image will be the same.
  </p><p xmlns="">
    <tt class="function">exposure_gain</tt> can be used to brighten scenes with low maximum
    intensity when also low exposure value is used.
  </p><p xmlns="">
    The equation for such behavior of color used in MegaPOV is:
  </p><p xmlns="">
    <span class="emphasis"><em>color = exposure_gain * (1 - exp( - exposure * color ))</em></span>.
  </p><div xmlns="" class="table"><a name="id2520929"></a><p class="title"><b>Table 2.3. Exposure influence comparison</b></p><table summary="Exposure influence comparison" border="0" style="border-collapse: collapse;"><colgroup><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/expo1.png"></div></td><td style="" align="center"><div><img src="img/expo2.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>no exposure used</em></span></td><td style="" align="center"><tt class="function">exposure</tt><i class="parameter"><tt>1.6</tt></i></td></tr></tbody></table></div><div xmlns="" class="example"><a name="id2521004"></a><p class="title"><b>Example 2.11. Various values for film exposure simulations</b></p><p xmlns="">
      Examples which map range 0-1 to range 0-1 with increasing amount
      of compression:
      </p><pre class="programlisting"><tt class="function">exposure</tt> 0.05 <tt class="function">exposure_gain</tt> 20   // almost linear
<tt class="function">exposure</tt> 0.2  <tt class="function">exposure_gain</tt> 5.5
<tt class="function">exposure</tt> 0.5  <tt class="function">exposure_gain</tt> 2.5
<tt class="function">exposure</tt> 1    <tt class="function">exposure_gain</tt> 1.6
<tt class="function">exposure</tt> 10   <tt class="function">exposure_gain</tt> 1
<tt class="function">exposure</tt> 100  <tt class="function">exposure_gain</tt> 1    // high compression</pre><p xmlns="">
    </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="tone_mapping"></a>2.7.2. Custom tone mapping function</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2519845"></a><p xmlns="">
    Traditionally the color values <span class="trademark">POV-Ray</span>&#8482; calculates for the image pixels were clipped
    right at the beginning, before calculating the antialiasing.  Further color processing was not
    done (except gamma correction).  In <span class="trademark">POV-Ray</span>&#8482; 3.6.1 clipping was moved to be applied after
    antialiasing which also made it unnecessary to turn it off explicitly for high dynamic range image
    output.  But in a lot of cases this is not the optimal solution for high quality antialiasing.
  </p><p xmlns="">
    This patch offers a way to specify a custom tone mapping function for both before and after 
    antialiasing.  This way you can for example apply the pre-aa clipping known from <span class="trademark">POV-Ray</span>&#8482; 3.5
    or an exponential exposure curve like in the film exposure simulation patch (see <a href="#film_exposure" title="2.7.1. Film exposure simulation">Section 2.7.1, &#8220;Film exposure simulation&#8221;</a>).
  </p><p xmlns="">
    By also allowing to specify a mapping function after antialiasing you can also invert the
    mapping used and get back the linear color values.  The antialiasing in this case is aimed
    at the used mapping function and when a similar function is applied in an imaging program
    afterwards the antialiasing will look good.  The patch also offers automatic numerical inversion
    of the mapping function.
  </p><p xmlns="">The syntax is:
    </p><pre xmlns="" class="synopsis"><tt class="function">global_settings</tt> {
  <tt class="function">tone_mapping</tt> {
    <tt class="function">function</tt> { <i class="parameter"><tt>FUNCTION_ITEMS</tt></i> }
    [<tt class="function">inverse</tt> <i class="parameter"><tt>INTEGER</tt></i> | <tt class="function">function</tt> { <i class="parameter"><tt>FUNCTION_ITEMS</tt></i> }]
  }
}</pre><p xmlns="">
  </p><p xmlns="">
    The functions are user defined float functions with at least one parameter.  The
    original color value is passed as the first parameter and the return value specifies
    the resulting color.  Using
    </p><pre xmlns="" class="programlisting"><tt class="function">function</tt> { min(1, x) }</pre><p xmlns="">
    will for example result is a simple clipping.
  </p><p xmlns="">
    Specifying an integer value instead of a user defined function after <tt class="function">inverse</tt>
    makes MegaPOV numerically invert the function with the number of sample points specified.
    For non-invertible functions this might lead to unexpected results.
  </p><div xmlns="" class="example"><a name="id2520810"></a><p class="title"><b>Example 2.12. Exponential tone mapping</b></p><p xmlns="">
      The following code applies an exponential exposure curve like
      the film exposure simulation patch:

      </p><pre class="programlisting">#declare Exposure=1.6;
#declare Exposure_Gain=1.0;

global_settings {
  ...
  tone_mapping {
    function { Exposure_Gain - exp( -Exposure * x ) * Exposure_Gain }
  }
}</pre><p xmlns="">

    </p></div><p xmlns="">
    The include file <tt class="function">tone_mapping.inc</tt> coming with MegaPOV offers several
    macros with useful tone mapping functions (see (see <a href="#tone_mapping.inc" title="3.6. The 'tone_mapping.inc' include file">Section 3.6, &#8220;The 'tone_mapping.inc' include file&#8221;</a>));
  </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="radiosity"></a>2.7.3. Radiosity</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_cache"></a>2.7.3.1. Cache file</h4></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2519683"></a><p xmlns="">
      In <span class="trademark">POV-Ray</span>&#8482; 3.5 and earlier temporary files with cache of radiosity were named the same for every frame
      in the animation rendering. Since MegaPOV 1.0 the name of this file is concatenated from the name of the
      currently rendered image. Together with <tt class="function">Frame_Step</tt> (see <a href="#frame_step" title="2.1.1. Frame_Step">Section 2.1.1, &#8220;Frame_Step&#8221;</a>) and this addition it is finally possible to start
      two parallel processes with radiosity rendering over one source.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_samples"></a>2.7.3.2. Custom radiosity sampling directions</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2519785"></a><a xmlns="" class="indexterm" name="id2519796"></a><p xmlns="">
      The radiosity function in <span class="trademark">POV-Ray</span>&#8482; 3.5 uses an internal table of directions for the
      rays that are traced from a sampling point to determine the irradiance at that point.
      This patch allows to select alternative sets of sample ray directions.  This can help
      both to overcome the limit for maximum <tt class="function">count</tt> of 1600 as well as
      improve the quality of results at lower count values.
    </p><p xmlns="">
      The syntax description of this feature is:
      </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>RADIOSITY_ITEMS</tt></i>:
    ...
    [ samples <i class="parameter"><tt>SAMPLES_ITEMS</tt></i> ]

<i class="parameter"><tt>SAMPLES_ITEMS</tt></i>:
    <i class="parameter"><tt>INT_SAMPLES_TYPE</tt></i> |
    {
      <i class="parameter"><tt>SAMPLES_COUNT</tt></i>,
      <i class="parameter"><tt>VECTOR_DIRECTION</tt></i>, ...
      [weight <i class="parameter"><tt>INT_WEIGHT_TYPE</tt></i>]
    }</pre><p xmlns="">
    </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="radiosity_samples_internal"></a>2.7.3.2.1. internally generated directions</h5></div></div><div></div></div><p xmlns="">
        MegaPOV contains an internal generator for sample direction using the halton sequence
        written by <span xmlns="" class="author"><span class="surname">Mael</span></span>. It is activated by adding:

        </p><pre xmlns="" class="programlisting">samples 1</pre><p xmlns="">

        to the <tt xmlns="" class="function">radiosity{}</tt> block. The default value (0) uses the old
        internal direction table.
      </p><div xmlns="" class="table"><a name="id2521418"></a><p class="title"><b>Table 2.4. internal sequence</b></p><table summary="internal sequence" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/rad_internal_50a.png"></div></td><td style="" align="center"><div><img src="img/rad_internal_300a.png"></div></td><td style="" align="center"><div><img src="img/rad_internal_1600a.png"></div></td></tr><tr><td style="" align="center"><div><img src="img/rad_internal_50b.png"></div></td><td style="" align="center"><div><img src="img/rad_internal_300b.png"></div></td><td style="" align="center"><div><img src="img/rad_internal_1600b.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>50 rays</em></span></td><td style="" align="center"><span class="emphasis"><em>300 rays</em></span></td><td style="" align="center"><span class="emphasis"><em>1600 rays</em></span></td></tr></tbody></table></div><div xmlns="" class="table"><a name="id2521534"></a><p class="title"><b>Table 2.5. halton sequence</b></p><table summary="halton sequence" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/rad_halton_50a.png"></div></td><td style="" align="center"><div><img src="img/rad_halton_300a.png"></div></td><td style="" align="center"><div><img src="img/rad_halton_1600a.png"></div></td></tr><tr><td style="" align="center"><div><img src="img/rad_halton_50b.png"></div></td><td style="" align="center"><div><img src="img/rad_halton_300b.png"></div></td><td style="" align="center"><div><img src="img/rad_halton_1600b.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>50 rays</em></span></td><td style="" align="center"><span class="emphasis"><em>300 rays</em></span></td><td style="" align="center"><span class="emphasis"><em>1600 rays</em></span></td></tr></tbody></table></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="radiosity_samples_user"></a>2.7.3.2.2. user defined directions</h5></div></div><div></div></div><div xmlns="" class="informalfigure"><div align="right"><img src="img/rad_sampling.png" align="right"></div></div><p xmlns="">
        The sample ray directions can also be defined directly in the scene file:

        </p><pre xmlns="" class="programlisting">samples {
  300, // number of directions given
  &lt;0.78080, -0.36618, 0.50622&gt;,
  &lt;-0.26409, -0.01064, 0.96444&gt;,
  ...
}</pre><p xmlns="">

        A number of sample direction sets is coming with MegaPOV as include files.
      </p><p xmlns="">
        The coordinate system for these sample ray directions is relative to the
        surface at the sample position.  The z-Axis points in normal direction.
        All directions should be in the upper hemisphere (z coordinate &gt;0).
      </p><p xmlns="">
        An optional <tt class="function">weight</tt> parameter allows to weight the sample
        intensity with <tt class="function">cos(theta)</tt> where <tt class="function">theta</tt>
        is the angle between the normal vector and the ray direction.  The sample ray
        directions should have a density distribution according to this function.  If
        a uniform distribution is used instead <tt class="function">weight 1</tt> would weight
        the sample rays to compensate this.  The default is 0 which turns off special
        weighting.
      </p></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_randomize"></a>2.7.3.3. Randomized radiosity sampling directions</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Michael</span> <span class="surname">Andrews</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2522511"></a><a xmlns="" class="indexterm" name="id2522531"></a><p xmlns="">
      This patch is based on an idea by <span class="author"><span class="firstname">Michael</span> <span class="surname">Andrews</span></span>.  Normally the distribution of
      radiosity rays is identical for all sample points.  This patch rotates the sample
      set around the vertical axis by a random angle for each sample taken.  This can
      help to reduce artefacts in some cases.
    </p><p xmlns="">
      This patch is activated the following way:
      </p><pre xmlns="" class="programlisting">radiosity {
  ...
  randomize on
}</pre><p xmlns="">
    </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        Since this feature uses a random number for the sample direction rotation
        it is not safe to use it in animations.  Also a partial render of a scene will
        produce different results than rendering the whole scene.
      </p></td></tr></table></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_error_bound_adaptive"></a>2.7.3.4. Adaptive radiosity error_bound</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2522610"></a><a xmlns="" class="indexterm" name="id2522621"></a><a xmlns="" class="indexterm" name="id2522632"></a><p xmlns="">
      The <span class="trademark">POV-Ray</span>&#8482; radiosity feature uses the <tt class="function">error_bound</tt> parameter
      to decide when to reuse radiosity samples already in the cache and when to take a 
      new sample because there are not enough samples nearby.  Setting a low error_bound
      makes <span class="trademark">POV-Ray</span>&#8482; take a new sample very often and therefore leads to more accurate
      calculation of the diffuse illumination but at the same time is prone to artefacts
      when used with a low number of sample rays (<tt class="function">count</tt>).
    </p><p xmlns="">
      Especially with geometries containing sharp edges the sample density can become
      very high because <span class="trademark">POV-Ray</span>&#8482; recognizes the lighting changes very rapidly there.  In such
      cases it will not be possible to take all required samples during pretrace which is 
      unfortunate because it leads to slow renders, increasing memory requirements during 
      the render and makes splitting the render into multiple tasks more difficult.
      <span class="trademark">POV-Ray</span>&#8482; already offers the <tt class="function">always_sample</tt> option that reduces
      the necessity of additional samples in the final render pass by setting
      nearest_count to 1 on the final pass so only one sample is required per radiosity
      evaluation but this only reduces the problem a bit and is prone to artefacts.
    </p><p xmlns="">
      The adaptive <tt class="function">error_bound</tt> allows you to set a range the
      <tt class="function">error_bound</tt> value is automatically chosen from as well as
      an overestimation factor used to find the optimal <tt class="function">error_bound</tt> 
      value.  This means the radius from which cached radiosity samples are used
      is increased if not enough samples are found in the area defined by the original
      <tt class="function">error_bound</tt>.  In a way this is similar to the adaptive search 
      radius used in photon mapping.
    </p><p xmlns="">
      This patch is activated by using the following syntax instead of the standard 
      <tt xmlns="" class="function">error_bound</tt> parameter:

      </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>RADIOSITY_ITEMS</tt></i>:
    ...
    [ error_bound <i class="parameter"><tt>ERROR_BOUND_DEFINITION</tt></i> ]

<i class="parameter"><tt>ERROR_BOUND_DEFINITION</tt></i>:
    <i class="parameter"><tt>FLOAT_ERROR_BOUND</tt></i> |
    {
      <i class="parameter"><tt>FLOAT_ERROR_BOUND</tt></i>
      [adaptive <i class="parameter"><tt>FLOAT_EB_OVERESTIMATION</tt></i> [, FLOAT_ERROR_BOUND_MAX] ]
    }</pre><p xmlns="">
    </p><p xmlns="">
      The default values are:
    </p><p xmlns="">
      <tt class="function">FLOAT_EB_OVERESTIMATION</tt> : <tt class="literal">1.5</tt>
    </p><p xmlns="">
      <tt class="function">FLOAT_ERROR_BOUND_MAX</tt> : <tt class="literal">10.0</tt>
    </p><p xmlns="">
      The following code for example might be used for an adaptive <tt xmlns="" class="function">error_bound</tt>:
      </p><pre xmlns="" class="programlisting">radiosity {
  ...
  error_bound { 0.3 adaptive 2.0, 20 }
}</pre><p xmlns="">
    </p><p xmlns="">
      Note it can be necessary to use fairly large maximum values to avoid
      final pass radiosity samples to be necessary.  The overestimation factor
      increases the render time when chosen too small and will result in 
      unnecessarily large errors when very large.  Values between 1.5 and 2 are
      usually a good choice.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_additional_statistics"></a>2.7.3.5. Additional radiosity statistics</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2522905"></a><a xmlns="" class="indexterm" name="id2522916"></a><p xmlns="">
      The patch introduces some additional statistics showing the number of samples
      taken in pretrace and final pass and separately for the different recursion levels.
      This can be useful for optimizing the radiosity settings.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_adaptive_pretrace"></a>2.7.3.6. Adaptive radiosity pretrace</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2522958"></a><a xmlns="" class="indexterm" name="id2522969"></a><a xmlns="" class="indexterm" name="id2522981"></a><p xmlns="">
      The purpose of the radiosity pretrace is to take care of an optimal distribution
      of radiosity samples in the scene.  For achieving this the view area is sampled
      with increasing density until <tt class="function">pretrace_end</tt>.  During pretrace
      pass the <tt class="function">error_bound</tt> is also reduced with <tt class="function">low_error_factor</tt>.
      The results are usually quite good but this is unnecessarily slow in a lot of scenes where different
      areas require a very different sample density.  Also the standard pretrace
      only samples down to a 2 pixel density which is not sufficient in many cases.
    </p><p xmlns="">
      Because of these limitation practical use of radiosity usually does not take all 
      radiosity samples during the pretrace.  Sometimes it is even more efficient to totally
      avoid the pretrace.   
    </p><p xmlns="">
      This patch introduces a new pretrace mode which no more samples the whole view with the 
      same density but adapts the sampling to the scene's requirements.  To accomplish this the
      pretrace no more traces the different subdivision levels one after the other but
      subdivides the view in a recursive way.   
    </p><p xmlns="">
      In addition the new pretrace can also subdivide to a sub-pixel density (by using 
      <tt class="function">pretrace_end</tt> smaller than <tt class="function">1/image_width</tt>).
      This can of course be quite slow depending on the scene, render- and radiosity-settings.
    </p><p xmlns="">
      The new pretrace is activated the following way:
      </p><pre xmlns="" class="programlisting">radiosity {
  ...
  adaptive 1
}</pre><p xmlns="">
    </p><p xmlns="">
      The following values can be used for the radiosity parameter:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
            <tt class="literal">0</tt> old pretrace, default.
          </li><li>
            <tt class="literal">1</tt> new pretrace, subdivide until no new sample has to be taken.
          </li><li>
            <tt class="literal">2</tt> new pretrace, one additional subdivision level
            in addition to <tt class="literal">1</tt>.
          </li></ul></div><p xmlns="">
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="radiosity_visualize"></a>2.7.3.7. Radiosity visualizations</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><a xmlns="" class="indexterm" name="id2523162"></a><a xmlns="" class="indexterm" name="id2523173"></a><a xmlns="" class="indexterm" name="id2523184"></a><p xmlns="">
      The <span class="trademark">POV-Ray</span>&#8482; radiosity code contains code to visualize the way radiosity works internally in the rendered
      images.  This code is deactivated by default.  This patch offers access to these features from SDL
      with some new parameters in the radiosity block.
    </p><p xmlns="">
      The syntax of these parameters is the following:

      </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>RADIOSITY_ITEMS</tt></i>:
    ...
    [ show_samples <i class="parameter"><tt>FLOAT_RADIUS</tt></i>, <i class="parameter"><tt>COLOR</tt></i> ]
    [ show_low_count <i class="parameter"><tt>COLOR_LOW_COUNT</tt></i>, <i class="parameter"><tt>COLOR_GATHER_FINAL</tt></i> ]</pre><p xmlns="">
    </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="radiosity_visualize_samples"></a>2.7.3.7.1. sample locations</h5></div></div><div></div></div><p xmlns="">
        The <tt class="function">show_samples</tt> parameter activates the marking of the radiosity sample locations with 
        the specified color.  Note this color only sets the ambient value returned by the radiosity function.
        The other finish components are added to this.  Therefore it might be necessary to use quite extreme color values for this.  
        The radius parameter influences how large the sample spots are marked.
      </p><p xmlns="">
        </p><div xmlns="" class="informalfigure"><div><img src="img/rad_viz_sampling.png"></div></div><p xmlns="">
      </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="radiosity_visualize_low_count"></a>2.7.3.7.2. low sample count areas</h5></div></div><div></div></div><p xmlns="">
        The <tt class="function">show_low_count</tt> activates the marking of areas where the sample density
        is too low so less than <tt class="function">nearest_count</tt> samples are available for the radiosity 
        estimation.  The color of these areas is chosen with the first parameter.  
        This is only visible when <tt class="function">always_sample</tt> is <tt class="literal">off</tt>, otherwise
        additional samples are taken in the final pass and the area is colored with the second color specified.
      </p><p xmlns="">
        </p><div xmlns="" class="informalfigure"><div><img src="img/rad_viz_low_count.png"></div></div><p xmlns="">
      </p></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim"></a>2.7.4. Mechanics simulation patch</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
    The mechanics simulation system is integrated into the <span class="trademark">POV-Ray</span>&#8482;
    rendering system.  The simulation parameters are set in the
    <tt class="function">global_settings{}</tt> block of the scene file.  While
    parsing the scene MegaPOV calculates the simulation exactly
    where it occurs in the file.  This way the simulation can
    interact with the scene by using objects, functions and values
    set before the <tt class="function">mechsim{}</tt> block in the scene file.
    But additionally the simulation data can also be used in the
    scene later on for placing objects according to the
    simulation results.
  </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_settings"></a>2.7.4.1. The simulation settings</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2524891"></a><p xmlns="">
      This patch introduces a new block in the
      <tt class="function">global_settings{}</tt> section of the <span class="trademark">POV-Ray</span>&#8482; scene file.
    </p><p xmlns="">
      The complete syntax description of this block is:
      </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>MECHSIM</tt></i>:
    mechsim { [<i class="parameter"><tt>MECHSIM_ITEMS...</tt></i>] }
<i class="parameter"><tt>MECHSIM_ITEM</tt></i>:
    method <i class="parameter"><tt>INTEGER</tt></i> | bounding <i class="parameter"><tt>INTEGER</tt></i> | 
    gravity <i class="parameter"><tt>VECTOR</tt></i> | time_step <i class="parameter"><tt>FLOAT</tt></i> |
    step_count <i class="parameter"><tt>INTEGER</tt></i> | time <i class="parameter"><tt>FLOAT</tt></i> | 
    start_time <i class="parameter"><tt>FLOAT</tt></i> | end_time <i class="parameter"><tt>FLOAT</tt></i> | 
    accuracy <i class="parameter"><tt>FLOAT</tt></i>[, <i class="parameter"><tt>FLOAT</tt></i>] |
    environment { <i class="parameter"><tt>ENVIRONMENT_DEFINITION</tt></i> [<i class="parameter"><tt>ENVIRONMENT_ITEMS...</tt></i>] } |
    interaction { <i class="parameter"><tt>INTERACTION_DEFINITION ...</tt></i> } |
    field { <i class="parameter"><tt>FIELD_DEFINITION ...</tt></i> } |
    force { <i class="parameter"><tt>FORCE_DEFINITION ...</tt></i> } |
    attach [<i class="parameter"><tt>VECTOR</tt></i>] { <i class="parameter"><tt>ATTACH_DEFINITION ...</tt></i> } |
    fixed <i class="parameter"><tt>VECTOR</tt></i> |
    collision { <i class="parameter"><tt>COLLISION_TOGGLE</tt></i> [<i class="parameter"><tt>COLLISION_ITEMS...</tt></i>] } |
    topology { [<i class="parameter"><tt>GROUP_DEFINITIONS...</tt></i>] [<i class="parameter"><tt>TOPOLOGY_ITEMS...</tt></i>]
               [save_file <i class="parameter"><tt>FILE_NAME</tt></i> [<i class="parameter"><tt>Type</tt></i>]] }
<i class="parameter"><tt>ENVIRONMENT_DEFINITION</tt></i>:
    function [(<i class="parameter"><tt>IDENT_LIST</tt></i>)] { <i class="parameter"><tt>FUNCTION_ITEMS</tt></i> } | object <i class="parameter"><tt>OBJECT</tt></i>
<i class="parameter"><tt>ENVIRONMENT_ITEM</tt></i>:
    stiffness FLOAT | damping <i class="parameter"><tt>FLOAT</tt></i> | friction <i class="parameter"><tt>FLOAT</tt></i> [<i class="parameter"><tt>, FLOAT</tt></i>] |
    method <i class="parameter"><tt>INTEGER</tt></i>
<i class="parameter"><tt>INTERACTION_DEFINITION</tt></i>:
    function [(<i class="parameter"><tt>IDENT_LIST</tt></i>)] { <i class="parameter"><tt>FUNCTION_ITEMS</tt></i> }
<i class="parameter"><tt>FIELD_DEFINITION</tt></i>:
    function { <i class="parameter"><tt>SPECIAL_COLOR_FUNCTION</tt></i> }
<i class="parameter"><tt>FORCE_DEFINITION</tt></i>:
    function { <i class="parameter"><tt>SPECIAL_COLOR_FUNCTION</tt></i> }
<i class="parameter"><tt>ATTACH_DEFINITION</tt></i>:
    function { <i class="parameter"><tt>SPLINE</tt></i> }
<i class="parameter"><tt>COLLISION_TOGGLE</tt></i>:
    [<i class="parameter"><tt>INT_MASS_MASS</tt></i> [, <i class="parameter"><tt>INT_MASS_FACE</tt></i> [, <i class="parameter"><tt>INT_CONNECTION_CONNECTION</tt></i>]]]
<i class="parameter"><tt>COLLISION_ITEM</tt></i>:
    stiffness <i class="parameter"><tt>FLOAT</tt></i> | damping <i class="parameter"><tt>FLOAT</tt></i> | friction <i class="parameter"><tt>FLOAT</tt></i> [, <i class="parameter"><tt>FLOAT</tt></i>]
<i class="parameter"><tt>GROUP_DEFINITION</tt></i>:
    group [(<i class="parameter"><tt>INT_GROUP_INDEX</tt></i>)] { <i class="parameter"><tt>TOPOLOGY_ITEMS...</tt></i> }
<i class="parameter"><tt>TOPOLOGY_ITEM</tt></i>:
    mass { <i class="parameter"><tt>V_POSITION</tt></i>, <i class="parameter"><tt>V_VELOCITY</tt></i>, <i class="parameter"><tt>F_RADIUS</tt></i>
           mass <i class="parameter"><tt>FLOAT</tt></i> | density <i class="parameter"><tt>FLOAT</tt></i> 
           [attach <i class="parameter"><tt>INTEGER</tt></i>] [force <i class="parameter"><tt>INTEGER</tt></i>] [fixed <i class="parameter"><tt>BOOL</tt></i>] } |
    connection { <i class="parameter"><tt>INDEX1</tt></i>, <i class="parameter"><tt>INDEX2</tt></i> [stiffness <i class="parameter"><tt>FLOAT</tt></i>] [damping <i class="parameter"><tt>FLOAT</tt></i>]
                 [length <i class="parameter"><tt>FLOAT</tt></i>] } |
    viscoelastic { <i class="parameter"><tt>INDEX1</tt></i>, <i class="parameter"><tt>INDEX2</tt></i> [stiffness <i class="parameter"><tt>FLOAT</tt></i>] [length <i class="parameter"><tt>FLOAT</tt></i>]
                 [accuracy <i class="parameter"><tt>FLOAT</tt></i>] [ VE_ELEMENTS...  ] } |
    face { <i class="parameter"><tt>INDEX1</tt></i>, <i class="parameter"><tt>INDEX2</tt></i>, <i class="parameter"><tt>INDEX3</tt></i> } |
    load_file <i class="parameter"><tt>FILE_NAME</tt></i>
<i class="parameter"><tt>VE_ELEMENT</tt></i>:
    element { <i class="parameter"><tt>F_STIFFNESS</tt></i>, <i class="parameter"><tt>F_DAMPING</tt></i> [, <i class="parameter"><tt>F_POSITION</tt></i> ] ] }</pre><p xmlns="">
    </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_gen_settings"></a>2.7.4.1.1. The general settings</h5></div></div><div></div></div><p xmlns="">
        Some general parameters can be given in the top level of the
        <tt class="function">mechsim{}</tt> section.
      </p><p xmlns="">
        The default values are:
      </p><p xmlns="">
        <tt class="function">method</tt> : <tt class="literal">1</tt>
      </p><p xmlns="">
        <tt class="function">bounding</tt> : <tt class="literal">0</tt>
      </p><p xmlns="">
        <tt class="function">gravity</tt>  : <tt class="literal">&lt;0, 0, 0&gt;</tt>
      </p><p xmlns="">
        <tt class="function">time_step</tt> : <tt class="literal">0.1</tt>
      </p><p xmlns="">
        <tt class="function">step_count</tt> : <tt class="literal">10</tt>
      </p><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_method"></a>2.7.4.1.1.1. method</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2525618"></a><p xmlns="">
          Selects the integration method used for solving the
          equations of movement.
        </p><p xmlns="">
          Possible values are:
          </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="literal">1</tt> (<tt class="constant">MECHSIM_METHOD_EULER</tt>) simple forward Euler integration method</li><li><tt class="literal">2</tt> (<tt class="constant">MECHSIM_METHOD_HEUN</tt>) second order (Heun) integration method</li><li><tt class="literal">3</tt> (<tt class="constant">MECHSIM_METHOD_RUNGE_KUTTA</tt>) fourth order Runge Kutta integration method</li><li><tt class="literal">4</tt> (<tt class="constant">MECHSIM_METHOD_GRADIENT</tt>) gradient descent method</li></ul></div><p xmlns="">
        </p><p xmlns="">
          Method 1 is a first order integration method also known as explicit Euler method.
          With the differential equations of movement written as:
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula001.png" align="left"></td></tr></table></div></div><p xmlns="">
          <i class="parameter"><tt>y</tt></i> being the state of the system (positions and velocities)
          and the initial conditions
          <tt class="function">y(t<sub>0</sub>)=y<sub>0</sub></tt>
          the Euler method can be written as:
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula002.png" align="left"></td></tr></table></div></div><p xmlns="">
          Method 2 is a second order integration method known as Heun's method.
          Its formula is:
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula003.png" align="left"></td></tr></table></div></div><p xmlns="">
          Method 3 is a fourth order integration method known as the classical
          Runge-Kutta method, in contrast to method 1 and 2 it automatically controls the time steps (see <a href="#mechsim_step_adaptive" title="2.7.4.1.1.6. adaptive time stepping">Section 2.7.4.1.1.6, &#8220;adaptive time stepping&#8221;</a>):
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula004.png" align="left"></td></tr></table></div></div></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_bounding"></a>2.7.4.1.1.2. bounding</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2525997"></a><p xmlns="">
          Selects the bounding method to speed up collision detections between masses, connections and faces.
        </p><p xmlns="">
          Possible values are:
          </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="literal">0</tt> (<tt class="constant">MECHSIM_COLLISION_BOUNDING_NO</tt>) no bounding system</li><li><tt class="literal">1</tt> (<tt class="constant">MECHSIM_COLLISION_BOUNDING_AUTO</tt>) automatically select method 0, 2 or 3 depending on complexity</li><li><tt class="literal">2</tt> (<tt class="constant">MECHSIM_COLLISION_BOUNDING_BOX</tt>) speed up using bounding boxes</li><li><tt class="literal">3</tt> (<tt class="constant">MECHSIM_COLLISION_BOUNDING_HASH</tt>) speed up using spatial hashing</li></ul></div><p xmlns="">
        </p><p xmlns="">
          The bounding techniques have been implemented by <span class="author"><span class="firstname">Daniel</span> <span class="surname">Jungmann</span></span>.
        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_gravity"></a>2.7.4.1.1.3. gravity</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526112"></a><p xmlns="">Applies an overall constant gravitational force to all masses.</p><p xmlns="">A vector is expected, the unit is <tt class="function">m/s²</tt>.</p><p xmlns="">
          Standard earth gravity (with y=up coordinates) is:

          </p><pre xmlns="" class="programlisting">gravity &lt;0, -9.81, 0&gt;</pre><p xmlns="">
        </p><p xmlns="">
          With field functions (see <a href="#mechsim_field" title="2.7.4.1.6. Field forces">Section 2.7.4.1.6, &#8220;Field forces&#8221;</a>) non constant
          gravity can be simulated
        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_fixed"></a>2.7.4.1.1.4. global fixation</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526177"></a><p xmlns="">
          All movements in the simulation system can be fixed in one or two directions
          using the <tt class="function">fixed</tt> option.
        </p><p xmlns="">
          This can be used to make the MechSim system perform simulation of 2D and 1D systems.
          Note however that the simulation still runs in 3D internally.
        </p><p xmlns="">
          by adding:

          </p><pre xmlns="" class="programlisting">fixed &lt;0, 0, 1&gt;</pre><p xmlns="">

          to the <tt xmlns="" class="function">mechsim{}</tt> block you can for example perform a simulation
          in the x-y-plane.
        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_stepping"></a>2.7.4.1.1.5. simulation stepping</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526243"></a><a xmlns="" class="indexterm" name="id2526254"></a><a xmlns="" class="indexterm" name="id2526266"></a><p xmlns="">
          All simulation methods use discrete time steps for calculating
          the simulation.  There are three parameters to steer this but only
          two are needed to correctly define the stepping.  The formula for
          calculating the third is:
        </p><p xmlns="">
          <tt class="function">Step_Count = Time / Time_Step</tt>
        </p><p xmlns="">
          <a class="indexterm" name="id2526299"></a>
          <a class="indexterm" name="id2526310"></a>

          An optional <tt class="function">start_time</tt> value allows to specify a
          starting time different from <tt class="literal">0</tt>.  Changing this can
          influence the <tt class="function">attach</tt> and
          <tt class="function">environment</tt> function.
          (see <a href="#mechsim_attach" title="2.7.4.1.7. Attaching masses">Section 2.7.4.1.7, &#8220;Attaching masses&#8221;</a> and <a href="#mechsim_environment" title="2.7.4.1.2. The environments">Section 2.7.4.1.2, &#8220;The environments&#8221;</a>)
          Specifying an <tt class="function">end_time</tt> value instead of
          <tt class="function">time</tt> is also possible.
        </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Using too large time steps can lead to instability in the simulation.
            MegaPOV will recognize this in most cases and stop simulation with an
            error message but this does not mean the simulation is correct as long
            as no error is reported.  Simulation results should always be checked
            for plausibility.
          </p></td></tr></table></div></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_step_adaptive"></a>2.7.4.1.1.6. adaptive time stepping</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526407"></a><p xmlns="">
          Simulation method 3 automatically controls the used time steps.  This is done by calculating every step
          with double steps size and comparing the results.  So the local discretization error is automatically
          kept below a specified threshold.  You can specify this threshold and the minimum allowed step size
          with the <tt xmlns="" class="function">accuracy</tt> keyword:

          </p><pre xmlns="" class="programlisting">accuracy THRESHOLD, MIN_STEP</pre><p xmlns="">
        </p><p xmlns="">
          the minimum step size is optional, default values are:
        </p><p xmlns="">
          <tt class="function">THRESHOLD</tt> : <tt class="literal">1.0e-5</tt>
        </p><p xmlns="">
          <tt class="function">MIN_STEP</tt> : <tt class="literal">1.0e-7</tt>
        </p><p xmlns="">
          The step size to start with can be specified with <tt class="function">time_step</tt>.  It is usually
          not critical but can be necessary to be set sufficiently low for a successful simulation.
        </p><p xmlns="">
          The render statistics show the actual minimum, average and maximum time steps used during the 
          simulation.
        </p><div xmlns="" class="example"><a name="id2526500"></a><p class="title"><b>Example 2.13. Adaptive time stepping</b></p><p xmlns="">
            A simulation setup for adaptive time stepping could look like:

            </p><pre class="programlisting">mechsim {
  ...
  method 3
  time 1/30
  accuracy 1e-5, 1e-6
  ...
}</pre><p xmlns="">

          </p></div><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Adaptive time stepping guarantees a certain local accuracy of the simulation, it does not prevent
            instability though.  It will not be possible to simulate a system that does not run with fixed
            time steps.
          </p></td></tr></table></div></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_environment"></a>2.7.4.1.2. The environments</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526548"></a><p xmlns="">
        Environments are shapes the simulated masses are supposed to interact
        with. Several of them can be created with
        <tt class="function">environment{}</tt> blocks.
      </p><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_env_definition"></a>2.7.4.1.2.1. The environment definition</h6></div></div><div></div></div><p xmlns="">
          An environment is defined either by a user defined function or an object.
          If both are given the function is preferred.
        </p><p xmlns="">
          Apart from the default parameters
          (<tt class="function">x</tt>, <tt class="function">y</tt> and <tt class="function">z</tt>)
          the function can have a fourth parameter supplying a time index.  This way
          moving environment objects can be simulated.
        </p><p xmlns="">

          </p><pre xmlns="" class="programlisting">#declare fn_Env=function(x, y, z, tim) { z-tim }

global_settings {
  ...
  mechsim {
    ...
    environment {
      function(x, y, z, tim) { fn_Env(x, y, z, tim) }
      ...
    }
  }
}</pre><p xmlns="">

        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_env_properties"></a>2.7.4.1.2.2. The environment properties</h6></div></div><div></div></div><p xmlns="">
          There are three parameters defining the properties of the environment:
        </p><p xmlns="">
          </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
                <a class="indexterm" name="id2526660"></a>
                <tt class="function">stiffness</tt> The elasticity parameter of the surface.
                The unit is <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt>.
              </p></li><li><p>
                <a class="indexterm" name="id2526702"></a>
                <tt class="function">damping</tt> Depending on the environment calculation method
                (see below) this is either a diminishing factor (&lt;1) applied to the mass
                velocities at each collision or a damping constant (unit <tt class="function">kg/s</tt>)
              </p></li><li><p>
                <a class="indexterm" name="id2526739"></a>
                <tt class="function">friction</tt> The friction factor controls the amount of friction
                during collisions.  An optional second parameter, the friction
                excess value should usually be slightly larger than 1 and causes the friction
                to occur already slightly above the surface.  This can be helpful to obtain
                realistic results.
              </p></li></ul></div><p xmlns="">
        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_env_method"></a>2.7.4.1.2.3. The environment calculation method</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526781"></a><p xmlns="">
          There are currently two methods how the environment collisions can be
          calculated:
        </p><p xmlns="">
          </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
                <span class="emphasis"><em>Method 1</em></span> (<tt class="constant">MECHSIM_ENV_METHOD_FORCE</tt>)
                is force based.  When a mass collides with the environment a force is
                applied in direction of the function gradient (with function based environments)
                or the surface normal (with objects).  The <tt class="function">stiffness</tt>,
                <tt class="function">damping</tt> and <tt class="function">friction</tt> parameters
                influence this force. <tt class="function">friction</tt> defines the ratio between
                the tangential force and the normal force.
              </p><div class="figure"><a name="id2526851"></a><p class="title"><b>Figure 2.1. Force based environment collisions illustration</b></p><div><img src="img/env_force.png" alt="Force based environment collisions illustration"></div></div></li><li><p>
                <span class="emphasis"><em>Method 2</em></span> (<tt class="constant">MECHSIM_ENV_METHOD_IMPACT</tt>)
                is based on impact laws.  The velocity is inverted at the surface and
                diminished by the <tt class="function">damping</tt> factor in normal direction
                and by the <tt class="function">friction</tt> value in tangential direction.
                <tt class="function">stiffness</tt> does not have any influence in this case.
              </p><div class="figure"><a name="id2526910"></a><p class="title"><b>Figure 2.2. Impact based environment collisions illustration</b></p><div><img src="img/env_impact.png" alt="Impact based environment collisions illustration"></div></div><p>
                Since this method directly modifies the velocity rather than applying
                forces it should only be used with the first order (Euler) integration method.
              </p></li></ul></div><p xmlns="">
        </p><p xmlns="">
          With the gradient descent simulation method the method parameter does
          not have any effect.
        </p></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_collision"></a>2.7.4.1.3. The collision settings</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2526960"></a><p xmlns="">
        The collisions referred to here are not environment collisions but collisions
        between the simulation elements.  Since detecting this kind of collision is quite
        computationally intensive it is turned off by default.
      </p><p xmlns="">
        With three numbers at the beginning of the <tt class="function">collision{}</tt> section
        collision can be toggled for <span class="emphasis"><em>mass-mass-collisions</em></span>,
        <span class="emphasis"><em>mass-face-collisions</em></span>
        and <span class="emphasis"><em>connection-connection-collisions</em></span>.
        All these parameters are optional, the meaning of the possible values is:
      </p><p xmlns="">
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
              <tt class="literal">0</tt> (<tt class="constant">MECHSIM_COLLISION_NONE</tt>)
              No collisions of this kind are calculated.
            </li><li>
              <tt class="literal">1</tt> (<tt class="constant">MECHSIM_COLLISION_ALL</tt>)
              Collisions between all simulation elements are calculated.
            </li><li>
              <tt class="literal">2</tt> (<tt class="constant">MECHSIM_COLLISION_GROUP</tt>)
              Only collisions between elements of different groups are calculated.
            </li></ul></div><p xmlns="">
      </p><div xmlns="" class="figure"><a name="id2527077"></a><p class="title"><b>Figure 2.3. Mass-mass collisions illustration</b></p><div><img src="img/coll_mass.png" alt="Mass-mass collisions illustration"></div></div><div xmlns="" class="figure"><a name="id2527095"></a><p class="title"><b>Figure 2.4. Mass-face collisions illustration</b></p><div><img src="img/coll_face.png" alt="Mass-face collisions illustration"></div></div><div xmlns="" class="figure"><a name="id2527112"></a><p class="title"><b>Figure 2.5. Connection-connection collisions illustration</b></p><div><img src="img/coll_con.png" alt="Connection-connection collisions illustration"></div></div><p xmlns="">
        Internal collisions are always calculated with forces.  The same three
        parameters like in the environment settings can be used to specify the
        properties
      </p><p xmlns="">
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
              <a class="indexterm" name="id2527151"></a>
              <tt class="function">stiffness</tt> The elasticity parameter of the surface.
              The unit is <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt>.
            </li><li>
              <a class="indexterm" name="id2527191"></a>
              <tt class="function">damping</tt> A damping constant (unit <tt class="function">kg/s</tt>)
            </li><li>
              <a class="indexterm" name="id2527224"></a>
              <tt class="function">friction</tt> The friction factor controls the amount of friction
              during collisions.  An optional second parameter, the friction
              excess value should usually be slightly larger than 1 and causes the friction
              to occur already slightly before the collision.  This can be helpful to obtain
              realistic results.
            </li></ul></div><p xmlns="">
      </p><div xmlns="" class="example"><a name="id2527253"></a><p class="title"><b>Example 2.14. An example for a complete <tt class="function">collision{}</tt> section:</b></p><p xmlns="">
          </p><pre class="programlisting">global_settings {
  ...
  mechsim {
    ...
    collision {
      2, /* mass-mass collisions between elements of different groups */
      0, /* no mass-face collisions */
      0  /* no connection-connection collisions */
      stiffness 20000
      damping 4000
      friction 0.2, 1.01
    }
  }
}</pre><p xmlns="">
        </p></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_topology"></a>2.7.4.1.4. The topology</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2527296"></a><p xmlns="">
        The <tt class="function">topology{}</tt> section is the central part
        of the whole simulation settings.  Here the simulation elements,
        their positions and properties, can be defined.
      </p><p xmlns="">
        There are three topology items: masses, connections and faces.  Each of them
        has several parameters that can be set.
      </p><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_mass"></a>2.7.4.1.4.1. Point masses</h6></div></div><div></div></div><p xmlns="">
          <a class="indexterm" name="id2527340"></a>
          The <tt class="function">mass</tt> block defines a point mass.
          These are the central elements of the simulation.  Their
          movement is calculated by the simulation system.
        </p><div xmlns="" class="informalfigure"><div><img src="img/masses1.png"></div></div><p xmlns="">
          The <tt class="function">mass</tt> block contains the following elements:
        </p><p xmlns="">
          </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
                The first item is a vector specifying the position of them mass
                (unit: <tt class="function">m</tt>).
              </li><li>
                The second item, also a vector, represents the velocity of them mass
                (unit: <tt class="function">m/s</tt>).
              </li><li>
                The third item is a float standing for the radius of the mass
                (unit: <tt class="function">m</tt>).  This radius is only used in
                collision calculations (see <a href="#mechsim_collision" title="2.7.4.1.3. The collision settings">Section 2.7.4.1.3, &#8220;The collision settings&#8221;</a>).
                Otherwise the mass behaves as a point mass.
              </li></ul></div><p xmlns="">
        </p><p xmlns="">
          In addition either the <tt class="function">mass</tt> (unit: <tt class="function">kg</tt>) or the
          <tt class="function">density</tt> (unit: <tt class="function">kg/m³</tt>) of the element has to be given.
          If <tt class="function">density</tt> is specified the resulting mass is calculated
          automatically.  An optional boolean parameter (<tt class="function">fixed</tt>)
          prevents the mass from moving if set to <tt class="function">true</tt>.
        </p><p xmlns="">
          A complete example for a mass definition:

          </p><pre xmlns="" class="programlisting">mass {
  &lt;0, 0, 1&gt;, /* position */
  &lt;1, 0, 0&gt;, /* velocity */
  0.1        /* radius */
  density 600
  // mass 2
  // fixed true
}</pre><p xmlns="">

        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_connection"></a>2.7.4.1.4.2. Connections</h6></div></div><div></div></div><p xmlns="">
          <a class="indexterm" name="id2527544"></a>
          The <tt class="function">connection</tt> block defines a connection
          between two point masses.  It can have elastic and dissipative
          properties.
        </p><div xmlns="" class="informalfigure"><div><img src="img/connections1.png"></div></div><p xmlns="">
          The first two elements of this block are integer numbers specifying the
          indices of the masses to connect.
        </p><p xmlns="">
          Connections simulate a parallel elasticity and linear damping
          element - a so called <span class="emphasis"><em>Voigt-Kelvin-Element</em></span>.
        </p><div xmlns="" class="informalfigure"><div><img src="img/con_vk.png"></div></div><p xmlns="">
          The force they exhibit
          on the masses they connect is:
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula005.png" align="left"></td></tr></table></div></div><p xmlns="">
          There are three optional parameters: The <tt class="function">stiffness</tt> value specifies
          the elasticity of the connection (unit <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt>).
          <tt class="function">damping</tt> the velocity proportional damping factor (unit <tt class="function">kg/s</tt>).
          The default value for both of these is zero.  The third parameter allows to specify
          a relaxed length (<tt class="function">x<sub>0</sub></tt>) of the connection.  If it is not specified the distance of the two
          masses at the time the connection is created is used for this property.
        </p><p xmlns="">
          A complete example for a connection definition:

          </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      mass { ... }  /* mass with index 0 */
      mass { ... }  /* mass with index 1 */

      connection {
        0,          /* index of the first mass */
        1           /* index of the second mass */
        stiffness 10000
        damping 2000
        // length 0.5
      }
      ...
    }
  }
}</pre><p xmlns="">

        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_face"></a>2.7.4.1.4.3. Faces</h6></div></div><div></div></div><p xmlns="">
          <a class="indexterm" name="id2527758"></a>
          The <tt class="function">face</tt> block defines a triangular face between
          three point masses.  It is used for collision calculations
          (see <a href="#mechsim_collision" title="2.7.4.1.3. The collision settings">Section 2.7.4.1.3, &#8220;The collision settings&#8221;</a>) and can be useful for
          generating a mesh from the simulation data for display.
        </p><div xmlns="" class="informalfigure"><div><img src="img/faces1.png"></div></div><p xmlns="">
          There are three integer numbers in the block, the
          indices of the masses forming the face.
        </p><p xmlns="">
          A complete example for a face definition:

          </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      mass { ... }  /* mass with index 0 */
      mass { ... }  /* mass with index 1 */
      mass { ... }  /* mass with index 2 */

      face {
        0,          /* index of the first mass */
        1,          /* index of the second mass */
        2           /* index of the third mass */
      }
      ...
    }
  }
}</pre><p xmlns="">

        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_viscoelastic"></a>2.7.4.1.4.4. Viscoelastic connections</h6></div></div><div></div></div><p xmlns="">
          Viscoelastic connections allow you to simulate more complex material properties than 
          conventional connections.  Conventional connections simulate a parallel elasticity and linear damping
          element - a so called <span class="emphasis"><em>Voigt-Kelvin-Element</em></span> 
          (see <a href="#mechsim_topo_connection" title="2.7.4.1.4.2. Connections">Section 2.7.4.1.4.2, &#8220;Connections&#8221;</a>).  With this element the force
          of the connection only depends on the momentaneous distance and velocity of the masses.
          Viscoelastic connections use a more complex model that also allows you to simulate
          effects like relaxation.
        </p><p xmlns="">
          The element definition contains the index of the two masses it connects and a relaxed length - 
          just like conventional connections.  The <tt class="function">stiffness</tt> value specifies
          the static elasticity of the connection (unit <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt>).
          Furthermore you can specify an arbitrary number of parallel <span class="emphasis"><em>Maxwell-Elements</em></span>.
          Each contains two mandatory parameters: the stiffness (unit <tt class="function">N/m</tt> or 
         <tt class="function">kg/s²</tt>) and the damping (unit <tt class="function">kg/s</tt>)
        </p><div xmlns="" class="informalfigure"><div><img src="img/con_visc.png"></div></div><p xmlns="">
          The force viscoelastic connections exhibit on the masses they connect is:
        </p><div xmlns="" class="informalfigure"><div class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0"><tr><td align="left" valign="middle"><img src="img/formula006.png" align="left"></td></tr></table></div></div><p xmlns="">
          <tt class="function">y<sub>i</sub></tt> are the inner coordinates of the Maxwell-Elements
          that get calculated by the simulation system.
        </p><p xmlns="">
          A complete example for a connection definition:

          </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      mass { ... }       /* mass with index 0 */
      mass { ... }       /* mass with index 1 */

      viscoelastic {
        0,               /* index of the first mass */
        1                /* index of the second mass */
        stiffness 10000  /* static stiffness */
        element {        /* first maxwell element */ 
          2000,          /*   - stiffness */
          5000           /*   - damping */
        }
        element {        /* second maxwell element */  
          4000,          /*   - stiffness */ 
          2000           /*   - damping */ 
        }
        // length 0.5
      }
      ...
    }
  }
}</pre><p xmlns="">

        </p><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            In contrast to normal connections viscoelastic connections do not participate in 
            collisions.  If you want connection-connection collisions in your simulation you
            have to use normal connections in addition.
          </p></td></tr></table></div></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_group"></a>2.7.4.1.4.5. grouping elements</h6></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528054"></a><p xmlns="">Simulation elements can be categorized into groups.  The main purpose of this
          is to speed up collision tests.  The <tt class="function">group</tt> keyword can be followed by
          an integer number in parentheses to explicitly specify the group.  Otherwise
          the group index is determined automatically.
        </p><p xmlns="">

          </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      mass { ... }  /* these elements are group index 0 */
      ...
      group {
        mass { ... } /* these elements are group index 1 */
      }
      group {
        mass { ... } /* these elements are group index 2 */
      }
      group (1) {
        mass { ... } /* these elements are group index 1 */
      }

      ...
    }
  }
}</pre><p xmlns="">

        </p></div><div class="section_5" lang="en"><div xmlns="" class="titlepage"><div><div><h6 class="title"><a name="mechsim_topo_save_load"></a>2.7.4.1.4.6. saving and loading topology data</h6></div></div><div></div></div><p xmlns="">The topology data can be written to and loaded
          from files.  For the format of these files see
          <a href="#mechsim_file" title="2.7.4.3. The simulation data file format">Section 2.7.4.3, &#8220;The simulation data file format&#8221;</a>.
        </p><p xmlns="">
          <a class="indexterm" name="id2528127"></a>
          <tt class="function">save_file</tt> can only be added to the main
          <tt class="function">topology{}</tt> block.  It saves the complete data
          after the simulation to the specified file.
        </p><p xmlns="">
          <a class="indexterm" name="id2528157"></a>
          <tt class="function">load_file</tt> can be placed anywhere in the
          <tt class="function">topology{}</tt> section.  If placed in a group
          the elements in the file are added to that group.
          Otherwise they are are placed in groups according to group index information in
          the file.
        </p><p xmlns="">
          The same file name can be specified for both loading and saving the data.  This
          is especially useful for animation when the following frame simulation should start
          with the result of the last frame:
        </p><p xmlns="">

          </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      load_file "mechsim_data.dat"
      save_file "mechsim_data.dat"
    }
  }
}</pre><p xmlns="">

        </p></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_interaction"></a>2.7.4.1.5. Mass interaction</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528221"></a><p xmlns="">
        Masses can be set to exert forces on each other depending
        on the distance and the position in space.  Phenomena like
        gravity in space and electrostatic fields can be simulated
        this way.
      </p><p xmlns="">
        The <tt class="function">interaction{}</tt> block can contain
        one or more user defined functions.  Apart from the default
        parameters (<tt class="function">x</tt>, <tt class="function">y</tt> and
        <tt class="function">z</tt>) the functions can have three additional 
        parameters:  the distance between the masses and the masses of the two
        masses that interact.
      </p><p xmlns="">
        The function return value defines the force exerted on both masses
        in opposite directions.  Positive values mean attractive
        forces and negative values repulsion.
      </p><p xmlns="">
        To calculate the force on each mass the function is evaluated at the 
        mass position for all combinations with other masses.  The first mass
        parameter is always for the mass itself, the second is for the other
        mass interacting.  In most cases the two mass parameters should be
        exchangeable in the formula of course.
      </p><div xmlns="" class="example"><a name="id2528291"></a><p class="title"><b>Example 2.15. Mass interaction</b></p><p xmlns="">

          The following code defines an gravity-like inverse square falloff interaction

        </p><pre class="programlisting">#declare fn_Force=function(x, y, z, dist, m1, m2) { (m1*m2)/(dist*dist) }

global_settings {
  ...
  mechsim {
    ...
    interaction {
      function(x, y, z, dist) { fn_Force(x, y, z, dist) }
      ...
    }
  }
}</pre><p xmlns="">

        </p></div></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_field"></a>2.7.4.1.6. Field forces</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528327"></a><p xmlns="">
        General field like forces can be simulated
        using the <tt class="function">field{}</tt> block.  One example
        for such a field force is gravity although the simulation
        system has a special parameter for specifying such a
        simple constant gravity force.  Much more complicated
        fields can be set up using this function.
      </p><p xmlns="">
        The <tt class="function">field{}</tt> block expects a pigment function
        defining the force components in the different directions.
        The <tt class="function">red</tt> component of the pigment for the
        <tt class="function">x</tt> direction, the <tt class="function">green</tt> component
        for the <tt class="function">y</tt> direction and <tt class="function">blue</tt> for
        <tt class="function">z</tt>. The mechsim include file
        (see <a href="#mechsim.inc" title="3.4. The 'mechsim.inc' include file">Section 3.4, &#8220;The 'mechsim.inc' include file&#8221;</a>)
        contains a macro generating an appropriate pigment function
        from three float functions.
      </p><div xmlns="" class="example"><a name="id2528416"></a><p class="title"><b>Example 2.16. Constant downward force in Mechanics simulation</b></p><p xmlns="">

          A function for a constant downward force (in y direction)
          would look like:

          </p><pre class="programlisting"><tt class="function">#include</tt> "<tt class="filename">mechsim.inc</tt>"

global_settings {
  ...
  mechsim {
    ...
    field {
      Vector_Function(
        function {0},
        function {-1},
        function {0}
      )
      ...
    }
  }
}</pre><p xmlns="">

        </p></div><p xmlns="">
        Note that in contrast to the gravity parameter the
        fields define a force and not an acceleration.  Large masses will
        be influenced less than small masses.
      </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="mechsim_attach"></a>2.7.4.1.7. Attaching masses</h5></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528476"></a><p xmlns="">
        Apart from adding the <tt class="function">fixed</tt> flag to masses and thereby
        fixing them to a certain position we can also constrain them to a certain
        predefined movement.  Those movements are described with spline functions
        in the <tt class="function">attach{}</tt> block.
      </p><p xmlns="">
        An optional vector can be added after the <tt class="function">attach</tt>
        keyword to make the attachment only force the movement in one or two 
        coordinate directions.  Zero elements in the vector lead to free movement in that direction
      </p><div xmlns="" class="example"><a name="id2528522"></a><p class="title"><b>Example 2.17. Attachment in Mechanics simulation</b></p><p xmlns="">

          The following generates a linear movement in x direction,
          a constant position in y direction and
          a free movement in z-direction:

          </p><pre class="programlisting">global_settings {
  ...
  mechsim {
    ...
    attach &lt;1,1,0&gt; {
      function {
        spline {
          linear_spline
            0.0, &lt;0,0,0&gt;
            0.5, &lt;1,0,0&gt;
            1.0, &lt;2,0,0&gt;
          }
        }
      }
      ...
    }
  }
}</pre><p xmlns="">

        </p></div><p xmlns="">
        These functions are automatically numbered starting from zero.
        To attach a mass to a function the <tt class="function">attach</tt> parameter
        has to be set in the mass definition.  The following mass is
        attached to the <tt class="function">attach</tt> function with the number two:
      </p><p xmlns="">
        </p><pre xmlns="" class="programlisting">mass {
  &lt;0, 0, 1&gt;, &lt;0, 0, 0&gt;, 0.1
  density 600
  attach 2
}</pre><p xmlns="">
      </p><p xmlns="">
        During the simulation the spline is evaluated at the current
        time value and the returned vector describes the movement of the
        attached masses.  Note that the spline does not describe an
        absolute position for the masses, just their movement relative
        to their starting position.  Attaching several masses to the same
        spline makes them perform a parallel movement.
      </p></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_access"></a>2.7.4.2. Accessing simulation data</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528609"></a><p xmlns="">
      The whole simulation data can be accessed anywhere in the
      POV-Script.  This is achieved by adding new float/vector
      functions:
    </p><p xmlns="">
      The complete syntax description of this block is:
      </p><pre xmlns="" class="synopsis"><i class="parameter"><tt>FLOAT_FUNCTION</tt></i>:
    ... | mechsim : <i class="parameter"><tt>MECHSIM_ELEMENTS</tt></i>
<i class="parameter"><tt>MECHSIM_ELEMENTS</tt></i>:
    time | mass_count | connection_count | face_count |
    mass( <i class="parameter"><tt>INTEGER</tt></i> ) : <i class="parameter"><tt>MASS_FLOAT_ELEMENT</tt></i> |
    connection( <i class="parameter"><tt>INTEGER</tt></i> ) : <i class="parameter"><tt>CONNECTION_FLOAT_ELEMENT</tt></i> |
    viscoelastic( <i class="parameter"><tt>INTEGER</tt></i> ) : <i class="parameter"><tt>VISCOELASTIC_FLOAT_ELEMENT</tt></i> |
    face( <i class="parameter"><tt>INTEGER</tt></i> ) : <i class="parameter"><tt>FACE_FLOAT_ELEMENT</tt></i>
<i class="parameter"><tt>MASS_FLOAT_ELEMENT</tt></i>:
    radius | mass
<i class="parameter"><tt>CONNECTION_FLOAT_ELEMENT</tt></i>:
    index1 | index2 | length | stiffness | damping
<i class="parameter"><tt>VISCOELASTIC_FLOAT_ELEMENT</tt></i>:
    index1 | index2 | length | stiffness | accuracy | count | 
    element( <i class="parameter"><tt>INTEGER</tt></i> ) : stiffness | damping | position
<i class="parameter"><tt>FACE_FLOAT_ELEMENT</tt></i>:
    index1 | index2 | index3

<i class="parameter"><tt>VECTOR_FUNCTION</tt></i>:
    ... | mechsim : <i class="parameter"><tt>MECHSIM_ELEMENTS</tt></i>
<i class="parameter"><tt>MECHSIM_ELEMENTS</tt></i>:
    mass( <i class="parameter"><tt>INTEGER</tt></i> ) : <i class="parameter"><tt>MASS_VECTOR_ELEMENT</tt></i>
<i class="parameter"><tt>MASS_VECTOR_ELEMENT</tt></i>:
    position | velocity | force</pre><p xmlns="">
    </p><p xmlns="">
      These elements correspond to those set in the
      <tt class="function">mechsim{}</tt> block in <tt class="function">global_settings{}</tt>.  The
      mass position and velocity are the ones that are modified during
      simulation.  The mass force is the summed force that accelerated the mass in the last simulation step.
      <a class="indexterm" name="id2528809"></a>
      <a class="indexterm" name="id2528820"></a>
      <a class="indexterm" name="id2528831"></a>
      The <tt class="function">mass_count</tt> <tt class="function">connection_count</tt>
      and <tt class="function">face_count</tt> values are especially useful inside
      the <tt class="function">mechsim{}</tt> block to determine the current index:
    </p><p xmlns="">
      </p><pre xmlns="" class="programlisting">global_settings {
  ...
  mechsim {
    ...
    topology {
      /* part 1 */
      mass { ... }
      mass { ... }
      connection { ... }
      ...

      #declare Start_Mass_Part2=mechsim:mass_count;
      #declare Start_Connection_Part2=mechsim:connection_count;

      /* part 2 */
      mass { ... }
      mass { ... }
      connection { ... }
      ...
    }
  }
}</pre><p xmlns="">
    </p><p xmlns="">
      The <tt class="function">Start_Mass_Part2</tt> and
      <tt class="function">Start_Connection_Part2</tt>
      variables can later be used to display the different
      parts of the simulation in different forms.
    </p><p xmlns="">
      The <tt class="function">time</tt> value returns the current time index of the simulation (in seconds).
      Inside the <tt class="function">mechsim</tt> block this is the start time of the simulation, afterwards
      it returns the time index when the simulation ended.
    </p><p xmlns="">
      The <tt class="function">force</tt> values return the force a connection exerts on the
      masses it connects.  This value is a scalar, the force is always in direction
      of the connection.  Note this value can of course be calculated manually as well,
      it is supplied for convenience.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_file"></a>2.7.4.3. The simulation data file format</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2528955"></a><a xmlns="" class="indexterm" name="id2528965"></a><p xmlns="">
      The file format used for storing the simulation data has changed in MegaPOV 1.2.  
      Backwards compatibility is provided for reading MegaPOV 1.1 style simulation data files.
      The new file format is especially introduced for being forward compatible with future
      versions of MegaPOV.  This means that data files written by newer versions of MegaPOV
      should still be possible to read with MegaPOV 1.2 - it will just ignore the data it cannot handle.
    </p><p xmlns="">
      The file format - like the old one - is a ASCII text file format.  
      It starts with a four character string ('MSIM') identifying the mechanics simulation
      file format.  The second element (seperated by a comma) is an integer number specifying the subformat of the
      file.  Subformat <tt class="function">4</tt> is the current new format. Subformat 
      <tt class="function">3</tt> and lower are read with the backwards compatibility feature.
    </p><p xmlns="">
      After that follows a line break and the first character of every line following
      indicates what kind of data is stored in that line.  The following characters
      are recognized right now:
    </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">I</tt>: Info line - containing 4 number: the number of masses, 
          connections, faces and viscoelastic connections in the file (all integer).
        </p></li><li><p>
          <tt class="function">T</tt>: Timing line - containing 3 number: the current time index (float), 
          the current time step size (float) and the number of steps (integer).  If no timing parameters are specified
          in the <tt class="function">mechsim{}</tt> block these are used.  If adaptive time stepping
          is used the stored time step value is used as the starting time step.
        </p></li><li><p xmlns="">
          <tt xmlns="" class="function">M</tt>: Mass line (see <a xmlns="" href="#mechsim_topo_mass" title="2.7.4.1.4.1. Point masses">Section 2.7.4.1.4.1, &#8220;Point masses&#8221;</a>) - 
          containing the following numbers:
          </p><div class="itemizedlist"><ul type="circle" compact><li>3 numbers for the position (float vector), unit: <tt class="function">m</tt></li><li>3 numbers for the velocity (float vector), unit: <tt class="function">m/s</tt></li><li>The mass (float), unit: <tt class="function">kg</tt></li><li>The radius (float), unit: <tt class="function">m</tt></li><li>
                A flag (integer) currently only containing the <tt class="function">fixed</tt> value.
                This flag could contain other boolean values in the future (connected with
                logical OR) so it should be tested accordingly (<tt class="function">if (flag &amp; 1)</tt>)
              </li><li>The group index (integer)</li><li>The attach index (integer) - <tt class="function">-1</tt> means not attached</li></ul></div><p xmlns="">
        </p></li><li><p xmlns="">
          <tt xmlns="" class="function">C</tt>: Connection line (see <a xmlns="" href="#mechsim_topo_connection" title="2.7.4.1.4.2. Connections">Section 2.7.4.1.4.2, &#8220;Connections&#8221;</a>) - 
          containing the following numbers:
          </p><div class="itemizedlist"><ul type="circle" compact><li>The index of the first mass (integer)</li><li>The index of the second mass (integer)</li><li>The relaxed length (float), unit: <tt class="function">m</tt></li><li>The stiffness (float), unit: <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt></li><li>The damping constant (float), unit: <tt class="function">kg/s</tt></li><li>The group index (integer)</li></ul></div><p xmlns="">
        </p></li><li><p xmlns="">
          <tt xmlns="" class="function">F</tt>: Face line (see <a xmlns="" href="#mechsim_topo_face" title="2.7.4.1.4.3. Faces">Section 2.7.4.1.4.3, &#8220;Faces&#8221;</a>) - 
          containing the following numbers:
          </p><div class="itemizedlist"><ul type="circle" compact><li>The index of the first mass (integer)</li><li>The index of the second mass (integer)</li><li>The index of the third mass (integer)</li><li>The group index (integer)</li></ul></div><p xmlns="">
        </p></li><li><p xmlns="">
          <tt xmlns="" class="function">V</tt>: Viscoelastic connection line (see <a xmlns="" href="#mechsim_topo_viscoelastic" title="2.7.4.1.4.4. Viscoelastic connections">Section 2.7.4.1.4.4, &#8220;Viscoelastic connections&#8221;</a>) - 
          containing the following numbers:
          </p><div class="itemizedlist"><ul type="circle" compact><li>The index of the first mass (integer)</li><li>The index of the second mass (integer)</li><li>The relaxed length (float), unit: <tt class="function">m</tt></li><li>The static stiffness (float), unit: <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt></li><li>The calculation accuracy (integer), 1 or larger</li><li>The number of maxwell elements (integer)</li><li><p>For every maxwell elements: The value of the inner coordinate (float), 
              unit: <tt class="function">m</tt>, the stiffness (float), 
              unit: <tt class="function">N/m</tt> or <tt class="function">kg/s²</tt></p>
              and the damping (float), unit: <tt class="function">kg/s</tt>.
            </li></ul></div><p xmlns="">
        </p></li></ul></div><div xmlns="" class="example"><a name="id2529508"></a><p class="title"><b>Example 2.18. The simulation data file format</b></p><p xmlns="">
        A short sample file looks like this:

        </p><pre class="programlisting">MSIM, 4,
I 3 2 0
T 0.133333 0.00182897 16
M 0.000000000000 0.000000000000 2.400000000000 0.000000000000 0.000000000000 0.000000000000 20.944 0.1 1 0 -1 -1
M 0.998031324856 0.000000000000 2.309705370342 -0.078825113822 0.000000000000 -1.298327808122 20.944 0.1 0 0 -1 -1
M 1.996410451933 0.000000000000 2.390382496553 -0.094947075882 0.000000000000 -0.744192468433 70.6858 0.15 0 0 -1 -1
C 0 1 1 50000 2000 0
C 1 2 1 50000 2000 0</pre><p xmlns="">

        This file contains 3 masses and two normal connections between them.  Simulation has progressed to
        <tt xmlns="" class="function">0.133333</tt> seconds with a current time stepping of <tt xmlns="" class="function">0.00182897</tt>
        and <tt xmlns="" class="function">16</tt> steps per frame.  The first mass is fixed, the others are moving freely.

      </p></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="post_processing"></a>2.7.5. Post processing</h3></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    Post processing allows manipulation of the color of the pixels after the rendering step is
    completed.
  </p><p xmlns="">
    In the past, post processing of images required some third-party software (such
    as PhotoShop, Paint Shop Pro, or the GIMP) or older versions of MegaPOV that had implemented
    a few predefined effects.
  </p><p xmlns="">
    MegaPOV 1.1 introduces a more generic approach to the post processing.
    Instead of being limited to a few predefined effects, access to the content of the rendered
    image through internal functions is now available for the user. By mixing these functions, any
    imaginable effect is possible. 
    As an example of using these functions, some basic effects (in the form of macros) are provided 
    with a similar syntax to the postprocessing effects included in older MegaPOV versions.
  </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="post_proc_storage"></a>2.7.5.1. Turning on the storage of data</h4></div></div><div></div></div><p xmlns="">
      Post processing data is stored during rendering. This data contains several components:
      color of the pixel, intersection point, depth, normal - in other words all the information
      the raytracer receives for each of the pixels. For anti-aliased images only the data from
      the first ray is gathered. The storage is automatically turned on after the explicit call
      to one of predefined macros:
      </p><pre xmlns="" class="programlisting">#<tt class="function">version</tt> unofficial megapov 1.1;
<tt class="function">#include</tt> "<tt class="filename">pprocess.inc</tt>"
// store data of the color and transparency
PP_Init_Alpha_Colors_Outputs()

// store data of the intersection point coordinates or &lt;0,0,0&gt;
PP_Init_IPoint_Outputs()

// store data of the normal at the intersection point or &lt;0,0,0&gt;
PP_Init_INormal_Outputs()

// store data of the perturbed normal at the intersection point or &lt;0,0,0&gt;
PP_Init_PNormal_Outputs()

// store the distance between camera and intersection point
PP_Init_Depth_Output()

// store the uv coordinates at the intersection point
PP_Init_UV_Outputs()

// allow access to intermediate post processing stages
// (color and transparency received from a previous post process stage)
PP_Init_PP_Alpha_Colors_Outputs()
</pre><p xmlns="">
    </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        When using <tt class="function">post_process</tt> { }, do not forget to include the file "<tt class="filename">pprocess.inc</tt>"
        because this include file is needed to access the internal data.
      </p></td></tr></table></div><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        If you do not need to store all the data mentioned in the macros listed above, you can
        pick one ore more of the dedicated internal functions mentioned further down.
      </p><p>
        For example: store only the red component and the x coordinate of the intersection point
        for further usage. Check the content of the listed macros in the include file to find how to
        turn on only specific component storage.
      </p></td></tr></table></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="post_proc_functions"></a>2.7.5.2. Dedicated internal functions</h4></div></div><div></div></div><p xmlns="">
      Macros listed in the previous section enables internal functions with the following syntax:
      </p><pre xmlns="" class="programlisting">// functions to access the color components and transparency
f_output_red(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_green(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_blue(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_alpha(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to the intersection point coordinates
f_output_ipoint_x(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_ipoint_y(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_ipoint_z(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to the normal vector at the intersection point
f_output_inormal_x(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_inormal_y(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_inormal_z(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to the perturbed normal vector at the intersection point
f_output_pnormal_x(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_pnormal_y(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_pnormal_z(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to the distance between camera and intersection point
f_output_depth(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to the uv coordinates at the intersection point
f_output_u(<tt class="function">x</tt>,<tt class="function">y</tt>)
f_output_v(<tt class="function">x</tt>,<tt class="function">y</tt>)

// access to color and transparency of an earlier post processing stage
f_pp_red(<tt class="function">x</tt>,<tt class="function">y</tt>,<tt class="function">Ref</tt>)
f_pp_green(<tt class="function">x</tt>,<tt class="function">y</tt>,<tt class="function">Ref</tt>)
f_pp_blue(<tt class="function">x</tt>,<tt class="function">y</tt>,<tt class="function">Ref</tt>)
f_pp_alpha(<tt class="function">x</tt>,<tt class="function">y</tt>,<tt class="function">Ref</tt>)</pre><p xmlns="">
    </p><p xmlns="">
      The majority of the listed functions only need <tt xmlns="" class="function">x</tt> and <tt xmlns="" class="function">y</tt> parameters. These parameters
      are the location in the area of the rendered image. Not defined in pixels but in the range &lt;0,1&gt;.
      </p><div xmlns="" class="example"><a name="id2534727"></a><p class="title"><b>Example 2.19. The internal post process function asking for red color at the middle of image</b></p><pre class="programlisting">f_output_red(0.5,0.5)</pre></div><p xmlns="">
    </p><p xmlns="">
      Note that &lt;0,0&gt; is not the value of the most top-left pixel, but the value at the top left
      corner of the most top left _pixel_. You have to shift it about &lt;0.5/image_width,0.5/image_size&gt;
      to hit the center of the most top left pixel.
      If you are not happy with the need of expressing coordinates in decimal form you can always
      express them in relation to the image size. 
    </p><p xmlns="">
      Some of the functions contain an additional <tt class="function">Ref</tt> parameter. These are functions which
      refer to the result of the earlier calculated post processing stage. This parameter specifies to
      which stage we refer: 0 means output of rendering, 1 means output of first post processing, 2 means
      output of second postprocessing, etc.
    </p><p xmlns="">
      Numbering depends on the order of appearence in the sources.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="post_proc_definition"></a>2.7.5.3. Definition of the effect</h4></div></div><div></div></div><p xmlns="">
       Postprocessing should be defined in the <tt class="function">global_settings</tt> section of the scene file like this:
    </p><pre xmlns="" class="synopsis"><tt class="function">global_settings</tt> {
  <tt class="function">post_process</tt> {
    <tt class="function">function</tt> { ... } // calculation of red component
    <tt class="function">function</tt> { ... } // calculation of green component
    <tt class="function">function</tt> { ... } // calculation of blue component
    <tt class="function">function</tt> { ... } // calculation of transparency component
    [ <tt class="function">save_file</tt> FILENAME ]
  }
}</pre><p xmlns="">
      </p><div xmlns="" class="example"><a name="id2534858"></a><p class="title"><b>Example 2.20. Post processing which does nothing (only duplicate the original image)</b></p><pre class="programlisting"><tt class="function">global_settings</tt> {
  <tt class="function">post_process</tt> {
    <tt class="function">function</tt> { f_output_red(<tt class="function">x</tt>,<tt class="function">y</tt>) }   // calculation of red component
    <tt class="function">function</tt> { f_output_green(<tt class="function">x</tt>,<tt class="function">y</tt>) } // calculation of green component
    <tt class="function">function</tt> { f_output_blue(<tt class="function">x</tt>,<tt class="function">y</tt>) }  // calculation of blue component
    <tt class="function">function</tt> { f_output_alpha(<tt class="function">x</tt>,<tt class="function">y</tt>) } // calculation of transparency component
    <tt class="function">save_file</tt> "<tt class="filename">duplication.png</tt>"
  }
}</pre></div><p xmlns="">
    </p><p xmlns="">
       The <tt class="function">post_process</tt> block can appear a few times in the <tt class="function">global_settings</tt> block.
       Note that saving to file is optional but only the saved blocks will be calculated.
       Also note that saving is always done in the same file format as the render output
       (regardless of the file extension).
    </p><p xmlns="">
      </p><div xmlns="" class="example"><a name="id2535014"></a><p class="title"><b>Example 2.21. Post processing which turns the rendered image into a gray scale image</b></p><pre class="programlisting"><tt class="function">#declare</tt> F_gray = <tt class="function">function</tt>(<i class="parameter"><tt>r</tt></i>,<i class="parameter"><tt>g</tt></i>,<i class="parameter"><tt>b</tt></i>){0.297*<i class="parameter"><tt>r</tt></i> + 0.589*<i class="parameter"><tt>g</tt></i> + 0.114*<i class="parameter"><tt>b</tt></i>};
<tt class="function">global_settings</tt> {
  <tt class="function">post_process</tt> {
    <tt class="function">function</tt> { F_gray(f_output_red(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_green(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_blue(<tt class="function">x</tt>,<tt class="function">y</tt>)) }
    <tt class="function">function</tt> { F_gray(f_output_red(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_green(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_blue(<tt class="function">x</tt>,<tt class="function">y</tt>)) }
    <tt class="function">function</tt> { F_gray(f_output_red(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_green(<tt class="function">x</tt>,<tt class="function">y</tt>),f_output_blue(<tt class="function">x</tt>,<tt class="function">y</tt>)) }
    <tt class="function">function</tt> { f_output_alpha(<tt class="function">x</tt>,<tt class="function">y</tt>) }
    <tt class="function">save_file</tt> "<tt class="filename">grayed.png</tt>"
  }
}</pre></div><p xmlns="">
    </p><p xmlns="">
      Because it could be difficult using functions to define your own post processing effects, some
      macros with user-friendly syntax have been added to the "<tt class="filename">pprocess.inc</tt>" include file.
      For an overview and some explanation on the parameters, (see <a href="#post_proc_macros" title="3.5.1. Macros with effects">Section 3.5.1, &#8220;Macros with effects&#8221;</a>).
    </p></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="include"></a>Chapter 3. MegaPOV Include files</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#mp_functions.inc">3.1. The 'mp_functions.inc' include file</a></span></dt><dt><span class="section"><a href="#mp_consts.inc">3.2. The 'mp_consts.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#mp_consts_camera_view">3.2.1. Output types for camera_view pigment</a></span></dt></dl></dd><dt><span class="section"><a href="#mp_types.inc">3.3. The 'mp_types.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#id2553742">3.3.1. The Type_Of(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555017">3.3.2. The Type_Of_Spline(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555084">3.3.3. The Type_Of_Object(Id) macro</a></span></dt><dt><span class="section"><a href="#id2555156">3.3.4. The Type_Of_Camera(Id) macro</a></span></dt></dl></dd><dt><span class="section"><a href="#mechsim.inc">3.4. The 'mechsim.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#mechsim_inc_general">3.4.1. general aspects</a></span></dt><dt><span class="section"><a href="#mechsim_inc_const">3.4.2. constants</a></span></dt><dt><span class="section"><a href="#mechsim_inc_vector_function">3.4.3. The Vector_Function() macro</a></span></dt><dt><span class="section"><a href="#mechsim_inc_object">3.4.4. The Object generation macros</a></span></dt><dt><span class="section"><a href="#mechsim_inc_topology">3.4.5. The topology generation macros</a></span></dt></dl></dd><dt><span class="section"><a href="#inc_pprocess.inc">3.5. The 'pprocess.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#post_proc_macros">3.5.1. Macros with effects</a></span></dt><dt><span class="section"><a href="#shared_effects">3.5.2. Shared predefined effects</a></span></dt></dl></dd><dt><span class="section"><a href="#tone_mapping.inc">3.6. The 'tone_mapping.inc' include file</a></span></dt><dd><dl><dt><span class="section"><a href="#id2567246">3.6.1. The Clip_Colors() macro</a></span></dt><dt><span class="section"><a href="#id2568434">3.6.2. The Film_Exposure() macro</a></span></dt><dt><span class="section"><a href="#id2568502">3.6.3. The Film_Exposure_Invert() macro</a></span></dt><dt><span class="section"><a href="#id2568567">3.6.4. The Gamma_Correct() macro</a></span></dt><dt><span class="section"><a href="#id2568630">3.6.5. The Brightness_Contrast() macro</a></span></dt></dl></dd></dl></div><p>
    Similar to <span class="trademark">POV-Ray</span>&#8482;, MegaPOV also delivers a set of include files
    to make the use of MegaPOV specific features easier.
  </p><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mp_functions.inc"></a>3.1. The '<tt class="filename">mp_functions.inc</tt>' include file</h2></div></div><div></div></div><p xmlns="">
      The <tt class="filename">mp_functions.inc</tt> include file collects definitions of internal functions
      introduced in MegaPOV (see <a href="#internal_functions" title="2.2.4. Internal functions">Section 2.2.4, &#8220;Internal functions&#8221;</a>).
    </p></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mp_consts.inc"></a>3.2. The '<tt class="filename">mp_consts.inc</tt>' include file</h2></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    This file defines a number of constants used for easier operating on float parameters. 
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mp_consts_camera_view"></a>3.2.1. Output types for <tt class="function">camera_view</tt> pigment</h3></div></div><div></div></div><pre xmlns="" class="programlisting">Output_Color
Output_Intersection_Point
Output_Normal_Vector
Output_Perturbed_Normal_Vector
Output_Depth
Output_UV_Vector</pre></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mp_types.inc"></a>3.3. The '<tt class="filename">mp_types.inc</tt>' include file</h2></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><p xmlns="">
    This part describes the <tt class="filename">mp_types.inc</tt>
    include file that comes with MegaPOV and contains
    macros for simplification of type checking. Some user might be disappointed
    with syntax of <tt class="function">is</tt> function (see <a href="#is" title="2.2.3.6. Type checking">Section 2.2.3.6, &#8220;Type checking&#8221;</a>) and this syntax can be different
    in the future so this file creates layer between scripts and hard coded syntax
    of type checking (for example for usage in <tt class="function">#switch</tt> block).
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2553742"></a>3.3.1. The <tt class="function">Type_Of(<i class="parameter"><tt>Id</tt></i>)</tt> macro</h3></div></div><div></div></div><p xmlns="">
      <a xmlns="" class="indexterm" name="id2554966"></a>
      Macro <tt xmlns="" class="function">Type_Of(<i class="parameter"><tt>Id</tt></i>)</tt> returns one of following
      constants for given <i xmlns="" class="parameter"><tt>Id</tt></i>:
      </p><pre xmlns="" class="programlisting">UNDEFINED_ID,    ARRAY_ID,       CAMERA_ID,
COLOR_ID,        COLOR_MAP_ID,   DENSITY_ID,
DENSITY_MAP_ID,  FINISH_ID,      FLOAT_ID,
FOG_ID,          FUNCTION_ID,    INTERIOR_ID,
LIGHT_SOURCE_ID, MATERIAL_ID,    MEDIA_ID,
NORMAL_ID,       NORMAL_MAP_ID,  OBJECT_ID,
PIGMENT_ID,      PIGMENT_MAP_ID, RAINBOW_ID,
SKY_SPHERE_ID,   SLOPE_MAP_ID,   SPLINE_ID,
STRING_ID,       TEXTURE_ID,     TEXTURE_MAP_ID,
TRANSFORM_ID,    VECTOR_ID</pre><p xmlns="">
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2555017"></a>3.3.2. The <tt class="function">Type_Of_Spline(<i class="parameter"><tt>Id</tt></i>)</tt> macro</h3></div></div><div></div></div><p xmlns="">
      <a xmlns="" class="indexterm" name="id2555039"></a>
      Macro <tt xmlns="" class="function">Type_Of_Spline(<i class="parameter"><tt>Id</tt></i>)</tt> returns one of following
      constants for given <i xmlns="" class="parameter"><tt>Id</tt></i>:
      </p><pre xmlns="" class="programlisting">
NOT_SPLINE,    AKIMA_SPLINE,      BASIC_X_SPLINE,
CUBIC_SPLINE,  EXTENDED_X_SPLINE, GENERAL_X_SPLINE,
LINEAR_SPLINE, NATURAL_SPLINE,    QUADRATIC_SPLINE,
SOR_SPLINE,    TCB_SPLINE</pre><p xmlns="">
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2555084"></a>3.3.3. The <tt class="function">Type_Of_Object(<i class="parameter"><tt>Id</tt></i>)</tt> macro</h3></div></div><div></div></div><p xmlns="">
      <a xmlns="" class="indexterm" name="id2555106"></a>
      Macro <tt xmlns="" class="function">Type_Of_Object(<i class="parameter"><tt>Id</tt></i>)</tt> returns one of following
      constants for given <i xmlns="" class="parameter"><tt>Id</tt></i>:
      </p><pre xmlns="" class="programlisting">NOT_OBJECT,          BICUBIC_PATCH_OBJECT,   BLOB_OBJECT,
BOX_OBJECT,          CONE_OBJECT,            CUBIC_OBJECT, 
CYLINDER_OBJECT,     DISC_OBJECT,            HEIGHT_FIELD_OBJECT, 
INTERSECTION_OBJECT, ISOSURFACE_OBJECT,      JULIA_FRACTAL_OBJECT, 
LATHE_OBJECT,        MERGE_OBJECT,           MESH_OBJECT, 
PARAMETRIC_OBJECT,   PLANE_OBJECT,           POLY_OBJECT, 
POLYGON_OBJECT,      PRISM_OBJECT,           QUADRIC_OBJECT, 
QUARTIC_OBJECT,      SMOOTH_TRIANGLE_OBJECT, SOR_OBJECT, 
SPHERE_OBJECT,       SPHERE_SWEEP_OBJECT,    SUPERELLIPSOID_OBJECT, 
TEXT_OBJECT,         TORUS_OBJECT,           TRIANGLE_OBJECT, 
UNION_OBJECT</pre><p xmlns="">
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2555156"></a>3.3.4. The <tt class="function">Type_Of_Camera(<i class="parameter"><tt>Id</tt></i>)</tt> macro</h3></div></div><div></div></div><p xmlns="">
      <a xmlns="" class="indexterm" name="id2555177"></a>
      Macro <tt xmlns="" class="function">Type_Of_Camera(<i class="parameter"><tt>Id</tt></i>)</tt> returns one of following
      constants for given <i xmlns="" class="parameter"><tt>Id</tt></i>:
      </p><pre xmlns="" class="programlisting">NOT_CAMERA,         CYLINDER_CAMERA,     FISHEYE_CAMERA
OMNIMAX_CAMERA,     ORTHOGRAPHIC_CAMERA, PANORAMIC_CAMERA,
PERSPECTIVE_CAMERA, SPHERICAL_CAMERA,    ULTRA_WIDE_ANGLE_CAMERA,
USER_DEFINED_CAMERA</pre><p xmlns="">
    </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mechsim.inc"></a>3.4. The '<tt class="filename">mechsim.inc</tt>' include file</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
    This part describes the <tt class="filename">mechsim.inc</tt>
    include file that comes with MegaPOV and contains
    various macros simplifying the use of the mechanics simulation
    features.
  </p><p xmlns="">
    The <tt class="filename">mechsim.inc</tt> include file contains
    several macros so simplify the generation of simulation
    topologies as well as macros building <span class="trademark">POV-Ray</span>&#8482;
    objects representing the simulation data.
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_inc_general"></a>3.4.1. general aspects</h3></div></div><div></div></div><p xmlns="">
      At the beginning of the file there are various declarations of textures
      and other things that are used by the macros.  In most cases you can
      override the default values by declaring the identifiers differently before
      including the file.
    </p><p xmlns="">
      <tt class="function">MSIM_INCLUDE_VERSION</tt>
      <a class="indexterm" name="id2554805"></a>
    </p><p xmlns="">
      The version number of the <tt class="filename">mechsim.inc</tt> include file.
    </p><p xmlns="">
      <tt class="function">No_Trans</tt>
      <a class="indexterm" name="id2554837"></a>
    </p><p xmlns="">
      A dummy transform that can be used in the topology generation macros
      (see <a href="#mechsim_inc_topology" title="3.4.5. The topology generation macros">Section 3.4.5, &#8220;The topology generation macros&#8221;</a>)
      if no transform is supposed to be used.
    </p><p xmlns="">
      <tt class="function">No_Fixed</tt>
      <a class="indexterm" name="id2554873"></a>
    </p><p xmlns="">
      A dummy fixation function for topology generation macros 
      (see <a href="#mechsim_inc_topology" title="3.4.5. The topology generation macros">Section 3.4.5, &#8220;The topology generation macros&#8221;</a>) that does not fix any masses.
    </p><p xmlns="">
      <tt class="function">No_Attach</tt>
      <a class="indexterm" name="id2555779"></a>
    </p><p xmlns="">
      A dummy attach function for topology generation macros 
      (see <a href="#mechsim_inc_topology" title="3.4.5. The topology generation macros">Section 3.4.5, &#8220;The topology generation macros&#8221;</a>) that does not attach any masses.
    </p><p xmlns="">
      <tt class="function">No_Force</tt>
      <a class="indexterm" name="id2555813"></a>
    </p><p xmlns="">
      A dummy force function for topology generation macros 
      (see <a href="#mechsim_inc_topology" title="3.4.5. The topology generation macros">Section 3.4.5, &#8220;The topology generation macros&#8221;</a>) that does not apply custom forces to any masses.
    </p><p xmlns="">
      <tt class="function">MSim_File_Decimals</tt>
      <a class="indexterm" name="id2555847"></a>
    </p><p xmlns="">
      The number of decimal places to be written to files for coordinates.
      Default value is <tt class="literal">12</tt>.
    </p><p xmlns="">
      <tt class="function">MSim_Test_Render</tt>
      <a class="indexterm" name="id2555880"></a>
    </p><p xmlns="">
      If <tt class="function">true</tt> reflection is turned off for the textures in
      this include file. Default value is <tt class="function">false</tt>.
    </p><p xmlns="">
      <tt class="function">MSim_Tex_N</tt>
      <a class="indexterm" name="id2555920"></a>
    </p><p xmlns="">
      Texture to be used for texturing the nodes (masses) of the simulation
      topology.  A grey metallic texture by default.
    </p><p xmlns="">
      <tt class="function">MSim_Tex_C</tt>
      <a class="indexterm" name="id2555948"></a>
    </p><p xmlns="">
      Texture to be used for texturing the connections of the simulation
      topology.  A gold metallic texture by default.
    </p><p xmlns="">
      <tt class="function">MSim_Tex_Mesh</tt>
      <a class="indexterm" name="id2555975"></a>
    </p><p xmlns="">
      Texture to be used for texturing the faces of the simulation
      topology.  A bluish metallic texture by default.
    </p><p xmlns="">
      <tt class="function">fn_Stress_CM</tt>
      <a class="indexterm" name="id2556003"></a>
    </p><p xmlns="">
      Color map function to use for visualizing the stress in
      simulation topologies.  A color (pigment) function is used here.  It is
      evaluated in x-direction between 0 and 1.
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_inc_const"></a>3.4.2. constants</h3></div></div><div></div></div><p xmlns="">
      Several constants are defined at the beginning of <tt class="filename">mechsim.inc</tt>.
      They correspond to constants in the source code and can be used for selecting methods
      and techniques in the mechsim system instead of literal values.
    </p><p xmlns="">
      <a xmlns="" class="indexterm" name="id2556052"></a>
      <a xmlns="" class="indexterm" name="id2556062"></a>
      <a xmlns="" class="indexterm" name="id2556074"></a>
      <a xmlns="" class="indexterm" name="id2556085"></a>
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">MECHSIM_METHOD_EULER</tt> (<tt class="constant">1</tt>)</li><li><tt class="function">MECHSIM_METHOD_HEUN</tt> (<tt class="constant">2</tt>)</li><li><tt class="function">MECHSIM_METHOD_RUNGE_KUTTA4</tt> (<tt class="constant">3</tt>)</li><li><tt class="function">MECHSIM_METHOD_GRADIENT</tt> (<tt class="constant">4</tt>)</li></ul></div><p xmlns="">

      <a xmlns="" class="indexterm" name="id2556162"></a>
      <a xmlns="" class="indexterm" name="id2556173"></a>
      <a xmlns="" class="indexterm" name="id2556184"></a>
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">MECHSIM_COLLISION_NONE</tt> (<tt class="constant">0</tt>)</li><li><tt class="function">MECHSIM_COLLISION_ALL</tt> (<tt class="constant">1</tt>)</li><li><tt class="function">MECHSIM_COLLISION_GROUP</tt> (<tt class="constant">2</tt>)</li></ul></div><p xmlns="">

      <a xmlns="" class="indexterm" name="id2556246"></a>
      <a xmlns="" class="indexterm" name="id2556258"></a>
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">MECHSIM_ENV_METHOD_FORCE</tt> (<tt class="constant">1</tt>)</li><li><tt class="function">MECHSIM_ENV_METHOD_IMPACT</tt> (<tt class="constant">2</tt>)</li></ul></div><p xmlns="">

      <a xmlns="" class="indexterm" name="id2556305"></a>
      <a xmlns="" class="indexterm" name="id2556316"></a>
      <a xmlns="" class="indexterm" name="id2556328"></a>
      <a xmlns="" class="indexterm" name="id2556339"></a>
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="function">MECHSIM_COLLISION_BOUNDING_NO</tt> (<tt class="constant">0</tt>)</li><li><tt class="function">MECHSIM_COLLISION_BOUNDING_AUTO</tt> (<tt class="constant">1</tt>)</li><li><tt class="function">MECHSIM_COLLISION_BOUNDING_BOX</tt> (<tt class="constant">2</tt>)</li><li><tt class="function">MECHSIM_COLLISION_BOUNDING_HASH</tt> (<tt class="constant">3</tt>)</li></ul></div><p xmlns="">
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_inc_vector_function"></a>3.4.3. The <tt class="function">Vector_Function()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2556438"></a><p xmlns="">
      <span class="trademark">POV-Ray</span>&#8482; does not allow to directly define custom vector functions.
      With pigment functions it is possible to generate a vector function from
      three float functions though.  The way this macro works makes it necessary
      to have a limited range for the function values.
      <tt class="function">Vector_Function()</tt> is a wrapper macro for
      <tt class="function">Vector_Function_Range()</tt> using a default range of
      <tt class="function">1e6</tt>.
      If necessary this can be changed by declaring a different value for
      <tt class="function">MSim_Fn_Range</tt> before including
      <tt class="filename">mechsim.inc</tt>.
    </p><p xmlns="">
      The <tt xmlns="" class="function">Vector_Function()</tt> macro is
      used the following way:

      </p><pre xmlns="" class="programlisting">#declare Fn_Vector=
  function {
    Vector_Function(
      function { x },
      function { x*x },
      function { 0 }
    )
  }</pre><p xmlns="">

      where the three functions define the return vector's x, y and z
      components.
    </p><p xmlns="">
      The mechanics simulation patch uses vector functions in the
      field feature (see <a href="#mechsim_field" title="2.7.4.1.6. Field forces">Section 2.7.4.1.6, &#8220;Field forces&#8221;</a>).
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_inc_object"></a>3.4.4. The Object generation macros</h3></div></div><div></div></div><p xmlns="">
      These macros generate <span class="trademark">POV-Ray</span>&#8482; objects from the simulation data.  There are
      macros for general topology visualization and specific macros for
      generating meshes from patch/box/sphere topologies created with the 
      corresponding generation macros.
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Objects"></a>3.4.4.1. MechSim_Show_Objects()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2556573"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro01.png" align="right"></div></div><p xmlns="">
        This macro generates <span class="trademark">POV-Ray</span>&#8482; shapes for all masses and connections or faces
        from a certain range of the simulation data.
      </p><p xmlns="">
        Depending on the value of the <tt class="function">Show_Faces</tt> parameter
        the macro will either generate a union of cylinders and spheres representing
        the masses and connections or a mesh with triangles representing the faces.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Start_Mass_Index</tt>,
          <tt class="function">Start_Connection_Index</tt>,
          <tt class="function">Start_Face_Index</tt> - the starting
          indices of the range of simulation elements that
          should be displayed by the macro.
        </p></li><li><p>
          <tt class="function">End_Mass_Index</tt>,
          <tt class="function">End_Connection_Index</tt>,
          <tt class="function">End_Face_Index</tt> - the end indices of the range
          of simulation elements that should be displayed by the macro.
          If one of this values is <tt class="function">&lt;0</tt> all elements until
          the last one are displayed.
        </p></li><li><p>
          <tt class="function">Connect_Rad</tt> - the radius to use for the connections.
          If this value is <tt class="function">&lt;0</tt> the macro uses
          <tt class="function">0.4*</tt> the mass radius for this.  If this value
          is 0 no cylinders are generated for the connections.
        </p></li><li><p>
          <tt class="function">Show_Faces</tt> - if <tt class="function">true</tt> only a mesh
          representing the faces is generated.  If <tt class="function">false</tt>
          connections are represented by cylinders and masses by
          spheres.
        </p></li><li><p>
          <tt class="function">Stress_Fact</tt> - if <tt class="function">&gt;0</tt> the connections
          are textured to visualize the stress.  The
          <tt class="function">fn_Stress_CM</tt> function is used for the colors.
          The extension from relaxed length is scaled with this
          factor. If this value is <tt class="function">&lt;0</tt> the connections
          are textured with <tt class="function">MSim_Tex_C</tt>.
        </p></li><li><p>
          <tt class="function">File_Name</tt> - file name string.  If its length is
          zero file writing is turned off, otherwise the geometry is
          written to a file with that name in addition.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2556810"></a><p class="title"><b>Example 3.1. MechSim_Show_Objects() macro usage</b></p><p>show all masses and connections:</p><pre class="programlisting">MechSim_Show_Objects(0, 0, 0, -1, -1, -1, -1, false, -1, "")</pre><p>declare an object of all faces</p><pre class="programlisting">#declare Obj=MechSim_Show_Objects(0, 0, 0, -1, -1, -1, -1, true, -1, "")</pre><p>
          show a subset of connections and faces, texture connections
          to visualize stress, write objects to file:
        </p><pre class="programlisting">MechSim_Show_Objects(0, 0, 0, 100, 300, 0, -1, false, 120, "sim01.inc")</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_All_Objects"></a>3.4.4.2. MechSim_Show_All_Objects()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2556875"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro02.png" align="right"></div></div><p xmlns="">
        Variation of the <tt class="function">MechSim_Show_Objects()</tt> macro displaying
        all elements of the current simulation data.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Connect_Rad</tt> - the radius to use for the connections.
          If this value is <tt class="function">&lt;0</tt> the macro uses
          <tt class="function">0.4*</tt> the mass radius for this.  If this value
          is 0 no cylinders are generated for the connections.
        </p></li><li><p>
          <tt class="function">Show_Faces</tt> - if <tt class="function">true</tt> only a mesh
          representing the faces is generated.  If <tt class="function">false</tt>
          connections are represented by cylinders and masses by
          spheres.
        </p></li><li><p>
          <tt class="function">Stress_Fact</tt> - if <tt class="function">&gt;0</tt> the connections
          are textured to visualize the stress.  The
          <tt class="function">fn_Stress_CM</tt> function is used for the colors.
          The extension from relaxed length is scaled with this
          factor. If this value is <tt class="function">&lt;0</tt> the connections
          are textured with <tt class="function">MSim_Tex_C</tt>.
        </p></li><li><p>
          <tt class="function">File_Name</tt> - file name string.  If its length is
          zero file writing is turned off, otherwise the geometry is
          written to a file with that name in addition.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2557036"></a><p class="title"><b>Example 3.2. MechSim_Show_All_Objects() macro usage</b></p><p>show all masses and connections:</p><pre class="programlisting">MechSim_Show_All_Objects(-1, false, -1, "")</pre><p>declare an object of all faces:</p><pre class="programlisting">#declare Obj=MechSim_Show_All_Objects(-1, true, -1, "")</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_All_Default"></a>3.4.4.3. MechSim_Show_All_Default()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2557083"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro02.png" align="right"></div></div><p xmlns="">
        Variation of the <tt class="function">MechSim_Show_All_Objects()</tt> using default values
        for all parameters.  If there are faces in the simulation data only faces are shown, otherwise
        connections and masses.  No file is written.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Grid"></a>3.4.4.4. MechSim_Show_Grid()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2557140"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro10c.png" align="right"></div></div><p xmlns="">
        This macro generates a mesh from the outer surface of a grid topology created with the
        <tt class="function">MechSim_Generate_Grid()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Grid" title="3.4.5.5. MechSim_Generate_Grid()">Section 3.4.5.5, &#8220;MechSim_Generate_Grid()&#8221;</a>). 
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Start_Face_Index</tt> - the index of the first face that is
          part of the patch.  This should be stored when the patch is
          generated.  The other starting indices are calculated
          internally.
        </p></li><li><p>
          <tt class="function">XSize, YSize, ZSize</tt> - size of the grid, number of nodes in
          x-, y- and z-direction.
        </p></li><li><p>
          <tt class="function">Smooth</tt> - if <tt class="function">true</tt> normal vectors are generated
          so the mesh is smoothed.
        </p></li><li><p>
          <tt class="function">UV</tt> - if <tt class="function">true</tt> uv-coordinates are generated
          This options currently has no effect.
        </p></li><li><p>
          <tt class="function">Stress_Fact</tt> - if <tt class="function">&gt;0</tt> the triangles
          of the mesh are textured on per vertex basis to visualize
          the stress.  The <tt class="function">fn_Stress_CM</tt> function is used
          for the colors. The connection's extension from relaxed length
          is scaled with this factor. If this value is <tt class="function">&lt;0</tt>
          the whole mesh is textured with <tt class="function">MSim_Tex_Mesh</tt>.
        </p></li><li><p>
          <tt class="function">File_Name</tt> - file name string.  If its length is
          zero file writing is turned off, otherwise the geometry is
          written to a file with that name in addition.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2557321"></a><p class="title"><b>Example 3.3. MechSim_Show_Grid() macro usage</b></p><p>show a 5x5x5 grid with smoothing:</p><pre class="programlisting">MechSim_Show_Patch(0, 5, 5, 5, true, false, -1, "")</pre><p>
          declare an object for the grid, generate normal vectors, 
          texture with stress visualization and write the results to a file:
        </p><pre class="programlisting">#declare Obj=MechSim_Show_Patch(0, 50, 50, true, true, 10, "sim01.inc")</pre></div><p xmlns="">
        Here a comparison between the different methods and variations:
      </p><div xmlns="" class="table"><a name="id2557362"></a><p class="title"><b>Table 3.1. MechSim_Show_Grid() variations</b></p><table summary="MechSim_Show_Grid() variations" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/macro10a.png"></div></td><td style="" align="center"><div><img src="img/macro10b.png"></div></td><td style="" align="center"><div><img src="img/macro10c.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>cylinders and spheres</em></span></td><td style="" align="center"><span class="emphasis"><em>cylinders and spheres (stress visualization)</em></span></td><td style="" align="center"><span class="emphasis"><em>face triangles</em></span></td></tr><tr><td style="" align="center"><div><img src="img/macro10c.png"></div></td><td style="" align="center"><div><img src="img/macro10d.png"></div></td><td style="" align="center"><div><img src="img/macro10e.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>no smooth</em></span></td><td style="" align="center"><span class="emphasis"><em>smooth</em></span></td><td style="" align="center"><span class="emphasis"><em>stress visualization</em></span></td></tr></tbody></table></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Patch"></a>3.4.4.5. MechSim_Show_Patch()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2557513"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro03c.png" align="right"></div></div><p xmlns="">
        This macro generates a mesh from the patch topology created with the
        <tt class="function">MechSim_Generate_Patch()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Patch" title="3.4.5.13. MechSim_Generate_Patch()">Section 3.4.5.13, &#8220;MechSim_Generate_Patch()&#8221;</a>).  The mesh
        is generated in form of the new <tt class="function">mesh2</tt> type and optionally includes
        uv- and normal data depending on the parameters.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Start_Face_Index</tt> - the index of the first face that is
          part of the patch.  This should be stored when the patch is
          generated.  The other starting indices are calculated
          internally.
        </p></li><li><p>
          <tt class="function">XSize, YSize</tt> - size of the patch, number of nodes in
          x- and y-direction.
        </p></li><li><p>
          <tt class="function">Smooth</tt> - if <tt class="function">true</tt> normal vectors are generated
          so the mesh is smoothed.
        </p></li><li><p>
          <tt class="function">UV</tt> - if <tt class="function">true</tt> uv-coordinates are generated
          ranging from 0 to 1 in x-Direction (range in y-Direction
          depends on the ratio of XSize to YSize).
        </p></li><li><p>
          <tt class="function">Stress_Fact</tt> - if <tt class="function">&gt;0</tt> the triangles
          of the mesh are textured on per vertex basis to visualize
          the stress.  The <tt class="function">fn_Stress_CM</tt> function is used
          for the colors. The connection's extension from relaxed length
          is scaled with this factor. If this value is <tt class="function">&lt;0</tt>
          the whole mesh is textured with <tt class="function">MSim_Tex_Mesh</tt>.
        </p></li><li><p>
          <tt class="function">File_Name</tt> - file name string.  If its length is
          zero file writing is turned off, otherwise the geometry is
          written to a file with that name in addition.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2557706"></a><p class="title"><b>Example 3.4. MechSim_Show_Patch() macro usage</b></p><p>show a 50x50 patch with smoothing:</p><pre class="programlisting">MechSim_Show_Patch(0, 50, 50, true, false, -1, "")</pre><p>
          declare an object for the patch, generate uv coordinates
          and normal vectors, write the results to a file:
        </p><pre class="programlisting">#declare Obj=MechSim_Show_Patch(0, 50, 50, true, true, -1, "sim01.inc")</pre></div><p xmlns="">
        Here a comparison between the different methods and variations:
      </p><div xmlns="" class="table"><a name="id2557746"></a><p class="title"><b>Table 3.2. MechSim_Show_Patch() variations</b></p><table summary="MechSim_Show_Patch() variations" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/macro03a.png"></div></td><td style="" align="center"><div><img src="img/macro03b.png"></div></td><td style="" align="center"><div><img src="img/macro03f.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>cylinders and spheres</em></span></td><td style="" align="center"><span class="emphasis"><em>face triangles</em></span></td><td style="" align="center"><span class="emphasis"><em>patch macro (stress visualization)</em></span></td></tr><tr><td style="" align="center"><div><img src="img/macro03d.png"></div></td><td style="" align="center"><div><img src="img/macro03e.png"></div></td><td style="" align="center"><div><img src="img/macro03c.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>no smooth, no uv</em></span></td><td style="" align="center"><span class="emphasis"><em>smooth</em></span></td><td style="" align="center"><span class="emphasis"><em>uv mapped</em></span></td></tr></tbody></table></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Sphere"></a>3.4.4.6. MechSim_Show_Sphere()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2557898"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro11.png" align="right"></div></div><p xmlns="">
        This macro generates a mesh from the outer surface of a grid topology created with the
        <tt class="function">MechSim_Generate_Sphere()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Sphere" title="3.4.5.18. MechSim_Generate_Sphere()">Section 3.4.5.18, &#8220;MechSim_Generate_Sphere()&#8221;</a>). 
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Start_Face_Index</tt> - the index of the first face that is
          part of the patch.  This should be stored when the patch is
          generated.  The other starting indices are calculated
          internally.
        </p></li><li><p>
          <tt class="function">Face_Count</tt> - number of faces of the sphere.
        </p></li><li><p>
          <tt class="function">Smooth</tt> - if <tt class="function">true</tt> normal vectors are generated
          so the mesh is smoothed.
        </p></li><li><p>
          <tt class="function">UV</tt> - if <tt class="function">true</tt> uv-coordinates are generated
          This options currently has no effect.
        </p></li><li><p>
          <tt class="function">Stress_Fact</tt> - if <tt class="function">&gt;0</tt> the triangles
          of the mesh are textured on per vertex basis to visualize
          the stress.  This options currently has no effect.
        </p></li><li><p>
          <tt class="function">File_Name</tt> - file name string.  If its length is
          zero file writing is turned off, otherwise the geometry is
          written to a file with that name in addition.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2558057"></a><p class="title"><b>Example 3.5. MechSim_Show_Sphere() macro usage</b></p><p>show a sphere that is the only topology element in the current simulation:</p><pre class="programlisting">MechSim_Show_Sphere(0, mechsim:face_count, false, false, -1, "")</pre><p>
          declare an object for the grid, generate normal vectors and write the results to a file:
        </p><pre class="programlisting">#declare Obj=MechSim_Show_Sphere(0, mechsim:face_count, true, false, -1, "sim01.inc")</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Con"></a>3.4.4.7. MechSim_Show_Con()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2558108"></a><p xmlns="">
        This macro generates a cylinder for a single connection.  In contrast to the other
        macros the cylinder is generated without texture. 
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Idx</tt> - the index of the connection to generate the cylinder for.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Show_Con_VE"></a>3.4.4.8. MechSim_Show_Con_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2558160"></a><p xmlns="">
        This macro generates a cylinder for a single viscoelastic connection.  In contrast to the other
        macros the cylinder is generated without texture. 
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Idx</tt> - the index of the connection to generate the cylinder for.
        </p></li></ul></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_inc_topology"></a>3.4.5. The topology generation macros</h3></div></div><div></div></div><p xmlns="">
      These macros are supposed to be placed in the <tt class="function">topology{}</tt>
      block of the <tt class="function">mechsim{}</tt> section.  They generate the masses,
      connections and faces for certain geometries.
    </p><p xmlns="">
      For most shapes there are low level macros that allow detailed control
      of the properties of the generated topologies as well as higher level
      wrapper macros that set certain parameters to default values.
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_Connect_Arr"></a>3.4.5.1. Explanation of the <tt class="function">Connect_Arr</tt> parameter</h4></div></div><div></div></div><p xmlns="">
        Most of the lower level macros have a parameter named <tt class="function">Connect_Arr</tt>.  This is an
        <tt class="function">array</tt> containing weighting factors for the different connections in.
      </p><p xmlns="">
        The objects generated by the macros have different types of connections: axis-parallel
        connections, 2D and 3D diagonal connections and possibly bending connections.  How
        these connections are weighted influences the properties of the object and can be
        controlled by the values in this array.  Which value refers to which type of connection
        depends on the macro and is mentioned in the macro description.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_VE_Elements"></a>3.4.5.2. Explanation of the <tt class="function">VE_Elements</tt> parameter</h4></div></div><div></div></div><p xmlns="">
        The <tt class="function">VE_Elements</tt> parameter has to be specified for all macros
        generating viscoelastic connections (see <a href="#mechsim_topo_viscoelastic" title="2.7.4.1.4.4. Viscoelastic connections">Section 2.7.4.1.4.4, &#8220;Viscoelastic connections&#8221;</a>).
      </p><p xmlns="">
        It is a 2d array containing the stiffness and damping values of all the maxwell elements
        of the viscoelastic connections.  The first index specifies the number of the maxwell element
        (and the size of the array sets the number of maxwell elements).  The size of the array
        in the second dimension should be 2 - the first value is the stiffness and the second the damping.
      </p><div xmlns="" class="example"><a name="id2558338"></a><p class="title"><b>Example 3.6. VE_Elements array generation</b></p><p>
          The following code generates a <tt class="function">VE_Elements</tt> array for a viscolastic connection
          with 3 maxwell elements
        </p><pre class="programlisting">#declare VE_Elements1=array[3][2]
				#declare VE_Elements1[0][0]=2000;
				#declare VE_Elements1[0][1]=240000;
				#declare VE_Elements1[1][0]=7000;
				#declare VE_Elements1[1][1]=12000;
				#declare VE_Elements1[2][0]=120000;
				#declare VE_Elements1[2][1]=1600;</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid_Fn"></a>3.4.5.3. MechSim_Generate_Grid_Fn()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2558383"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro04.png" align="right"></div></div><p xmlns="">
        This macro generates 3D rectangular grid of masses with connections and
        optionally faces on the outside.  The density of the masses as well as the
        stiffness and damping of the connections can be varied with functions.
        Additional functions control the fixed and attached masses.
      </p><p xmlns="">
        The generated box starts at the origin and extends in positive x, y and
        z-direction.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">fn_Density</tt> - user defined function controlling the
          density of the masses.  x, y and z are evaluated in [0..1]
          range.
        </p></li><li><p>
          <tt class="function">fn_Stiffness</tt> - user defined function controlling the
          stiffness of the connections.
        </p></li><li><p>
          <tt class="function">fn_Damping</tt> - user defined function controlling the
          damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated on the
          outside shape.
        </p></li><li><p>
          <tt class="function">Cube_Scale</tt> - 3D vector controlling the distances
          in the grid. It defines the size of an elementary cell.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 3D vector containing the number of masses
          in all three directions.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">fn_Fixed</tt> - user defined function controlling whether
          the masses are fixed or not.  x, y and z are evaluated in [0..1].  
          If the function value at a mass position is &gt;0 the mass is fixed.
        </p></li><li><p>
          <tt class="function">fn_Attach</tt> - user defined function controlling
          the mass attachments.  x, y and z are evaluated in [0..1].  
          The function value represents the mass attachment index.
        </p></li><li><p>
          <tt class="function">fn_Force</tt> - user defined function controlling
          the custom forces.  x, y and z are evaluated in [0..1].  
          The function value represents the mass force index.
        </p></li><li><p>
          <tt class="function">Connect_Arr</tt> - Array containing weights for connection
          stiffness and damping.  Meaning of the array fields is described
          below.
        </p></li></ul></div><h5><a name="id2558621"></a>meaning of the 'Connect_Arr' entries:</h5><p xmlns="">
        See also <a href="#mechsim_inc_Connect_Arr" title="3.4.5.1. Explanation of the Connect_Arr parameter">Section 3.4.5.1, &#8220;Explanation of the Connect_Arr parameter&#8221;</a>. If the first
        entry is <tt class="literal">0</tt> no connections are generated.  The individual
        entries are used for the following connections. Only connections up to the
        size of the array are generated.
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="literal">0</tt> - axis-parallel connections.</li><li><tt class="literal">1</tt> - the first diagonal connection in each grid rectangle.</li><li><tt class="literal">2</tt> - the second diagonal connection in each grid rectangle.</li><li><tt class="literal">3</tt> - the 3d diagonal connections.</li></ul></div><p xmlns="">The following pictures illustrate the different sizes of the array:</p><div xmlns="" class="table"><a name="id2558703"></a><p class="title"><b>Table 3.3. MechSim_Show_Patch() variations</b></p><table summary="MechSim_Show_Patch() variations" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/macro05a.png"></div></td><td style="" align="center"><div><img src="img/macro05b.png"></div></td><td style="" align="center"><div><img src="img/macro05c.png"></div></td></tr><tr><td style="" align="center"><span class="emphasis"><em>0 (first element zero)</em></span></td><td style="" align="center"><span class="emphasis"><em>array size 1</em></span></td><td style="" align="center"><span class="emphasis"><em>array size 2</em></span></td></tr><tr><td style="" align="center"><div><img src="img/macro05d.png"></div></td><td style="" align="center"><div><img src="img/macro05e.png"></div></td><td style="" align="center"> </td></tr><tr><td style="" align="center"><span class="emphasis"><em>array size 3</em></span></td><td style="" align="center"><span class="emphasis"><em>array size 4</em></span></td><td style="" align="center"> </td></tr></tbody></table></div><div xmlns="" class="example"><a name="id2558833"></a><p class="title"><b>Example 3.7. MechSim_Generate_Grid_Fn() macro usage</b></p><p>
          generate a 4x4x4 masses grid with double diagonal connections
          and increasing stiffness and damping in x-direction.
        </p><pre class="programlisting">#declare Con_Array=array[3]
#declare Con_Array[0]=1;
#declare Con_Array[1]=1;
#declare Con_Array[2]=1;

#declare fn_Density=function(x, y, z) { 32000 }
#declare fn_Stiffness=function(x, y, z) { 1000 + x*1500 }
#declare fn_Damping=function(x, y, z) { 2000 + x*1500 }
#declare fn_Fixed=function { -1 }
#declare fn_Attach=function { -1 }


MechSim_Generate_Grid_Fn(&lt;0, 0, 0&gt;, 0.08, fn_Density, fn_Stiffness, fn_Damping,
                         true, &lt;0.4, 0.4, 0.4&gt;, &lt;4, 4, 4&gt;, No_Trans, fn_Fixed, fn_Attach, Con_Array)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid_Fn_VE"></a>3.4.5.4. MechSim_Generate_Grid_Fn_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2558881"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Grid_Fn()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">fn_Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid"></a>3.4.5.5. MechSim_Generate_Grid()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2558956"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro04.png" align="right"></div></div><p xmlns="">This macro generates 3D rectangular grid of masses with connections and
        optionally faces on the outside.  In contrast to the
        <tt class="function">MechSim_Generate_Grid_Fn()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Grid_Fn" title="3.4.5.3. MechSim_Generate_Grid_Fn()">Section 3.4.5.3, &#8220;MechSim_Generate_Grid_Fn()&#8221;</a>)
        the density stiffness and damping values are fixed.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated on the
          outside shape.
        </p></li><li><p>
          <tt class="function">Cube_Scale</tt> - 3D vector controlling the distances
          in the grid. It defines the size of an elementary cell.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 3D vector containing the number of masses
          in all three directions.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">Connect_Arr</tt> - Array containing weights for connection
          stiffness and damping.  Meaning of the array fields in described
          in <a href="#mechsim_inc_MechSim_Generate_Grid_Fn" title="3.4.5.3. MechSim_Generate_Grid_Fn()">Section 3.4.5.3, &#8220;MechSim_Generate_Grid_Fn()&#8221;</a>.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2559157"></a><p class="title"><b>Example 3.8. MechSim_Generate_Grid() macro usage</b></p><p>
          generate a 4x4x4 masses grid with double diagonal connections.
        </p><pre class="programlisting">#declare Con_Array=array[3]
#declare Con_Array[0]=1;
#declare Con_Array[1]=1;
#declare Con_Array[2]=1;

MechSim_Generate_Grid(&lt;0, 0, 0&gt;, 0.08, 32000, 1000, 2000,
                      true, &lt;0.4, 0.4, 0.4&gt;, &lt;4, 4, 4&gt;, No_Trans, Con_Array)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid_VE"></a>3.4.5.6. MechSim_Generate_Grid_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559195"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Grid()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid_Std"></a>3.4.5.7. MechSim_Generate_Grid_Std()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559270"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro04.png" align="right"></div></div><p xmlns="">
        This macro generates 3D rectangular grid of masses with connections and
        optionally faces on the outside.  In contrast to the
        <tt class="function">MechSim_Generate_Grid()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Grid" title="3.4.5.5. MechSim_Generate_Grid()">Section 3.4.5.5, &#8220;MechSim_Generate_Grid()&#8221;</a>) all
        connections all have the same stiffness and damping.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated on the
          outside shape.
        </p></li><li><p>
          <tt class="function">Cube_Scale</tt> - 3D vector controlling the distances
          in the grid. It defines the size of an elementary cell.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 3D vector containing the number of masses
          in all three directions.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">Diagonal</tt> - A number controlling which diagonal connections
          are generated in the grid  It corresponds to the array size in
          the <tt class="function">MechSim_Generate_Grid()</tt> macro
          (see <a href="#mechsim_inc_MechSim_Generate_Grid" title="3.4.5.5. MechSim_Generate_Grid()">Section 3.4.5.5, &#8220;MechSim_Generate_Grid()&#8221;</a>).
        </p></li></ul></div><div xmlns="" class="example"><a name="id2559477"></a><p class="title"><b>Example 3.9. MechSim_Generate_Grid_Std() macro usage</b></p><p>
          generate a 4x4x4 masses grid with double diagonal connections.
        </p><pre class="programlisting">MechSim_Generate_Grid_Std(&lt;0, 0, 0&gt;, 0.08, 32000, 1000, 2000,
                          true, &lt;0.4, 0.4, 0.4&gt;, &lt;4, 4, 4&gt;, No_Trans, 3)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Grid_Std_VE"></a>3.4.5.8. MechSim_Generate_Grid_Std_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559515"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Grid_Std()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Box"></a>3.4.5.9. MechSim_Generate_Box()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559590"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro04.png" align="right"></div></div><p xmlns="">
        Variation of the <tt class="function">MechSim_Generate_Grid_Std()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Grid_Std" title="3.4.5.7. MechSim_Generate_Grid_Std()">Section 3.4.5.7, &#8220;MechSim_Generate_Grid_Std()&#8221;</a>)
        where instead of the density of the individual masses the mass of the whole grid
        is given.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Mass</tt> - mass of the whole grid.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated on the
          outside shape.
        </p></li><li><p>
          <tt class="function">Cube_Scale</tt> - 3D vector controlling the distances
          in the grid. It defines the size of an elementary cell.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 3D vector containing the number of masses
          in all three directions.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">Diagonal</tt> - A number controlling which diagonal connections
          are generated in the grid  It corresponds to the array size in
          the <tt class="function">MechSim_Generate_Grid()</tt> macro
          (see <a href="#mechsim_inc_MechSim_Generate_Grid" title="3.4.5.5. MechSim_Generate_Grid()">Section 3.4.5.5, &#8220;MechSim_Generate_Grid()&#8221;</a>).
        </p></li></ul></div><div xmlns="" class="example"><a name="id2559797"></a><p class="title"><b>Example 3.10. MechSim_Generate_Box() macro usage</b></p><p>
          generate a 4x4x4 masses grid with double diagonal connections
          and a total mass of 20 kg.
        </p><pre class="programlisting">MechSim_Generate_Box(&lt;0, 0, 0&gt;, 0.08, 20, 1000, 2000,
                     true, &lt;0.4, 0.4, 0.4&gt;, &lt;4, 4, 4&gt;, No_Trans, 3)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Box_VE"></a>3.4.5.10. MechSim_Generate_Box_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559834"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Box()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Block"></a>3.4.5.11. MechSim_Generate_Block()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2559909"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro04.png" align="right"></div></div><p xmlns="">
        Variation of the <tt class="function">MechSim_Generate_Box()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Box" title="3.4.5.9. MechSim_Generate_Box()">Section 3.4.5.9, &#8220;MechSim_Generate_Box()&#8221;</a>)
        where you specify two corner coordinates like for the <span class="trademark">POV-Ray</span>&#8482; 
        <tt class="function">box{}</tt> shape instead of a <tt class="function">Cube_Scale</tt>
        parameter.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Mass</tt> - mass of the whole grid.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated on the
          outside shape.
        </p></li><li><p>
          <tt class="function">Start, End</tt> - Corner coordinates of the whole grid.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 3D vector containing the number of masses
          in all three directions.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">Diagonal</tt> - A number controlling which diagonal connections
          are generated in the grid  It corresponds to the array size in
          the <tt class="function">MechSim_Generate_Grid()</tt> macro
          (see <a href="#mechsim_inc_MechSim_Generate_Grid" title="3.4.5.5. MechSim_Generate_Grid()">Section 3.4.5.5, &#8220;MechSim_Generate_Grid()&#8221;</a>).
        </p></li></ul></div><div xmlns="" class="example"><a name="id2560134"></a><p class="title"><b>Example 3.11. MechSim_Generate_Block() macro usage</b></p><p>
          generate a unit size 4x4x4 masses grid with double diagonal connections
          and a total mass of 20 kg.
        </p><pre class="programlisting">MechSim_Generate_Block(&lt;0, 0, 0&gt;, 0.08, 20, 1000, 2000,
                       true, &lt;0, 0, 0&gt;, &lt;1, 1, 1&gt;, &lt;4, 4, 4&gt;, No_Trans, 3)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Block_VE"></a>3.4.5.12. MechSim_Generate_Block_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2560173"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Block()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Patch"></a>3.4.5.13. MechSim_Generate_Patch()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2560248"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro06.png" align="right"></div></div><p xmlns="">
        This macro generates a rectangular patch of masses with connections and
        optionally faces forming the surface.  The masses can be fixed with help of
        a function
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated for
          the surface of the patch.
        </p></li><li><p>
          <tt class="function">Rect_Scale</tt> - 2D vector controlling the distances
          in the grid. It defines the size of an elementary rectangle.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 2D vector containing the number of masses
          in x and y direction.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">fn_Fixed</tt> - user defined function controlling whether
          the masses are fixed or not.  The function is evaluated in
          the x-y-plane between 0 and 1.  If the function value at a mass
          position is &gt;0 the mass is fixed.
        </p></li><li><p>
          <tt class="function">fn_Attach</tt> - user defined function controlling the attachments
          of the masses.  The function is evaluated in
          the x-y-plane between 0 and 1.  The function value sets the attachment index.
        </p></li><li><p>
          <tt class="function">Connect_Arr</tt> - Array containing weights for connection
          stiffness and damping.  Meaning of the array fields in described
          below.
        </p></li></ul></div><h5><a name="id2560460"></a>meaning of the 'Connect_Arr' entries:</h5><p xmlns="">
        See also <a href="#mechsim_inc_Connect_Arr" title="3.4.5.1. Explanation of the Connect_Arr parameter">Section 3.4.5.1, &#8220;Explanation of the Connect_Arr parameter&#8221;</a>. The
        following picture shows which entries in the array weight which connections. Only
        connections up to the size of the array are generated.
      </p><div xmlns="" class="figure"><a name="id2560478"></a><p class="title"><b>Figure 3.1. patch connection numbers</b></p><div><img src="img/patch01.png" alt="patch connection numbers"></div></div><div xmlns="" class="example"><a name="id2560495"></a><p class="title"><b>Example 3.12. MechSim_Generate_Patch() macro usage</b></p><p>
          generate a 50x50 patch with bending and shearing stiffness.
          No masses are fixed.
        </p><pre class="programlisting">#declare fn_Fixed=function { -1 }
#declare fn_Attach=function { -1 }
#declare Con_Array=array[3]
#declare Con_Array[0]=1;
#declare Con_Array[1]=1;
#declare Con_Array[2]=1;

MechSim_Generate_Patch(&lt;0, 0, 0&gt;, 0.065, 8000, 10000, 0,
                       true, &lt;0.055, 0.055&gt;, &lt;50, 50&gt;, No_Trans, fn_Fixed, fn_Attach, Con_Array)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Patch_VE"></a>3.4.5.14. MechSim_Generate_Patch_VE()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2560537"></a><p xmlns="">
        Variant of <tt class="function">MechSim_Generate_Patch()</tt> generating viscoelastic 
        connections instead of normal connections.  Parameters are the same but instead of
        <tt class="function">Damping</tt> there are the following:
      </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
          <tt class="function">VE_Elements</tt> - array with the parameters for viscoelastic connections
          (see above for description).
        </p></li><li><p>
          <tt class="function">VE_Accuracy</tt> - accuracy value for viscoelastic connections.
        </p></li></ul></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Patch_Std"></a>3.4.5.15. MechSim_Generate_Patch_Std()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2560612"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro06.png" align="right"></div></div><p xmlns="">
        This macro generates a rectangular patch of masses with connections and
        optionally faces forming the surface.  In contrast to the
        <tt class="function">MechSim_Generate_Patch()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Patch" title="3.4.5.13. MechSim_Generate_Patch()">Section 3.4.5.13, &#8220;MechSim_Generate_Patch()&#8221;</a>) all
        connections all have the same stiffness and damping.  Also none of the masses
        is fixed.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - if <tt class="function">true</tt> faces are generated for
          the surface of the patch.
        </p></li><li><p>
          <tt class="function">Rect_Scale</tt> - 2D vector controlling the distances
          in the grid. It defines the size of an elementary rectangle.
        </p></li><li><p>
          <tt class="function">Grid_Size</tt> - 2D vector containing the number of masses
          in x and y direction.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">Connect</tt> - A number controlling which connections
          are generated in the grid  It corresponds to the array size in
          the <tt class="function">MechSim_Generate_Patch()</tt> macro
          (see <a href="#mechsim_inc_MechSim_Generate_Patch" title="3.4.5.13. MechSim_Generate_Patch()">Section 3.4.5.13, &#8220;MechSim_Generate_Patch()&#8221;</a>).
        </p></li></ul></div><div xmlns="" class="example"><a name="id2560820"></a><p class="title"><b>Example 3.13. MechSim_Generate_Patch_Std() macro usage</b></p><p>
          generate a 50x50 with bending and shearing stiffness.
        </p><pre class="programlisting">MechSim_Generate_Patch_Std(&lt;0, 0, 0&gt;, 0.065, 8000, 10000, 0,
                           true, &lt;0.055, 0.055&gt;, &lt;50, 50&gt;, No_Trans, 3)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Line"></a>3.4.5.16. MechSim_Generate_Line()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2560858"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro07.png" align="right"></div></div><p xmlns="">
        This macro generates a line of connected masses and can be used for
        simulating things like ropes, chains, etc.  The masses of the line can be
        fixed with help of a function
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Spacing</tt> - distance between two neighboring masses.
        </p></li><li><p>
          <tt class="function">Count</tt> - total number of masses.
        </p></li><li><p>
          <tt class="function">Direction</tt> - 3D vector defining the direction of the line
          from the origin.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li><li><p>
          <tt class="function">fn_Fixed</tt> - user defined function controlling whether
          the masses are fixed or not.  The function is evaluated in
          the x-direction between 0 and 1.  If the function value at a mass
          position is &gt;0 the mass is fixed.
        </p></li><li><p>
          <tt class="function">Connect_Arr</tt> - Array containing weights for connection
          stiffness and damping.  Meaning of the array fields in described
          below.
        </p></li></ul></div><h5><a name="id2561047"></a>meaning of the 'Connect_Arr' entries:</h5><p xmlns="">
        See also <a href="#mechsim_inc_Connect_Arr" title="3.4.5.1. Explanation of the Connect_Arr parameter">Section 3.4.5.1, &#8220;Explanation of the Connect_Arr parameter&#8221;</a>. The
        first element of the array weights the direct connections between two neighboring
        masses.  Further values in the array weight the more distant connections that
        introduce bending stiffness to the line.  Only connections up to the size of the
        array are generated.
      </p><div xmlns="" class="example"><a name="id2561068"></a><p class="title"><b>Example 3.14. MechSim_Generate_Line() macro usage</b></p><p>
          generate a 10 masses line with bending stiffness.
          No masses are fixed.
        </p><pre class="programlisting">#declare fn_Fixed=function { -1 }
#declare Con_Array=array[2]
#declare Con_Array[0]=1;
#declare Con_Array[1]=1;

MechSim_Generate_Line(&lt;0, 0, 0&gt;, 0.09, 8000, 10000, 0,
                      0.45, 10, &lt;1, 1, 1&gt;, No_Trans, fn_Fixed, Con_Array)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Line_Std"></a>3.4.5.17. MechSim_Generate_Line_Std()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2561107"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro07.png" align="right"></div></div><p xmlns="">
        This macro generates a line of connected masses and can be used for
        simulating things like ropes, chains, etc..  In contrast to the
        <tt class="function">MechSim_Generate_Line()</tt> macro
        (see <a href="#mechsim_inc_MechSim_Generate_Line" title="3.4.5.16. MechSim_Generate_Line()">Section 3.4.5.16, &#8220;MechSim_Generate_Line()&#8221;</a>)  only
        shortest distance connections are generated.  Also none of the masses
        is fixed.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the connections.
        </p></li><li><p>
          <tt class="function">Spacing</tt> - distance between two neighboring masses.
        </p></li><li><p>
          <tt class="function">Count</tt> - total number of masses.
        </p></li><li><p>
          <tt class="function">Direction</tt> - 3D vector defining the direction of the line
          from the origin.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2561279"></a><p class="title"><b>Example 3.15. MechSim_Generate_Line() macro usage</b></p><p>
           generate a 10 masses line.
        </p><pre class="programlisting">MechSim_Generate_Line(&lt;0, 0, 0&gt;, 0.09, 8000, 10000, 0,
                      0.45, 10, &lt;1, 1, 1&gt;, No_Trans)</pre></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_inc_MechSim_Generate_Sphere"></a>3.4.5.18. MechSim_Generate_Sphere()</h4></div></div><div></div></div><a xmlns="" class="indexterm" name="id2561316"></a><div xmlns="" class="informalfigure"><div align="right"><img src="img/macro12.png" align="right"></div></div><p xmlns="">
        This macro generates a sphere shaped grid of connected masses with
        an additional mass in the center and all surface masses connected to it.
        This shape can be used for simulating balls that rotate realistically
        and can deform as well.  The masses are generated by subdividing an
        icosahedron.
      </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><p>
          <tt class="function">Velocity</tt> - vector defining the starting velocity
          of all masses.
        </p></li><li><p>
          <tt class="function">Radius</tt> - radius of all masses.
        </p></li><li><p>
          <tt class="function">Density</tt> - density of the surface masses.
        </p></li><li><p>
          <tt class="function">Stiffness</tt> - stiffness of the surface connections.
        </p></li><li><p>
          <tt class="function">Damping</tt> - damping of the surface connections.
        </p></li><li><p>
          <tt class="function">Density2</tt> - density of the center mass.
        </p></li><li><p>
          <tt class="function">Stiffness2</tt> - stiffness of the center connections.
        </p></li><li><p>
          <tt class="function">Damping2</tt> - damping of the center connections.
        </p></li><li><p>
          <tt class="function">Faces</tt> - Generate faces on the surface?
        </p></li><li><p>
          <tt class="function">Division</tt> - Icosahedron subdivision depth.
        </p></li><li><p>
          <tt class="function">BRadius</tt> - radius of the whole ball.
        </p></li><li><p>
          <tt class="function">Transf</tt> - Transform to be applied to all mass positions.
        </p></li></ul></div><div xmlns="" class="example"><a name="id2561512"></a><p class="title"><b>Example 3.16. MechSim_Generate_Sphere() macro usage</b></p><p>
          generate a sphere with 43 masses with surface faces.
        </p><pre class="programlisting">MechSim_Generate_Sphere(&lt;0, 0, 0&gt;, 0.08, 32000, 1600, 2000, 32000, 1600, 2000, true, 1, 0.9, No_Trans)</pre></div></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="inc_pprocess.inc"></a>3.5. The '<tt class="filename">pprocess.inc</tt>' include file</h2></div><div><div class="author"><h3 class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></h3></div></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="post_proc_macros"></a>3.5.1. Macros with effects</h3></div></div><div></div></div><p xmlns="">
      Because using functions is not equally easy to every user, some predefined post processing
      effects can be used in the form of macros with user-friendly syntax (like every other
      functionality of the <span class="trademark">POV-Ray</span>&#8482;).
    </p><p xmlns="">
      To use these macros with post process effects, the include file <tt class="filename">pprocess.inc</tt>
      must be included. Several of these macros have a syntax similar to the old MegaPOV post process, so
      they may be familiar to you.
    </p><p xmlns="">
      Following macros are available to the user:
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="post_proc_clipping"></a>3.5.1.1. Clipping colors</h4></div></div><div></div></div><p xmlns="">
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> { PP_Clip_Colors(color_min,color_max) }</pre><p xmlns="">
        Clips all colors in the image to the range color_min and color_max
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="pp_color_matrix"></a>3.5.1.2. Color matrix</h4></div></div><div></div></div><p xmlns="">
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> { PP_Color_Matrix(Array) }
      
// Runs the color through a 3*3 matrix expressed in Array.
// The equation is:
// R = r*AA + g*AB + b*AC
// G = r*BA + g*BB + b*BC
// B = r*CA + g*CB + b*CC
// and Array means
// array[9]{AA, AB, AC, BA, BB, BC, CA, CB, CC}</pre><p xmlns="">
        Combination of colors.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="pp_convolution_matrix"></a>3.5.1.3. Convolution matrix</h4></div></div><div></div></div><p xmlns="">
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> { PP_Convolution_Matrix(XDim,YDim,Divisor,Leveling,Matrix) }</pre><p xmlns="">
        Multiplies the pixel and the adjacent pixels (in the area defined by the matrix size)
        by the respective values in the matrix, adds the results together and divides by Divisor to 
        get an average color. A leveling value can be added in before the final division.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="pp_depth"></a>3.5.1.4. Depth</h4></div></div><div></div></div><p xmlns="">
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> { PP_Depth(Field_Start,Field_Depth) }</pre><p xmlns="">
        The image is converted to a gray-scale image with the gray-value of the pixel depending
        of the depth location in the scene.
      </p><p xmlns="">
        Field_Start specifies the beginning of the focal range in units from the camera.
      </p><p xmlns="">
        Field_Depth specifies the length of the focal range.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="pp_find_edges"></a>3.5.1.5. Finding edges</h4></div></div><div></div></div><p xmlns="">
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> {
  PP_Find_Edges(Depth_Thresh,Normal_Thresh,Color_Thresh,Line_Radius,Sharpness,Pigment)
}</pre><p xmlns="">
        This post process effect finds the edges in an image using depth, normal, and color information.
        Separate thresholds are specified for each of the three methods of edge detection.
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>Depth_Thresh: range: 0 to infinity. An edge is detected if the difference of
          depth (of the first intersection) in two consecutive pixels exceeds this value.</li><li>Normal_Thresh: range: 0 to 1. Zero represents normal vectors pointing in
          the same direction, 0.5 means a 90 degree difference, and 1.0 means the normal vectors point
          in opposite directions.</li><li>Color_Thresh: range: 0 to 1. Zero means no color difference, 1 means the
          opposite color. The color channels (red, green, and blue) are differenced separately and
          the results are averaged to produce the final difference.</li></ul></div><p xmlns="">
      </p><p xmlns="">
        The width of the lines is controlled by the "Line_Radius" parameter.
      </p><p xmlns="">
         The sharpness of the lines is controlled by the "Sharpness" parameter. A
         sharpness of 1.0 yields nicely anti-aliased lines. A sharpness value of 0.0 leads to blurry
         lines when larger radii are used, and a sharpness value of greater than 1.0 begins to remove
         anti-aliasing from the lines.
      </p><p xmlns="">
         The color of the line is controlled by the pigment specified. This pigment is evaluated over
         the range of &lt;x,y&gt; = &lt;0,0&gt; ... &lt;1,1&gt; (with z=0) over the full size of the image.
         Using solid  colors is usually a good idea, unless special effects are desired.
      </p><div xmlns="" class="example"><a name="id2567694"></a><p class="title"><b>Example 3.17. Find edge macro</b></p><pre class="programlisting">PP_Find_Edges( 1.0, 0.3, 0.15, 2, 1.0, rgb 0 )</pre></div><p xmlns="">
         Finds edges wherever there is a depth difference greater than 1.0, a normal difference greater
         than  0.3 (about 60 degrees), or a color difference of 0.15. It uses a line radius of 2.0, with
         black (rgb 0) antialiased (sharpness 1.0) lines.
      </p><p xmlns="">
        The PP_Find_Edges macro is a straight implementation of the functionality of the effect available
        in previous versions of MegaPOV. In fact this macro is a wrapper to the more functional
        macro PP_Find_Edges_Back():
        </p><pre xmlns="" class="synopsis"><tt class="function">post_process</tt> {
  PP_Find_Edges_Back(
    Depth_Thresh,Normal_Thresh,Color_Thresh,Line_Radius,Sharpness,Pigment,
    Background,Background_Filter,Width,Height
  )
}</pre><p xmlns="">
        This macro adds four more parameters:
      </p><p xmlns="">
        Background: a pigment as replacement to be placed between edges instead of the original rendering.
      </p><p xmlns="">
        Background_Filter: pigment with a filter value for weighting between the "Background"
        parameter and the "Pigment" parameter.
      </p><p xmlns="">
        Width,Height: the image sizes to make the parameter "Line_Radius" relative to the image area.
        It is usually <tt class="function">image_width</tt> and <tt class="function">image_height</tt> but can be something different in case
        somebody wants a special effect like larger rectangles instead of lines.
      </p></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="shared_effects"></a>3.5.2. Shared predefined effects</h3></div></div><div></div></div><p xmlns="">
      Macros mentioned in earlier sections are prefixed with 'PP_' on purpose.
      Include file <tt xmlns="" class="filename">pprocess.inc</tt> for those macros with respective equivalents
      for camera_view and referenced post processing. For example:
      </p><pre xmlns="" class="programlisting">// create clipping effect of the rendering output
<tt class="function">post_process</tt> { PP_Clip_Colors(COLOR_MIN,COLOR_MAX) }

// create clipping effect of another post processing stage
<tt class="function">post_process</tt> { PP_Clip_Colors_Ref(Nth,COLOR_MIN,COLOR_MAX) }

// create clipping effect of another camera output
<tt class="function">post_process</tt> { PP_Clip_Colors_Cam(CAMERA,COLOR_MIN,COLOR_MAX) }

// create a pigment with clipping of the other camera output
<tt class="function">#declare</tt> Pigment = Pig_Clip_Colors_Cam(CAMERA,COLOR_MIN,COLOR_MAX) }</pre><p xmlns="">
    </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tone_mapping.inc"></a>3.6. The '<tt class="filename">tone_mapping.inc</tt>' include file</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
    This part describes the <tt class="filename">tone_mapping.inc</tt>
    include file that comes with MegaPOV and contains
    macros for common tone mapping functions.
  </p><p xmlns="">
    For how the tone mapping patch works in general see <a xmlns="" href="#tone_mapping" title="2.7.2. Custom tone mapping function">Section 2.7.2, &#8220;Custom tone mapping function&#8221;</a>.
    The macros are supposed to be called in <tt xmlns="" class="function">global_settings</tt>{}.  Like:
    </p><pre xmlns="" class="programlisting"><tt class="function">#include</tt> "<tt class="filename">tone_mapping.inc</tt>"

<tt class="function">global_settings</tt> { 
  Clip_Colors() 
}</pre><p xmlns="">
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2567246"></a>3.6.1. The <tt class="function">Clip_Colors()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2568401"></a><p xmlns="">
      This macro applies a hard clipping of color values at 
      <tt class="function">1.0</tt> before antialiasing.  Using this results
      in the <span class="trademark">POV-Ray</span>&#8482; 3.5 behavior.
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2568434"></a>3.6.2. The <tt class="function">Film_Exposure()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2568447"></a><p xmlns="">
      This macro generates the same function that is used in the 
      film exposure simulation patch (see <a href="#film_exposure" title="2.7.1. Film exposure simulation">Section 2.7.1, &#8220;Film exposure simulation&#8221;</a>).
    </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><tt class="function">Exposure</tt> - exponent for the exposure curve</li><li><tt class="function">Exposure_Gain</tt> - gain for the exposure curve</li></ul></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2568502"></a>3.6.3. The <tt class="function">Film_Exposure_Invert()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2568517"></a><p xmlns="">
      This macro generates a film exposure tone mapping curve and the inversion of it.
      This results in a linear output like without tone mapping but the antialiasing is applied for
      the exponential mapping function.
    </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><tt class="function">Exposure</tt> - exponent for the exposure curve</li><li><tt class="function">Exposure_Gain</tt> - gain for the exposure curve</li></ul></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2568567"></a>3.6.4. The <tt class="function">Gamma_Correct()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2568580"></a><p xmlns="">
      This macro generates a gamma correction function.
    </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><tt class="function">Gamma</tt> - gamma correction factor</li></ul></div><div xmlns="" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="icons/note.gif"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        It is not a good idea to use this as a replacement for
        the internal gamma correction to do actual gamma correction.
        It may however be useful for scenes that are designed for being 
        rendered without gamma correction (like for example certain
        older POV-Ray sample scenes). 
      </p></td></tr></table></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2568630"></a>3.6.5. The <tt class="function">Brightness_Contrast()</tt> macro</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2568643"></a><p xmlns="">
      This macro generates a function that applies brightness and contrast corrections to the image. 
      These are linear operations so they won't affect the antialiasing quality.
    </p><div xmlns="" class="itemizedlist"><p class="title"><b>parameters:</b></p><ul type="disc"><li><tt class="function">Brightness</tt> - brightness adjustment</li><li><tt class="function">Contrast</tt> - contrast adjustment</li></ul></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="tutorials"></a>Chapter 4. Tutorials</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#tutorials_objects">4.1. Objects</a></span></dt><dd><dl><dt><span class="section"><a href="#id2573903">4.1.1. Cloth simulation</a></span></dt></dl></dd><dt><span class="section"><a href="#tutorials_simulation">4.2. Simulation</a></span></dt><dd><dl><dt><span class="section"><a href="#mechsim_tutorial">4.2.1. Mechanics simulation tutorial</a></span></dt></dl></dd><dt><span class="section"><a href="#tutorials_hdri">4.3. HDRI (High dynamic range illumination)</a></span></dt><dd><dl><dt><span class="section"><a href="#hdri_tutorial">4.3.1. HDRI tutorial</a></span></dt></dl></dd></dl></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tutorials_objects"></a>4.1. Objects</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2573903"></a>4.1.1. Cloth simulation</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="tablecloth"></a>4.1.1.1. Simulating a tablecloth</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christophe</span> <span class="surname">Bouffartigue</span></h3></div></div></div><div></div></div><p xmlns="">
    Before launching the simulation, it is initially necessary to create the starting *.cth file. It will contain a
    fresh cloth with the desired dimensions, normalized distances between points and strength coefficient of the springs
    connecting the points.
  </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="writecloth"></a>4.1.1.1.1. Writing a *.cth file</h5></div></div><div></div></div><p xmlns="">
    The *.cth format was defined in such manner that it is able to be read and written using the <span xmlns="" class="trademark">POV-Ray</span>&#8482;'s input/output
    files directives (<tt xmlns="" class="function">#fopen</tt>, <tt xmlns="" class="function">#read</tt>, <tt xmlns="" class="function">#write</tt>, <tt xmlns="" class="function">#fclose</tt>). One thus will write the following macro:
    </p><pre xmlns="" class="programlisting"><tt class="function">#macro</tt> WriteClothFile(filename, n1, n2, nlng, ks, ht)
  <tt class="function">#debug</tt> "\nWriting new cth file\n"
  <tt class="function">#fopen</tt> file filename write
  <tt class="function">#write</tt>(file, n1, ", ", n2, ", ", nlng, ", ", ks, ",\n";)
  <tt class="function">#local</tt> l1 = nlng*(n1-1);
  <tt class="function">#local</tt> l2 = nlng*(n2-1);
  <tt class="function">#local</tt> st = seed(1234);
  <tt class="function">#local</tt> i=0;
  <tt class="function">#while</tt> (i &lt; n1)
    <tt class="function">#local</tt> j=0;
    <tt class="function">#while</tt> (j &lt; n2)
      <tt class="function">#local</tt> tempx = -l1/2 + i*nlng;
      <tt class="function">#local</tt> tempz = -l2/2 + j*nlng;
      <tt class="function">#local</tt> tempy = ht + (-1+2*rand(st))*nlng*0.1;
      <tt class="function">#write</tt>(file, tempx, ",", tempy, ",", tempz, ", 0.0, 0.0, 0.0,\n")
      <tt class="function">#set</tt> j=j+1;
    <tt class="function">#end</tt>
    <tt class="function">#set</tt> i=i+1;
  <tt class="function">#end</tt>
  <tt class="function">#fclose</tt> file
<tt class="function">#end</tt></pre><p xmlns="">
    After having opened the file (<tt xmlns="" class="function">#fopen</tt>), the macro writes the first line (<tt xmlns="" class="function">#write</tt>) which contains the number of
    points of the cloth patch in two dimensions (n1, n2), the normal distance between all points (nlng), and the
    strength coefficient of the springs (ks).
  </p><p xmlns="">
    Then, the various points are distributed in a rectangle of dimension (nlng*(n1-1)) on (nlng*(n2-1)), parallel
    with the (xz) plane, and at height ht, centered around y axis. A small amount of noise is added to each point
    coordinates (rand()). Don't forget to close the file (#fclose)... 
  </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2576544"></a>4.1.1.1.2. A tablecloth goes on a table ...</h5></div></div><div></div></div><p xmlns="">
      So we will define a simple table: 
    </p><pre xmlns="" class="programlisting"><tt class="function">#declare</tt> Table =
  <tt class="function">union</tt> {
    <tt class="function">cylinder</tt> { 8*y, 9*y, 8 }
    <tt class="function">torus</tt> { 8, 05 <tt class="function">sturm</tt> <tt class="function">translate</tt> 85*y }
    <tt class="function">cylinder</tt> { 85*y, 0, 05 }
    <tt class="function">cylinder</tt> { 0, 05*y, 4 }
  }</pre><p xmlns="">
    </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2576612"></a>4.1.1.1.3. Visualize the starting position of the fabric</h5></div></div><div></div></div><p xmlns="">
      To check that the simulation does not begin with part of the fabric IN the table, we can create the mesh Nappe,
      using 0 iterations in simcloth: 
      </p><pre xmlns="" class="programlisting">WriteClothFile("nappe.cth", 50, 50, 1.8/50, 10, 0.95)

<tt class="function">simcloth</tt> {
  <tt class="function">iterations</tt> 0
  <tt class="function">input</tt> "nappe.cth"
  <tt class="function">mesh_output</tt> "nappe.msh"
  <tt class="function">uv_mesh</tt> <tt class="function">on</tt>
}

<tt class="function">#declare</tt> Nappe =
  <tt class="function">mesh</tt> {
    <tt class="function">#include</tt> "nappe.msh"
    <tt class="function">uv_mapping</tt>
    <tt class="function">texture</tt> {
      <tt class="function">pigment</tt> {
        <tt class="function">checker</tt> <tt class="function">color</tt> <tt class="function">rgb</tt> &lt;1, 0.5, 0.2&gt; <tt class="function">color</tt> <tt class="function">rgb</tt> &lt;1, 0.8, 0.4&gt;
        <tt class="function">scale</tt> &lt;1/10, 1/10, 1/10&gt;
      }
    }
  }</pre><p xmlns="">
      Then, the ground, the walls, a light source, a camera, are added, and we obtain this:
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_nappe01.jpg"></div></div><p xmlns="">
     </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2576778"></a>4.1.1.1.4. Darling !!! Put the tablecloth on the table !!!</h5></div></div><div></div></div><p xmlns="">
      And for that, nothing better than the gravity (-0.4*y). Moreover, the table is rough (and the fabric also),
      one thus will put the coefficient of friction at 0 (high frictions). As the distance between each point is
      rather small, one will also take a rather small time interval between each iteration (0.03). 
	</p><pre xmlns="" class="synopsis"><tt class="function">simcloth</tt> {
  <tt class="function">environment</tt> Table
  <tt class="function">friction</tt> 0
  <tt class="function">gravity</tt> -0.4*y,
  <tt class="function">damping</tt> 0.9,
  <tt class="function">intervals</tt> 0.03
  <tt class="function">iterations</tt> 50
  <tt class="function">input</tt> "nappe.cth"
  <tt class="function">output</tt> "nappe.cth"
  <tt class="function">mesh_output</tt> "nappe.msh"
  <tt class="function">smooth_mesh</tt> <tt class="function">on</tt>
  <tt class="function">uv_mesh</tt> <tt class="function">on</tt>
}</pre><p xmlns="">
      Don't forget to look at the messages window (in Windows &amp; Mac version) or output stream (in UNIX version),
      to know if the simulation ended OK or not (in case of problems while opening files, lack of memory, etc...). 
    </p><p xmlns="">
      The starting *.cth file can be calculated only once. By putting the WriteClothFile(...) macro in comments thereafter
      - or make it conditional for clock off: <tt class="function">#if</tt>(<tt class="function">clock_on</tt>=<tt class="function">off</tt>) macro <tt class="function">#end</tt> - , each simulation
      will begin again where the preceding one was stopped. 
    </p><p xmlns="">
      In order to avoid coincident surfaces, you can reduce very slightly the dimensions of the table,
      and level up the tablecloth a little... 
      </p><pre xmlns="" class="programlisting"><tt class="function">object</tt> { Nappe <tt class="function">translate</tt> 0.001*y }
<tt class="function">object</tt> {
  Table <tt class="function">scale</tt> &lt;0.98, 1, 0.98&gt;
  <tt class="function">texture</tt> { T_Wood23 <tt class="function">rotate</tt> &lt;10, 20, 0&gt; }
}</pre><p xmlns="">
      For those who are as I am (i.e. lazy), a complete script is available: <a xmlns="" href="nappe.pov" target="_top"><tt class="filename">nappe.pov</tt></a>
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_nappe02.jpg"></div></div><p xmlns="">
     </p><p xmlns="">
       After 50 iterations ...
     </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_nappe03.jpg"></div></div><p xmlns="">
     </p><p xmlns="">
       ... 50 additional iterations ...
     </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_nappe04.jpg"></div></div><p xmlns="">
     </p><p xmlns="">
       ... and 100 more.
     </p></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="drapecube"></a>4.1.1.2. Simulating a drape falling on a cube</h4></div><div><div class="author"><h3 class="author"><span class="firstname">Christophe</span> <span class="surname">Bouffartigue</span></h3></div></div></div><div></div></div><p xmlns="">
    The difficulty in making a good-looking lying cloth is to well position the fabric at the beginning, and to make
    it so that it tends to gather in a smaller zone than its dimensions.
  </p><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2575787"></a>4.1.1.2.1. Environment</h5></div></div><div></div></div><p xmlns="">
      Once more, we will make it easy: a cube (with rounded edges), lying on the ground:
      </p><pre xmlns="" class="programlisting"><tt class="function">#declare</tt> R = 1;
<tt class="function">#declare</tt> Cube =
  <tt class="function">union</tt> {
    <tt class="function">box</tt> { &lt;R, 0, R&gt;, &lt;1-R, 1, 1-R&gt; }
    <tt class="function">box</tt> { &lt;R, 0, 0&gt;, &lt;1-R, 1-R, 1&gt; }
    <tt class="function">box</tt> { &lt;0, 0, R&gt;, &lt;1, 1-R, 1-R&gt; }
    <tt class="function">cylinder</tt> { &lt;R, 0, R&gt;,  &lt;R, 1-R, R&gt;, R }
    <tt class="function">cylinder</tt> { &lt;R, 0, 1-R&gt;,  &lt;R, 1-R, 1-R&gt;, R }
    <tt class="function">cylinder</tt> { &lt;1-R, 0, R&gt;,  &lt;1-R, 1-R, R&gt;, R }
    <tt class="function">cylinder</tt> { &lt;1-R, 0, 1-R&gt;,  &lt;1-R, 1-R, 1-R&gt;, R }
    <tt class="function">sphere</tt> { &lt;R, 1-R, R&gt;, R }
    <tt class="function">sphere</tt> { &lt;R, 1-R, 1-R&gt;, R }
    <tt class="function">sphere</tt> { &lt;1-R, 1-R, R&gt;, R }
    <tt class="function">sphere</tt> { &lt;1-R, 1-R, 1-R&gt;, R }
    <tt class="function">translate</tt> -0.02*x
  }

<tt class="function">#declare</tt> Obstacle =
  <tt class="function">union</tt> {
    <tt class="function">plane</tt> { y, 0 }
    <tt class="function">object</tt> { Cube }
  }</pre><p xmlns="">
  </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2578030"></a>4.1.1.2.2. First test</h5></div></div><div></div></div><p xmlns="">
      We will reuse the <tt class="function">WriteClothFile(...)</tt> macro from the preceding example, and we will create
      a rectangular cloth patch (30 X 50 points):
    </p><p xmlns="">
      </p><pre xmlns="" class="programlisting"><tt class="function">WriteClothFile("drape.cth", 30, 50, 2/50, 20, 1.5)</tt>
<tt class="function">simcloth</tt> {
  <tt class="function">environment</tt> Obstacle
  <tt class="function">friction</tt> 0
  <tt class="function">gravity</tt> -.5*y
  <tt class="function">damping</tt> 0.9
  <tt class="function">intervals</tt> 0.03
  <tt class="function">iterations</tt> 200
  <tt class="function">input</tt> "drape.cth"
  <tt class="function">mesh_output</tt> "drape.msh"
  <tt class="function">smooth_mesh</tt> <tt class="function">on</tt>
  <tt class="function">uv_mesh</tt> <tt class="function">on</tt>
}

<tt class="function">#declare</tt> Drap =
  <tt class="function">mesh</tt> {
    <tt class="function">#include</tt> "drape.msh"
    <tt class="function">uv_mapping</tt>
    <tt class="function">texture</tt> {
      <tt class="function">pigment</tt> {
        <tt class="function">checker</tt> <tt class="function">color</tt> <tt class="function">rgb</tt> &lt;1, 0.5, 0.2&gt; <tt class="function">color</tt> <tt class="function">rgb</tt> &lt;1, 0.8, 0.4&gt;
        <tt class="function">scale</tt> &lt;1/10, 3/50, 1&gt;
      }
    }
  }</pre><p xmlns="">
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_drape01.jpg"></div></div><p xmlns="">
    </p><p xmlns="">
      Well... hu... good, but it is not what is called pretty good-looking lying cloth (this one is rather banal...)
    </p></div><div class="section_4" lang="en"><div xmlns="" class="titlepage"><div><div><h5 class="title"><a name="id2578256"></a>4.1.1.2.3. Starting position of the cloth</h5></div></div><div></div></div><p xmlns="">
      Let's modify the positioning of each point of the cloth, in the macro <tt xmlns="" class="function">WriteClothFile(...)</tt>, by
      carrying out a rotation of -60 degrees around axis Z, and slightly translating it towards the right, like this:
      </p><pre xmlns="" class="programlisting"><tt class="function">#local</tt> tempx = -l1/2 + i*nlng;
<tt class="function">#local</tt> tempz = -l2/2 + j*nlng;
<tt class="function">#local</tt> vtemp = ;
<tt class="function">#local</tt> vtemp = <tt class="function">vaxis_rotate</tt>(vtemp, z, -60);
<tt class="function">#local</tt> tempy = ht + (-1+2*rand(st))*nlng*0.1;
<tt class="function">#local</tt> vtemp = vtemp + tempy*y + .2*x;
<tt class="function">#write</tt>(file, vtemp.x, ",", vtemp.y, ",", vtemp.z, ", 0.0, 0.0, 0.0,\n")</pre><p xmlns="">
    One does not forget "to level up" the cloth, and the starting position can be visualized:
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_drape02.jpg"></div></div><p xmlns="">
    </p><p xmlns="">
      And finally, let the nature... well, MegaPOV ... do its job:</p><div xmlns="" class="literallayout"><p><br>
</p></div><p xmlns="">
      For the lazy ones, there is a complete script: drape.pov
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_drape03.jpg"></div></div><p xmlns="">
    </p><p xmlns="">
      The fabric starts lying...
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_drape04.jpg"></div></div><p xmlns="">
    </p><p xmlns="">
      Some iterations further... 
    </p><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tut_drape05.jpg"></div></div><p xmlns="">
    </p><p xmlns="">
      ... and the result.
    </p><p xmlns="">
      Obviously, the absence of internal test of collision (fabric against fabric) causes some "errors" (see in bottom
      of cloth)... . But, one can nevertheless obtain more or less satisfactory results. 
    </p></div></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tutorials_simulation"></a>4.2. Simulation</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mechsim_tutorial"></a>4.2.1. Mechanics simulation tutorial</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
    This part of the MegaPOV documentation gives
    a short practical introduction into using
    the mechanics simulation patch and describes
    some simple simulations step by step.
  </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_mass"></a>4.2.1.1. mass movement</h4></div></div><div></div></div><p xmlns="">
      The simplest thing that can be simulated with the mechanics simulation patch
      is the movement
      of individual point masses.  Their movement under the influence of gravity
      and environment objects is handled in this part.
    </p><p xmlns="">We start with a simple scene setup:</p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial01.pov" target="_top"><tt class="filename">tutorial01.pov</tt></a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial01.png"></div></div><p xmlns="">
    </p><p xmlns="">
      To simulate the movement of a single mass we add the following to the
      <tt class="function">global_settings{}</tt>:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">mechsim {		
  gravity &lt;0, 0, -9.81&gt;
  method 1

  environment {
    object plane { z, 0 }
    damping 0.9
    friction 0.1
    method 2
  }

  time_step (1/30)/300
  step_count 300
		
  #if (frame_number=1)
    topology {
      mass { &lt;-2.8, -8.0, 0.9&gt;, &lt;2, 5, 0&gt;, 0.1 density 5000 }
      save_file "tut02.dat"
    }
  #else
    topology {
      load_file "tut02.dat"
      save_file "tut02.dat"
    }
  #end
}</pre></div><p xmlns="">
      The purpose of the individual lines of this block is the following:
    </p><p xmlns="">
      <tt class="function">gravity &lt;0, 0, -9.81&gt;</tt> activates a standard gravity force in negative
      vertical direction.
    </p><p xmlns="">
      <tt class="function">method 1</tt> selects simulation method 1 (Euler integration).
    </p><p xmlns="">
      The <tt class="function">environment {}</tt> block contains the definition of
      the environment. It contains:
    </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
        <tt class="function">object plane { z, 0 }</tt> - the environment object,
        a plane like seen in the image.
      </p></li><li><p>
        <tt class="function">damping 0.9</tt> - a damping factor decreasing the
        velocity perpendicular to the surface to 90% during every collision.
      </p></li><li><p>
        <tt class="function">friction 0.1</tt> - a friction factor decreasing the
        velocity tangential to the surface by 10% during every collision.
      </p></li><li><p>
        <tt class="function">method 2</tt> - activates method 2 collision calculation
        (impact law based collision).
      </p></li></ul></div><p xmlns="">
      The next two lines specify the timing of the simulation:
    </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
        <tt class="function">step_count 300</tt> - makes MegaPOV calculate 300 simulation steps
        per frame.
      </p></li><li><p>
        <tt class="function">time_step (1/30)/300</tt> - sets the duration of each step
        appropriate for a 30 fps animation.
      </p></li></ul></div><p xmlns="">
      Finding the right step size is probably something most difficult for the
      beginner.  A smaller step size generally leads to more accurate results.  Usually
      the step size has to be below a certain value depending on the other simulation
      settings to get usable results, but it is not always obvious if some strange result
      is due to large time steps.  High stiffness values in environments, collision and
      connections usually require smaller time steps.  If you experience unexpected results
      it is often worth trying to decrease the step size and see if problems vanish.
    </p><p xmlns="">
      There is also the possibility to use adaptive time stepping that will be introduced in 
      the next part of this tutorial.
    </p><p xmlns="">
      What follows is an <tt class="function">#if</tt> conditional.  It makes
      sure the mass is generated in the first frame and saved to the file
      while the following frames load and save the simulation data.
    </p><p xmlns="">The first part contains statements for the first frame:</p><p xmlns="">
      The <tt class="function">topology{}</tt> block contains a singular <tt class="function">mass{}</tt>
      section.  It contains:
    </p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
        <tt class="function">&lt;-2.8, -8.0, 0.9&gt;</tt> - the starting position of the mass.
      </p></li><li><p>
        <tt class="function">&lt;2, 5, 0&gt;</tt> - the initial velocity of the mass.
      </p></li><li><p>
        <tt class="function">0.1</tt> - the radius of the mass.
      </p></li><li><p>
        <tt class="function">density 5000</tt> - the density of the mass (in <tt class="function">kg/m³</tt>).
      </p></li></ul></div><p xmlns="">
      The <tt class="function">save_file</tt> statement finally saves this mass to a file.
    </p><p xmlns="">The second part contains the variant for the subsequent frames.</p><p xmlns="">
      The <tt class="function">topology{}</tt> block here contains just <tt class="function">load_file</tt>
      and <tt class="function">save_file</tt> statements referring to the same file.  This makes
      MegaPOV load the old simulation data at the beginning, calculate the steps for
      the current frame and save to the same file afterwards.
    </p><p xmlns="">
      To show the mass in the scene we can use a macro from the
      <tt class="filename"><tt class="filename">mechsim.inc</tt></tt>
      include file:
    </p><div xmlns="" class="informalexample"><pre class="programlisting"><tt class="function">#include</tt> "<tt class="filename">mechsim.inc</tt>"

MechSim_Show_All_Objects(-1, false, -1, "")</pre></div><p xmlns="">
      The meaning of the parameters of this macro is described in
      <a href="#mechsim_inc_MechSim_Show_All_Objects" title="3.4.4.2. MechSim_Show_All_Objects()">Section 3.4.4.2, &#8220;MechSim_Show_All_Objects()&#8221;</a>.
    </p><p xmlns="">
      Now all we need to do is render the scene using the render options that
      can be found in the scene file comment and we get the following result:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial02.pov" target="_top"><tt class="filename">tutorial02.pov</tt></a></li><li><a href="msim_tut/tutorial02.mpg" target="_top"><tt class="filename">tutorial02.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial02.png"></div></div><p xmlns="">
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_coll"></a>4.2.1.2. collisions</h4></div></div><div></div></div><p xmlns="">
      In the first part of the tutorial we have handled masses and their movement under
      the influence of gravity and the constraints of the environment.  If several masses
      exist in the simulation collisions between have to be taken into account.
    </p><p xmlns="">
      For turning collision calculation on the following block is added to the
      <tt class="function">mechsim{}</tt> section:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">collision {
  1, 0, 0
  stiffness 60000
  damping 4000
}</pre></div><p xmlns="">
      The first three numbers tell MegaPOV which collision to calculate.  For details
      see <a href="#mechsim_collision" title="2.7.4.1.3. The collision settings">Section 2.7.4.1.3, &#8220;The collision settings&#8221;</a>.  The numbers used here
      turn calculation on for all mass-mass collisions.
    </p><p xmlns="">
      <tt class="function">stiffness</tt> (unit <tt class="function">kg/s²</tt>) and
      <tt class="function">damping</tt> (unit <tt class="function">kg/s</tt>) influence
      how the masses interact.
    </p><p xmlns="">
      Another change made in this tutorial step is changing the environment
      to function based calculations.  This usually leads to more accurate environment
      collisions, especially with more complex geometries.
    </p><p xmlns="">
      Defining the environment as a function is fairy easy with the
      <a href="http://www.tu-bs.de/~y0013390/pov/ic/" target="_top">IsoCSG library</a>.
      The definition in this case looks like:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">#include "iso_csg.inc"

#declare fn_Env=
IC_Merge5(
  IC_Plane(z, 0),
  IC_Box(&lt; 1.7,-1.7,-1.0&gt;, &lt; 1.5,1.7,0.5&gt;),
  IC_Box(&lt;-1.7,-1.7,-1.0&gt;, &lt;-1.5,1.7,0.5&gt;),
  IC_Box(&lt;-1.7, 1.7,-1.0&gt;, &lt;1.7, 1.5,0.5&gt;),
  IC_Box(&lt;-1.7,-1.7,-1.0&gt;, &lt;1.7,-1.5,0.5&gt;)
)</pre></div><p xmlns="">
      Note that the <tt class="function">stiffness</tt>, <tt class="function">damping</tt> and
      <tt class="function">friction</tt> parameters in the environment now have the same meaning
      as in the collision settings because it uses calculation method 1 (force based
      environment collisions).
    </p><p xmlns="">
      Force based environment collisions lead to a more realistic simulation of the
      interaction of the masses with the environment since the movement of the masses does
      not abruptly change.  Using this method is necessary for all higher order integration
      methods which will be introduced later.
    </p><p xmlns="">
      This scene also adds new masses during the animation.  This is achieved by adding
      the following code to the <tt class="function">topology{}</tt> section:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">#if (mod(frame_number, 6)=5)
  mass { &lt; 1.3,-1.55,0.8&gt;, &lt;-0.2, 5, 0&gt;, 0.18 density 5000 }
#end</pre></div><p xmlns="">
      It means that in every sixth frame a new mass is added at the starting
      position with the same starting velocity as the first mass.
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial03.pov" target="_top"><tt class="filename">tutorial03.pov</tt></a></li><li><a href="msim_tut/tutorial03.mpg" target="_top"><tt class="filename">tutorial03.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial03.png"></div></div><p xmlns="">
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_con"></a>4.2.1.3. connections</h4></div></div><div></div></div><p xmlns="">
      Apart from masses there is another important element that can be added to the
      <tt class="function">topology{}</tt> section: connections.  Connections can be seen as
      springs.  They connect two point masses and exert a force on them depending on the
      current distance of the masses compared to the relaxed length of the connection.
      In addition there is a damping property generating dissipative forces.
    </p><p xmlns="">
      A <tt class="function">connection{}</tt> block is added to the
      <tt class="function">topology{}</tt> section like a mass:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">connection { 0, 1 stiffness 50000 damping 2000 }</pre></div><p xmlns="">It contains:</p><div xmlns="" class="itemizedlist"><ul type="disc"><li><p>
        <tt class="function">0</tt> - the index of the first mass connected.
      </p></li><li><p>
        <tt class="function">1</tt> - the index of the second mass connected.
      </p></li><li><p>
        <tt class="function">stiffness 50000</tt> - the stiffness of the connection (unit <tt class="function">kg/s²</tt>).
      </p></li><li><p>
        <tt class="function">damping 2000</tt> - the damping of the connection (unit <tt class="function">kg/s</tt>).
      </p></li></ul></div><p xmlns="">
      if no <tt class="function">length</tt> is given the current
      distance of the masses is used.
    </p><p xmlns="">
      The mass indices are counted in order of creation starting at zero.
      The three connected
      masses from the following scene are created with:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">topology {
  mass { &lt;0, 0, 2.4&gt;, &lt;0, 0, 0&gt;, 0.1 density 5000 fixed on }
  mass { &lt;1, 0, 2.4&gt;, &lt;0, 0, 0&gt;, 0.1 density 5000 }
  mass { &lt;2, 0, 2.4&gt;, &lt;0, 0, 0.6&gt;, 0.15 density 5000 }
  connection { 0, 1 stiffness 50000 damping 2000 }
  connection { 1, 2 stiffness 50000 damping 2000 }
}</pre></div><p xmlns="">
      The <tt class="function">fixed on</tt> in the first mass definition fixes the
      position of this mass.
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial04.pov" target="_top"><tt class="filename">tutorial04.pov</tt></a></li><li><a href="msim_tut/tutorial04.mpg" target="_top"><tt class="filename">tutorial04.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial04.png"></div></div><p xmlns="">
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_grid"></a>4.2.1.4. grids</h4></div></div><div></div></div><p xmlns="">
      With plenty of such connections we can form more complex shapes.
      The <tt class="filename">mechsim.inc</tt> include file
      (see <a href="#mechsim.inc" title="3.4. The 'mechsim.inc' include file">Section 3.4, &#8220;The 'mechsim.inc' include file&#8221;</a>)
      contains several macros forming grids of masses and connections.
    </p><p xmlns="">
      Placing the following in the <tt class="function">topology{}</tt> section generates a
      box-like grid of connected masses:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">MechSim_Generate_Block(
  &lt;0, 0, 0&gt;, 0.07, 1500, 22000, 2000, true,
  &lt;-0.5, -2.75, 1.0&gt;, &lt;0.5, 2.75, 2.0&gt;, &lt;3, 12, 3&gt;, No_Trans, 3
)</pre></div><p xmlns="">
      The meaning of the different parameters is described in
      <a href="#mechsim_inc_MechSim_Generate_Block" title="3.4.5.11. MechSim_Generate_Block()">Section 3.4.5.11, &#8220;MechSim_Generate_Block()&#8221;</a>.
    </p><p xmlns="">
      Apart from the grid macro we introduce a different simulation method in
      this scene.  <tt class="function">method 3</tt> uses adaptive time stepping.
      This means you don't need to specify a step size but instead specify how 
      accurate the simulation should be.  The <tt class="function">accuracy</tt>
      option takes two parameters: the maximum allowed local discretization
      error and the minimum step size to use.
    </p><p xmlns="">
      Note that you might still need to specify an appropriate starting step size
      using <tt class="function">time_step</tt> - the default value might not be
      appropriate.
    </p><p xmlns="">
      In addition to the accuracy settings the total time per frame is specified
      using the <tt class="function">time</tt> parameter.
    </p><p xmlns="">
      The resulting animation shows a moving and deforming box geometry.
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial05.pov" target="_top"><tt class="filename">tutorial05.pov</tt></a></li><li><a href="msim_tut/tutorial05.mpg" target="_top"><tt class="filename">tutorial05.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial05.png"></div></div><p xmlns="">
    </p><p xmlns="">
      The <tt class="function">MechSim_Generate_Block()</tt> macro also generates faces for the
      outside surface of the box.  Faces are triangles each connecting three masses.  They
      can be used for collision calculations and for displaying the geometry as a mesh.
      The latter can be done easily by changing the parameters of the
      <tt class="function">MechSim_Show_All_Objects()</tt> macro:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">MechSim_Show_All_Objects(-1, true, -1, "")</pre></div><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial06.pov" target="_top"><tt class="filename">tutorial06.pov</tt></a></li><li><a href="msim_tut/tutorial06.mpg" target="_top"><tt class="filename">tutorial06.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial06.png"></div></div><p xmlns="">
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_patch"></a>4.2.1.5. patches</h4></div></div><div></div></div><p xmlns="">
      Apart from 3D grids we of course can also create 2D rectangular patches.
      Such objects behave like cloth or foil and offer a very interesting field
      of simulation.
    </p><p xmlns="">
      Like 3D grids rectangular patches can be created with macros from
      the <tt class="filename">mechsim.inc</tt> include file
      (see <a href="#mechsim.inc" title="3.4. The 'mechsim.inc' include file">Section 3.4, &#8220;The 'mechsim.inc' include file&#8221;</a>):
    </p><div xmlns="" class="informalexample"><pre class="programlisting">MechSim_Generate_Patch_Std(
  &lt;0, 0, 0&gt;, 0.03, 8000, 10000, 0,
  true, &lt;0.055, 0.055&gt;, &lt;50, 50&gt;, Trans1, 2
)</pre></div><p xmlns="">
      This creates a 50x50 masses patch, again movable with a
      <tt class="function">transform</tt>.  Description of the parameters can be found in
      <a href="#mechsim_inc_MechSim_Generate_Patch_Std" title="3.4.5.15. MechSim_Generate_Patch_Std()">Section 3.4.5.15, &#8220;MechSim_Generate_Patch_Std()&#8221;</a>.
    </p><p xmlns="">
      The following sample scene also uses a different simulation method than
      the previous scenes.  It is called gradient descent method. It does not integrate the
      equations of movement like the other methods but moves the masses directly according
      to the forces influencing them.  Inertia does not have effect with these method,
      therefore oscillations can't occur.  Still the step size has to be chosen small enough
      for accurate results.  The movement won't look very realistic in an animation but
      the final result can be used for a still render.  Another disadvantage is the lack
      of friction, therefore the patch slides off the sphere in the end.
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial07.pov" target="_top"><tt class="filename">tutorial07.pov</tt></a></li><li><a href="msim_tut/tutorial07.mpg" target="_top"><tt class="filename">tutorial07.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial07.png"></div></div><p xmlns="">
    </p><p xmlns="">
      There is also a specialized macro for generating a mesh from a patch topology
      including normal vectors and uv coordinates.  Rendering the previous topology with
      this macro results in the following picture:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial08.pov" target="_top"><tt class="filename">tutorial08.pov</tt></a></li><li><a href="msim_tut/tutorial08.mpg" target="_top"><tt class="filename">tutorial08.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial08.png"></div></div><p xmlns="">
    </p><p xmlns="">
      There are a lot more aspects of the mechanics simulation patch that are not
      handled in this tutorial yet.  Reading the reference
      (see <a href="#mechsim" title="2.7.4. Mechanics simulation patch">Section 2.7.4, &#8220;Mechanics simulation patch&#8221;</a>) and
      <tt class="filename">mechsim.inc</tt> include file documentation
      (see <a href="#mechsim.inc" title="3.4. The 'mechsim.inc' include file">Section 3.4, &#8220;The 'mechsim.inc' include file&#8221;</a>) should help learning
      about those things.  The sample scenes show several examples what
      the simulation system
      can be used for but there are a lot more possibilities.
    </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mechsim_tut_interaction"></a>4.2.1.6. mass interaction</h4></div></div><div></div></div><p xmlns="">
      Masses can not only collide but also can interact in a freely definable way.
      This way you can simulate physical effect like electromagnetic fields and gravity.
    </p><p xmlns="">
      Mass interaction is defined globally with the<tt class="function">interaction</tt> keyword
      in the <tt class="function">mechsim{}</tt> block.  For the inverse square law of gravity
      you for example could use the following setup:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">// Gravitation constant: 6.672e-11 m^3*kg^-1*s^-2
#declare G=6.672e-11;

// Newton's law of gravitation
#declare fn_Gravity=
  function(x, y, z, dist, m1, m2) {
    (G*m1*m2)/(dist*dist)
  }

global_settings {
  mechsim {
    ...
    interaction {
      function(x, y, z, dist, m1, m2) { fn_Gravity(x, y, z, dist, m1, m2) }
    }
    ...
  }
}</pre></div><p xmlns="">
      As you can see the interaction function has 6 parameters.  The first three
      are the usual coordinates so you can define an interactions that differs
      depending on the absolute position.  The last three are optional, the first 
      of them is the distance between the masses and the other two the masses
      of the two masses that interact.
    </p><p xmlns="">
      The simulation system calls this function for every pair of masses in every 
      simulation step.  This can of course be quite slow with a lot of masses.
      But in this simple example we only want to simulate the movement of the earth
      around the sun which is done with the following topology definition:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">#declare Mio_km=1.0e9;

topology {
  // Sun
  mass { &lt;0,0,0&gt;, &lt;0,0,0&gt;, 696.0e6 mass 1.99e30 }
  // Earth
  mass { &lt;149.6*Mio_km,0,0&gt;, &lt;0,29.8*1000,0&gt;, (6371.0)*1000 mass 5.97e24 }

  save_file "tut09.dat"
}</pre></div><p xmlns="">
      Simulating this with 1 step per day is done with the following code:
    </p><div xmlns="" class="informalexample"><pre class="programlisting">step_count 2000

// 1 day per step
time_step (24*3600)/2000

topology {
  load_file "tut09.dat"
  save_file "tut09.dat"
}</pre></div><p xmlns="">
      And results in the following movement.  The size of the sun and earth is of course
      strongly exaggerated.  You can find a more complex simulation of all the inner
      planets in the <tt class="filename">planets.pov</tt> sample scene.
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="msim_tut/tutorial09.pov" target="_top"><tt class="filename">tutorial09.pov</tt></a></li><li><a href="msim_tut/tutorial09.mpg" target="_top"><tt class="filename">tutorial09.mpg</tt> (mpeg, 320x240)</a></li></ul></div><p xmlns="">
      </p><div xmlns="" class="informalfigure"><div><img src="img/tutorial09.png"></div></div><p xmlns="">
    </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tutorials_hdri"></a>4.3. HDRI (High dynamic range illumination)</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="hdri_tutorial"></a>4.3.1. HDRI tutorial</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></h3></div></div></div><div></div></div><p xmlns="">
    This part of the MegaPOV documentation should
    give some insight on how to use the support for
    high dynamic range images introduced in MegaPOV 1.1
    for image based lighting.
  </p><p xmlns="">
    The scenes used for illustrating this tutorial can be found in the
    MegaPOV package.
  </p><p xmlns="">
    More detailed information on this matter can be found on
    <a href="http://www.debevec.org/Research/HDR/" target="_top">http://www.debevec.org/Research/HDR/</a>
  </p><p xmlns="">
    In a scene with strong contrasts the dynamic range cannot be represented
    well with common image formats.
  </p><div xmlns="" class="table"><a name="id2582523"></a><p class="title"><b>Table 4.1. Example for high dynamic range of raytraced scene</b></p><table summary="Example for high dynamic range of raytraced scene" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><div><img src="img/tut_hdr_1.png"></div></td><td style="" align="center"><div><img src="img/tut_hdr_2.png"></div></td><td style="" align="center"><div><img src="img/tut_hdr_3.png"></div></td></tr></tbody></table></div><p xmlns="">
    MegaPOV 1.1 can write the render result in a format suited for storing high dynamic
    range color information.  For details on this format see <a href="#hdr" title="2.6.6. HDR (High Dynamic Range) image type">Section 2.6.6, &#8220;HDR (High Dynamic Range) image type&#8221;</a>.
  </p><p xmlns="">
    <a href="img/tut_hdr_view.hdr" target="_top">tut_hdr_view.hdr</a>
  </p><p xmlns="">
    For creating a light probe from such a scene it should be rendered using
    a <tt class="function">spherical</tt> camera:
  </p><p xmlns="">
</p><pre xmlns="" class="programlisting">camera {
  spherical
  angle 360, 180
}</pre><p xmlns="">
  </p><p xmlns="">
    This renders an omnidirectional view of the scene that can be mapped on a sphere using
    spherical mapping.
  </p><div xmlns="" class="table"><a name="id2582636"></a><p class="title"><b>Table 4.2. Views and illumination maps from the scene</b></p><table summary="Views and illumination maps from the scene" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><span class="emphasis"><em>lighting 1</em></span></td><td style="" align="center"><span class="emphasis"><em>lighting 2</em></span></td><td class="auto-generated" style=""> </td></tr><tr><td style="" align="center"><div><img src="img/tut_hdr_view1.png"></div></td><td style="" align="center"><div><img src="img/tut_hdr_view2.png"></div></td><td class="auto-generated" style=""> </td></tr><tr><td style="" align="center"><div><img src="img/tut_hdr_env1.png"></div></td><td style="" align="center"><div><img src="img/tut_hdr_env2.png"></div></td><td class="auto-generated" style=""> </td></tr></tbody></table></div><p xmlns="">
    When this light probe is rendered it can be used in scenes as an illumination map
    to achieve realistic lighting in another scene without the whole content of the original
    scene being included and slowing down the render.
  </p><div xmlns="" class="table"><a name="id2582734"></a><p class="title"><b>Table 4.3. The illumination maps being used in a scene</b></p><table summary="The illumination maps being used in a scene" border="0" style="border-collapse: collapse;"><colgroup><col><col><col></colgroup><tbody><tr><td style="" align="center"><span class="emphasis"><em>lighting 1</em></span></td><td style="" align="center"><span class="emphasis"><em>lighting 2</em></span></td><td class="auto-generated" style=""> </td></tr><tr><td style="" align="center"><div><img src="img/tut_hdr_res1.png"></div></td><td style="" align="center"><div><img src="img/tut_hdr_res2.png"></div></td><td class="auto-generated" style=""> </td></tr></tbody></table></div><p xmlns="">
    In this scene the image map is applied to a large sphere around the scene:
</p><pre xmlns="" class="programlisting">sphere {
  0,200
  pigment {
    image_map {
      hdr "hdr_env.hdr"
      once
      interpolate 2
      map_type 1
    }
  }
  finish { ambient 0.8 diffuse 0 }
  ...
}</pre><p xmlns="">
  </p><p xmlns="">
    When this light probe is rendered it can be used in scenes as an illumination map
    to achieve realistic lighting in another scene without the whole content of the original
    scene being included and slowing down the render.
  </p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="internals"></a>Chapter 5. Internals</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#sources">5.1. Sources</a></span></dt><dd><dl><dt><span class="section"><a href="#architecture">5.1.1. Understanding the POV-Ray source structure</a></span></dt><dt><span class="section"><a href="#patching">5.1.2. Creating your own patches</a></span></dt></dl></dd><dt><span class="section"><a href="#binaries">5.2. Binaries</a></span></dt><dd><dl><dt><span class="section"><a href="#windows_compile">5.2.1. compiling on Windows systems</a></span></dt><dt><span class="section"><a href="#mac_compile">5.2.2. compiling on Macintosh systems</a></span></dt><dt><span class="section"><a href="#unix_compile">5.2.3. compiling on Unix systems</a></span></dt></dl></dd><dt><span class="section"><a href="#parser">5.3. Parser</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_tokens">5.3.1. Adding tokens</a></span></dt></dl></dd><dt><span class="section"><a href="#internals_patterns">5.4. Patterns</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_mem_patterns">5.4.1. Reducing memory usage</a></span></dt></dl></dd><dt><span class="section"><a href="#internals_expressions">5.5. Expressions</a></span></dt><dd><dl><dt><span class="section"><a href="#internals_polynomials">5.5.1. Polynomial solver</a></span></dt></dl></dd><dt><span class="section"><a href="#multiformat_documentation">5.6. Multi-format Documentation with DocBook</a></span></dt><dd><dl><dt><span class="section"><a href="#docbook_environment">5.6.1. Environment for DocBook documentation</a></span></dt><dt><span class="section"><a href="#docbook_editing">5.6.2. Editing DocBook documentation</a></span></dt><dt><span class="section"><a href="#docbook_conversion">5.6.3. Converting DocBook documents</a></span></dt></dl></dd></dl></div><p>
    With increasing raytracing experience and knowledge about algorithms
    you may want to change/fix some features or add new ones to the core
    sources of <span class="trademark">POV-Ray</span>&#8482; or MegaPOV. You may also want modify sources
    when you want to move a slowly parsed SDL macro to faster C/C++
    code within <span class="trademark">POV-Ray</span>&#8482;.
  </p><p>
    The following section is our effort to write down the conclusions
    we made from our experience in writing patches compatible with
    <span class="trademark">POV-Ray</span>&#8482; architecture with portable documentation and merging those
    made by others.  If you are new to <span class="trademark">POV-Ray</span>&#8482; or patch writing you
    should bear in mind we have a long term experience with <span class="trademark">POV-Ray</span>&#8482;
    and you probably can learn something useful from the things written
    here.  If you are an experienced patch writer do not hesitate to
    vary the rules where you think this is appropriate.
  </p><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sources"></a>5.1. Sources</h2></div></div><div></div></div><a xmlns="" class="indexterm" name="id2585548"></a><p xmlns="">
    Working with sources of <span xmlns="" class="trademark">POV-Ray</span>&#8482; 3.6 or MegaPOV
    requires some basic knowledge about:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>POV-SDL usage</li><li>C and C++ programming</li><li>3D math</li><li>raytracing terms and algorithms</li></ul></div><p xmlns="">
    Although <span xmlns="" class="trademark">POV-Ray</span>&#8482; and MegaPOV sources can be considered
    as a nice lesson in programming and raytracing it is not recommended
    for beginners in programming and computer graphics to try modifying it.
    There are relatively complex relations between the different parts and
    changing something without knowing exactly what you do is likely to cause 
    problems, even if it compiles and works well in first tests. Please do not 
    waste time asking for detailed explanations when answer seems obvious in 
    the above categories.
    Try to find some online tutorials or just buy a comprehensive book and most 
    important: study the source code.
    Below information is gathered mainly to highlight <span xmlns="" class="trademark">POV-Ray</span>&#8482; source
    specific aspects.
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="architecture"></a>5.1.1. Understanding the <span class="trademark">POV-Ray</span>&#8482; source structure</h3></div></div><div></div></div><a xmlns="" class="indexterm" name="id2586837"></a><p xmlns="">
      Sources of MegaPOV are based on the <span class="trademark">POV-Ray</span>&#8482; sources distributed
      officially by <span class="trademark">POV-Team</span>&#8482;. The basis for the modifications included in
      MegaPOV 1.1 is the source of the official 3.6.0 version.
      Filenames usually already give a hint on the purpose and most files contain a short
      description in the header on their purpose. Each <tt class="filename">*.cpp</tt>
      filename is delivered with appropriate <tt class="filename">*.h</tt>
      header file.
    </p><p xmlns="">
      All files located in the <tt xmlns="" class="filename">/source</tt> directory in the
      archives can be considered as part of the following categories:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><p>
            The <tt class="filename">patches</tt> subdirectory contains all new files for features introduced in MegaPOV:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">patches/patches.h</tt> - this file enables the individual patches of MegaPOV</li><li><tt class="filename">patches/clothray.cpp</tt></li><li><tt class="filename">patches/glow.cpp</tt></li><li><tt class="filename">patches/mechsim.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Common structures and definitions:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">frame.h</tt></li><li><tt class="filename">vector.h</tt></li><li><tt class="filename">[platform]/config.h</tt> - located in platform specific directory</li></ul></div><p>
          </p></li><li><p>
            Object definitions:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">bezier.cpp</tt></li><li><tt class="filename">blob.cpp</tt></li><li><tt class="filename">boxes.cpp</tt></li><li><tt class="filename">cones.cpp</tt></li><li><tt class="filename">csg.cpp</tt></li><li><tt class="filename">discs.cpp</tt></li><li><tt class="filename">fpmetric.cpp</tt></li><li><tt class="filename">fractal.cpp</tt></li><li><tt class="filename">hcmplx.cpp</tt></li><li><tt class="filename">hfield.cpp</tt></li><li><tt class="filename">isosurf.cpp</tt></li><li><tt class="filename">lathe.cpp</tt></li><li><tt class="filename">mesh.cpp</tt></li><li><tt class="filename">objects.cpp</tt></li><li><tt class="filename">planes.cpp</tt></li><li><tt class="filename">poly.cpp</tt></li><li><tt class="filename">polygon.cpp</tt></li><li><tt class="filename">prism.cpp</tt></li><li><tt class="filename">quadrics.cpp</tt></li><li><tt class="filename">quatern.cpp</tt></li><li><tt class="filename">sor.cpp</tt></li><li><tt class="filename">spheres.cpp</tt></li><li><tt class="filename">sphsweep.cpp</tt></li><li><tt class="filename">super.cpp</tt></li><li><tt class="filename">torus.cpp</tt></li><li><tt class="filename">triangle.cpp</tt></li><li><tt class="filename">truetype.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Lighting and other "visible" effects:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">atmosph.cpp</tt></li><li><tt class="filename">lightgrp.cpp</tt></li><li><tt class="filename">lighting.cpp</tt></li><li><tt class="filename">media.cpp</tt></li><li><tt class="filename">photons.cpp</tt></li><li><tt class="filename">point.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Radiosity:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">octree.cpp</tt></li><li><tt class="filename">radiosit.cpp</tt></li><li><tt class="filename">rad_data.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Texturing:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">image.cpp</tt></li><li><tt class="filename">interior.cpp</tt></li><li><tt class="filename">normal.cpp</tt></li><li><tt class="filename">pattern.cpp</tt></li><li><tt class="filename">pigment.cpp</tt></li><li><tt class="filename">texture.cpp</tt></li><li><tt class="filename">txttest.cpp</tt> - place for own texturing experiments</li><li><tt class="filename">warps.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Raytracing helpers:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">bbox.cpp</tt></li><li><tt class="filename">bcyl.cpp</tt></li><li><tt class="filename">bsphere.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Builtin benchmark:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">benchmark.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Math helpers with operation on different types of data:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">chi2.cpp</tt></li><li><tt class="filename">colour.cpp</tt></li><li><tt class="filename">colutils.cpp</tt></li><li><tt class="filename">matrices.cpp</tt></li><li><tt class="filename">polysolv.cpp</tt></li><li><tt class="filename">splines.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Parser routines:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">express.cpp</tt></li><li><tt class="filename">parse.cpp</tt></li><li><tt class="filename">parsestr.cpp</tt></li><li><tt class="filename">parstxtr.cpp</tt></li><li><tt class="filename">tokenize.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            IO routines for various formats:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">file_pov.cpp</tt></li><li><tt class="filename">gif.cpp</tt></li><li><tt class="filename">gifdecod.cpp</tt></li><li><tt class="filename">histogra.cpp</tt></li><li><tt class="filename">iff.cpp</tt></li><li><tt class="filename">jpeg_pov.cpp</tt></li><li><tt class="filename">pgm.cpp</tt></li><li><tt class="filename">png_pov.cpp</tt></li><li><tt class="filename">ppm.cpp</tt></li><li><tt class="filename">targa.cpp</tt></li><li><tt class="filename">tiff_pov.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Functions Virtual Machine implementation together with internal functions:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">fncode.cpp</tt></li><li><tt class="filename">fnintern.cpp</tt></li><li><tt class="filename">fnpovfpu.cpp</tt></li><li><tt class="filename">fnsyntax.cpp</tt></li><li><tt class="filename">function.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            Rendering process:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">ray.cpp</tt></li><li><tt class="filename">render.cpp</tt></li><li><tt class="filename">renderio.cpp</tt></li><li><tt class="filename">renderctrl.cpp</tt></li><li><tt class="filename">camera.cpp</tt></li><li><tt class="filename">lbuffer.cpp</tt></li><li><tt class="filename">vbuffer.cpp</tt></li><li><tt class="filename">vlbuffer.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            general program routines:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">optout.cpp</tt></li><li><tt class="filename">povray.cpp</tt></li><li><tt class="filename">pov_mem.cpp</tt></li><li><tt class="filename">pov_util.cpp</tt></li><li><tt class="filename">statspov.cpp</tt></li><li><tt class="filename">userdisp.cpp</tt></li><li><tt class="filename">userio.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            the <tt class="filename">base</tt> subdirectory contains routines for
            file input/output as well as string and option handling.
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">base/configbase.h</tt></li><li><tt class="filename">base/fileinputoutput.cpp</tt></li><li><tt class="filename">base/platformbase.h</tt></li><li><tt class="filename">base/pointer.h</tt></li><li><tt class="filename">base/pov_err.h</tt></li><li><tt class="filename">base/povms.cpp</tt></li><li><tt class="filename">base/povmscpp.cpp</tt></li><li><tt class="filename">base/povmsgid.h</tt></li><li><tt class="filename">base/processoptions.cpp</tt></li><li><tt class="filename">base/stringutilities.cpp</tt></li><li><tt class="filename">base/textstream.cpp</tt></li><li><tt class="filename">base/textstreambuffer.cpp</tt></li></ul></div><p>
          </p></li><li><p>
            the <tt class="filename">frontend</tt> subdirectory contains the default
            frontend:
            </p><div class="itemizedlist"><ul type="circle" compact><li><tt class="filename">frontend/configfrontend.h</tt></li><li><tt class="filename">frontend/defaultplatformbase.cpp</tt></li><li><tt class="filename">frontend/defaultrenderfrontend.cpp</tt></li><li><tt class="filename">frontend/messageoutput.cpp</tt></li><li><tt class="filename">frontend/processrenderoptions.cpp</tt></li><li><tt class="filename">frontend/renderfrontend.cpp</tt></li></ul></div><p>
          </p></li></ul></div><p xmlns="">
    </p><p xmlns="">
      As mentioned above the <tt class="filename">config.h</tt> configuration file
      is located in a platform specific directory. This directory is usually
      named like the target platform (like <tt class="filename">windows</tt>,
      <tt class="filename">unix</tt> etc.). There are also
      other files located in that directory: implementation of GUI, binary
      resources (like icons), implementation of some (protected) IO
      operations and other platform specific solutions.
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="patching"></a>5.1.2. Creating your own patches</h3></div></div><div></div></div><p xmlns="">
      Extending <span class="trademark">POV-Ray</span>&#8482; with new features is something that requires
      significant skills (see <a href="#sources" title="5.1. Sources">Section 5.1, &#8220;Sources&#8221;</a>), experience and time.
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="patching_planning"></a>5.1.2.1. Planning a patch</h4></div></div><div></div></div><p xmlns="">
        There are many different reasons for modifying the <span class="trademark">POV-Ray</span>&#8482; source.
        Most important are the fixing of bugs and extending <span class="trademark">POV-Ray</span>&#8482; with new features.
      </p><p xmlns="">
        When fixing a bug it should be considered what is the right, expected behavior 
        of the program, the fix should establish this.  In many cases patches introduced
        as a bugfix are in fact feature extensions or only superficial fixes that do not 
        solve the underlying problem.
      </p><p xmlns="">
        When you are planning a new feature you should first think about how it
        should fit into the rest of <span class="trademark">POV-Ray</span>&#8482; features.  A good patch can be used 
        quite universally, not only for the purpose it was originally developed for.  
        Do not try to reinvent the wheel but make use of existing
        techniques that already exist in the <span class="trademark">POV-Ray</span>&#8482; source.  For things like status
        output and file reading use functions existing in <span class="trademark">POV-Ray</span>&#8482;.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="markup"></a>5.1.2.2. Markup - key to usable patches</h4></div></div><div></div></div><p xmlns="">
        It is hard to describe good guidelines for the actual coding of a patch.
        Every programmer has own habits and methods
        including indention, placing of braces, inserting white spaces,
        favorite naming scheme. But there are some common rules <span class="trademark">POV-Ray</span>&#8482;
        patch writers usually follow.
        Here is our effort for a brief summary - mainly meant as a starting
        aid for beginning patch writers.
      </p><p xmlns="">
        When coding make use of existing helper functions in <span class="trademark">POV-Ray</span>&#8482; like those
        in <tt class="filename">vector.h</tt>.  Try to reduce changes in existing code
        to avoid damaging existing features.
      </p><p xmlns="">
        Usually, people put something like
        <tt xmlns="" class="function">#define <i class="parameter"><tt>MY_PATCH</tt></i></tt>
        in a commonly used file:
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="filename">patches/patches.h</tt> - for general patches (this file is introduced in MegaPOV and included within <tt class="filename">frame.h</tt> so no need to add it to the rest of the sources).</li><li><tt class="filename">frame.h</tt> - for general patches in case you are patching plain <span class="trademark">POV-Ray</span>&#8482; and don not want to add a <tt class="filename">patches.h</tt> file.</li><li><tt class="filename">[platform]/config.h</tt> - for platform specific changes (when compiler requires replacement for missed functions or needs to customize rendering engine to cooperate with shell of platform)</li></ul></div><p xmlns="">
        Now you should enclose all patch-specific code in
        <tt xmlns="" class="function">#ifdef ... [<span class="optional">#else ...</span>] #endif</tt>
        blocks, so removing (commenting)
        <tt xmlns="" class="function">/* #define <i class="parameter"><tt>MY_PATCH</tt></i> */</tt>
        causes compilation without your patch,
        and the modifications you make are clearly visible.
        Optional <tt xmlns="" class="function">#else ...</tt> is suggested when you are
        making replacement for existing code (i.e. for bug fixes).
      </p><p xmlns="">
        The most common system for patch naming are uppercased words separated
        with underscores. Names are usually concatenated with word
        <i class="parameter"><tt>PATCH</tt></i> somehow.
        In world of Apple mixed case variable names without
        underscores like <i class="parameter"><tt>MyPatch</tt></i> are also popular.
      </p><div xmlns="" class="example"><a name="id2588585"></a><p class="title"><b>Example 5.1. Typical patch markup</b></p><p xmlns="">
          <tt xmlns="" class="filename">patches.h</tt>:
          </p><pre class="programlisting">...
#define <i class="parameter"><tt>FAST_SQR_PATCH</tt></i>
...</pre><p xmlns="">
        </p><p xmlns="">
          <tt xmlns="" class="filename">some_file.cpp</tt>:
          </p><pre class="programlisting">...
#ifdef <i class="parameter"><tt>FAST_SQR_PATCH</tt></i>
  // new code
  <tt class="varname">Value</tt> = <tt class="function">sqr</tt>( <tt class="varname">Parameter</tt> );
#else
  // old code
  <tt class="varname">Value</tt> = <tt class="varname">Parameter</tt> * <tt class="varname">Parameter</tt>;
#endif
...</pre><p xmlns="">
        </p></div><p xmlns="">
        Some additions can be also compiler specific changes required by
        lack of some builtin C function or different naming.
        In such cases you can use predefined compiler specific macros
        together with your own markup. Each compiler delivers several
        predefined macros (see <a xmlns="" href="#binaries" title="5.2. Binaries">Section 5.2, &#8220;Binaries&#8221;</a>).
        </p><pre xmlns="" class="programlisting">#ifdef __DJGPP__
  // some compiler specific code
#else
  // code for other compilers
#endif

#if defined( __WATCOMC__ ) &amp;&amp; defined( MY_PATCH)
  // code here
#end</pre><p xmlns="">
      </p><p xmlns="">
        Of course it is a little bit more work to maintain changes this way
        but on the other hand it is also much more readable and allows to
        prepare two binaries for comparison.
        It is also much more easier to port your changes into other compilations
        like MegaPOV then.
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="coding"></a>5.1.2.3. Coding - stay portable</h4></div></div><div></div></div><p xmlns="">
        Apart from the markup it is important to keep modifications
        portable.  Patches using compiler specific features or functions from a
        proprietary library won't make it into a patch collection like
        MegaPOV.
      </p><p xmlns="">
        When you add new elements to the POV-Ray scene description language
        it is a good idea to keep it consistent with the existing syntax.
        Even if you think a certain syntax would be much easier to use it is
        very likely to cause much confusion for the user when it differs from
        existing similar functions.
      </p><p xmlns="">
        Some useful information about portability aspects can be found on
        <a href="http://predef.sourceforge.net/" target="_top">http://predef.sourceforge.net/</a>.
      </p><p xmlns="">
        If you are unsure about a certain aspect of your patch implementation
        better ask (see <a href="#discussion" title="1.5.3. Discussions">Section 1.5.3, &#8220;Discussions&#8221;</a>).
      </p></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="sharing"></a>5.1.2.4. Sharing patches</h4></div></div><div></div></div><p xmlns="">
        Once a patch is finished you may want to share this patch with the
        <span xmlns="" class="trademark">POV-Ray</span>&#8482; Community. Doing this in a wise way can make your patch
        popular and included in other unofficial custom compilations
        like MegaPOV is. So before you upload your changes somewhere
        first check if:
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
              every difference between your modified source and base source
              is somehow marked (with <tt class="function">#ifdef</tt>) so other
              users can understand where the code is modified.
           </li><li>
              no line from the old source is removed.
            </li><li>
              all necessary headers are included in files
              (this is common omission when precompiled headers are used)
            </li><li>
              in case your sources contain more then one patch, be sure
              that one change does not require code from the
              other patch to work.  If one patch depends on the other
              this should be clearly indicated.
            </li><li>
              most important: Your patch is well documented both in the source
              and for the user.  Even if this means quite some work it is probably
              the most critical point for a patch to become successful
              on the long run or not.
            </li></ul></div><p xmlns="">
      </p><p xmlns="">
        When your modifications are validated then it is time to publish it.
        There are some common methods in publishing patches:
        </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
              releasing differences in <span class="application">diff</span>
              format - this is a very popular method however it works well
              only when changes are moved between very similar packages.
              It is most important to mention on what basis the modification
              is made.  To make sure the modification can still be used some
              time later this is usually not the optimal solution (except for
              really small modifications).
            </li><li>
              releasing all files affected by changes for particular patch -
              it is very good method because everyone can easily merge it with
              files with own modifications.
            </li><li>
              releasing a snapshot of all files in your working directory -
              this method guarantees that you do not omit any change however
              it requires detailed comparison of all files for those who want
              to merge the patch.
            </li><li>
              releasing a detailed description of all changes with explanation
              why, what, where and how things were changed - this
              "do it yourself" method makes your patch highly portable
              because it is easy to understand and nearly independent from the
              source basis but it requires a larger effort.
            </li></ul></div><p xmlns="">
        It is hard to tell which method is the best. The choose of particular
        method depends on free time, complexity of changes and used sources.
      </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="binaries"></a>5.2. Binaries</h2></div></div><div></div></div><p xmlns="">
    Making your own binaries from <span xmlns="" class="trademark">POV-Ray</span>&#8482; and MegaPOV source code requires:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>
          a C/C++ compiler and linker with
          <a href="http://www.sgi.com/tech/stl/" target="_top">STL</a> support
        </li><li>
          knowledge about compiling and linking
        </li></ul></div><p xmlns="">
    All required support libraries are included in the source distributions.
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="windows_compile"></a>5.2.1. compiling on Windows systems</h3></div></div><div></div></div><p xmlns="">
      To compile MegaPOV on Windows systems you do not need to buy
      expensive compilers. There are some free C++ compilers
      available.
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="borlandc"></a>5.2.1.1. Borland C++ 5.5</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>www.borland.com</p></dd><dt><span class="term">Target</span></dt><dd><p>creation of Windows GUI tested</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://www.borland.com/products/downloads/download_cbuilder.html</p></dd><dt><span class="term">Documentation</span></dt><dd><p>included with binaries in basic form, extended documentation for full commercial version at ftp://ftp.borland.com/pub/bcppbuilder/techpubs/b5std.zip</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://groups.google.com/groups?group=borland.public.cpp</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__BORLANDC__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>http://news.povray.org/povray.binaries.utilities/27877/</p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="djgpp"></a>5.2.1.2. DJGPP - A free 32-bit development system for DOS</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.delorie.com/djgpp/</p></dd><dt><span class="term">Target</span></dt><dd><p>creation of command line version for DOS tested</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://www.delorie.com/djgpp/zip-picker.html</p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://www.delorie.com/djgpp/doc/</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://groups.google.com/groups?group=comp.os.msdos.djgpp</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__DJGPP__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              The core of DJGPP is the MS-DOS port of the GNU C/C++ compiler, GCC, and auxiliary utilities,
              such as assembler, linker, librarian, Make, and a hypertext docs browser. So people familiar
              with GCC family should not have problems in using it.
            </p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="mingw"></a>5.2.1.3. MinGW - Minimalist GNU for Windows</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.mingw.org/</p></dd><dt><span class="term">Target</span></dt><dd><p>command line version for Windows tested</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://prdownloads.sourceforge.net/mingw/</p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://www.mingw.org/docs.shtml</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://www.mingw.org/lists.shtml</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__MINGW32__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              There is name conflict between <tt class="function">BLOB</tt> and other identifiers
              in <span class="trademark">POV-Ray</span>&#8482; and MinGW.
            </p><p>
              MinGW can be used together with Cygwin, see http://www.mingw.org/mingwfaq.shtml#faq-usingwithcygwin.
            </p><p>
              An adapted source code package for compiling with MinGW is available on the
              <a href="http://megapov.inetart.net/" target="_top">MegaPOV site</a>.
            </p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="cygwin"></a>5.2.1.4. Cygwin - UNIX environment for Windows</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.cygwin.com/</p></dd><dt><span class="term">Target</span></dt><dd><p>creation of command line version for windows tested</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://www.cygwin.com/download.html</p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://cygwin.com/docs.html</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://cygwin.com/lists.html</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__CYGWIN__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              With Cygwin you can compile both executables using the Cygwin
              emulation DLL or not (using the -mno-cygwin flag).
              Both tested, compilation with X display possible (when XFree86 is installed).
            </p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="digitalmars"></a>5.2.1.5. Digital Mars C++</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.digitalmars.com/</p></dd><dt><span class="term">Target</span></dt><dd><p>command line version for windows tested</p></dd><dt><span class="term">Binaries</span></dt><dd><p>ftp://digitalmars.com/dmc.zip</p></dd><dt><span class="term">Documentation</span></dt><dd><p>ftp://ftp.digitalmars.com/Digital_Mars_C++/Doc/</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>news://news.digitalmars.com/ , http://www.digitalmars.com/drn-bin/wwwnews?newsgroups=*</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__DMC__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              there is no <tt class="function">atof</tt> in standard libraries so it
              requires to define <i class="parameter"><tt>LACK_OF_ATOF_IN_DMC_PATCH</tt></i>
            </p><p>
              there is no inversed hyperbolic functions so it
              requires to define <i class="parameter"><tt>NEED_INVHYP</tt></i>
            </p><p>
              there is no <tt class="function">unlink</tt> in standard libraries so it
              requires to define <i class="parameter"><tt>DELETE_FILE</tt></i> as <tt class="function">remove</tt>
            </p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="watcomc"></a>5.2.1.6. Watcom C++</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.openwatcom.org</p></dd><dt><span class="term">Target</span></dt><dd><p>windows dedicated but non version tested yet</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://www.openwatcom.org/download/download_licenses.html</p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://www.openwatcom.org/support/reference_content.html</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://www.openwatcom.org/support/newsgroups_content.html</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__WATCOMC__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              there are some problems in STL port so this compiler was not forced to correctly compile <span class="trademark">POV-Ray</span>&#8482; yet,
              however its move to open source project makes its future
            </p><p>
              currently available patch 11.0c version is supposed to be an upgrade but can be installed
              without previous version
            </p></dd></dl></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="mac_compile"></a>5.2.2. compiling on Macintosh systems</h3></div></div><div></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="metrowerks"></a>5.2.2.1. Metrowerks CodeWarrior</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://www.metrowerks.com</p></dd><dt><span class="term">Target</span></dt><dd><p>Apple Macintosh PowerPC Carbon and Classic versions tested.
            Windows not tested but possible.</p></dd><dt><span class="term">Binaries</span></dt><dd><p>http://store.metrowerks.com/</p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://www.metrowerks.com/MW/Develop/Desktop/Macintosh/Default.htm</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://www.metrowerks.com/MW/Support/Newsgroups/default.htm</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">__MWERKS__</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              currently available update 8.3
            </p></dd></dl></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="apple"></a>5.2.2.2. Apple Project Builder for Mac OS X. Free development environment</h4></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term">Main URL</span></dt><dd><p>http://developer.apple.com/tools/projectbuilder/index.html</p></dd><dt><span class="term">Target</span></dt><dd><p>
              no versions have been ported to Project Builder yet.
            </p></dd><dt><span class="term">Binaries</span></dt><dd><p>
              http://developer.apple.com/macosx/
             </p><p>
              you have to join ADC to be able to download. membership however is free.
             </p></dd><dt><span class="term">Documentation</span></dt><dd><p>http://developer.apple.com/macosx/gettingstarted/index.html</p></dd><dt><span class="term">Dedicated forums</span></dt><dd><p>http://www.lists.apple.com/mailman/listinfo/projectbuilder-users#Subscribe</p></dd><dt><span class="term">Predefined macros</span></dt><dd><p><tt class="function">?</tt></p></dd><dt><span class="term">Notes</span></dt><dd><p>
              you need this package in order to build Darwin (UNIX) binaries.
            </p></dd></dl></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="unix_compile"></a>5.2.3. compiling on Unix systems</h3></div></div><div></div></div><p xmlns="">
      The Unix source package of MegaPOV 1.1 uses the same build system as the
      official <span class="trademark">POV-Ray</span>&#8482; 3.6 package.  You should be able to compile MegaPOV
      by calling the <tt class="filename">configure</tt> script on most systems.
      More information can be found in the <tt class="filename">README</tt> file
      of the source package.
    </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="parser"></a>5.3. Parser</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="internals_tokens"></a>5.3.1. Adding tokens</h3></div></div><div></div></div><p xmlns="">
    Whatever is changed in <span xmlns="" class="trademark">POV-Ray</span>&#8482; sources, it is probably that new keywords to the parser have to be added.
    To call your new keyword as <i xmlns="" class="parameter"><tt>NEW_KEYWORD_TOKEN</tt></i> we have to open <tt xmlns="" class="filename">parse.h</tt>
    and find enumerated tokens within <tt xmlns="" class="function">TOKEN_IDS</tt>. Entries in this list are sorted mostly by usage. 
    </p><pre xmlns="" class="programlisting">enum TOKEN_IDS
{
  ABS_TOKEN = 0,
  :
  :
  #ifdef USAGE_WITH_NEW_KEYWORD_PATCH
  NEW_KEYWORD_TOKEN,
  #endif
  :
  :
};</pre><p xmlns="">
    Once integer identifier is added we have to connect <i xmlns="" class="parameter"><tt>NEW_KEYWORD_TOKEN</tt></i> with string
    for proper parsing. This connection is realized via <tt xmlns="" class="function">Reserved_Words</tt> array in
    <tt xmlns="" class="filename">tokenize.cpp</tt>. 
  </p><pre xmlns="" class="programlisting">RESERVED_WORD <i class="parameter"><tt>Reserved_Words</tt></i>[<i class="parameter"><tt>LAST_TOKEN</tt></i>] = {
  {<i class="parameter"><tt>AA_THRESHOLD_TOKEN</tt></i>, "aa_threshold"},
  :
  :
  #ifdef USAGE_WITH_NEW_KEYWORD_PATCH
  {<i class="parameter"><tt>NEW_KEYWORD_TOKEN</tt></i>, "new_keyword" },
  #endif
  :
  :
};</pre><p xmlns="">
  </p><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">
      Placing of entry into <i xmlns="" class="parameter"><tt>Reserved_Words</tt></i> table in <tt xmlns="" class="filename">tokenize.cpp</tt> does not
      require any special order, but adding integer identifier into <tt xmlns="" class="function">TOKEN_IDS</tt> structure
      in <tt xmlns="" class="filename">parse.h</tt> is connected with type of data returned by usage of added keywords.
      They have to be located in following order:
      </p><pre class="programlisting">enum <i class="parameter"><tt>TOKEN_IDS</tt></i>
{
  /* tokens to be used when float value is expected from here */
  <i class="parameter"><tt>ABS_TOKEN</tt></i> = 0,
  <i class="parameter"><tt>ATAN_TOKEN</tt></i>,
  :
  <i class="parameter"><tt>FLOAT_FUNCT_TOKEN</tt></i>,
  /* tokens to be used when vector value is expected from here */
  <i class="parameter"><tt>VAXIS_ROTATE_TOKEN</tt></i>,
  :
  <i class="parameter"><tt>VECTOR_FUNCT_TOKEN</tt></i>,
  /* tokens to be used when color value is expected from here */
  <i class="parameter"><tt>ALPHA_TOKEN</tt></i>,
  :
  <i class="parameter"><tt>COLOUR_KEY_TOKEN</tt></i>,
  /* other tokens from here */
  :
  /* <i class="parameter"><tt>LAST_TOKEN</tt></i> has to be the last */
  <i class="parameter"><tt>LAST_TOKEN</tt></i>
};</pre><p xmlns="">
    </p></td></tr></table></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="internals_patterns"></a>5.4. Patterns</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="internals_mem_patterns"></a>5.4.1. Reducing memory usage</h3></div><div><div class="author"><h3 class="author"><span class="firstname">Yvo</span> <span class="surname">Smellenbergh</span></h3></div></div></div><div></div></div><p xmlns="">
    MegaPOV introduces a new patch named 'LESS_MEMORY_IN_PATTERNS_PATCH' to
    reduce the amount of memory needed for each pattern.
    This is done by replacing the structs in the union <i class="parameter"><tt>Vals</tt></i> by pointers.
    The original size of <i class="parameter"><tt>Vals</tt></i> was about 104 bytes, occupied by the crackle pattern.
  </p><p xmlns="">
    By using pointers, the size is reduced to 4 bytes plus the size of the data required
    for a specific pattern.
    If for example Function pattern is used, the size of <i class="parameter"><tt>Vals</tt></i> is 4 plus the size for the 
    2 pointers which is 8.
    This total of 12 is a whole lot less than the original 104!
    This patch will increase the amount of memory used if only crackle is used. However, 
    this is unlikely to happen.
  </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="adding_patterns"></a>5.4.1.1. Adding new patterns</h4></div></div><div></div></div><p xmlns="">
    Because MegaPOV is designed to turn on and off each patch separately, you must be 
    careful whenever a patch is added.
    This patch changes many parts of the code and especially the definition of 
    <i xmlns="" class="parameter"><tt>TPATTERN_FIELDS</tt></i> is a bit tricky.
    For example, the ANGLE_OF_INCIDENCE_PATCH is added to the <i xmlns="" class="parameter"><tt>TPATTERN_FIELDS
    </tt></i> definition like this in <tt xmlns="" class="filename">frame.h</tt>.
    First you define it like this:
      
</p><pre xmlns="" class="programlisting">#ifdef ANGLE_OF_INCIDENCE_PATCH
  #ifdef LESS_MEMORY_IN_PATTERNS_PATCH
    typedef struct  {  VECTOR AOI_origin;  unsigned char pt_fixed;
    }AOI, *AOIPTR ;
    #define <i class="parameter"><tt>AngleOfIncidenceDef</tt></i>  AOIPTR Aoi;
  #else
   #define <i class="parameter"><tt>AngleOfIncidenceDef</tt></i> struct { VECTOR AOI_origin; unsigned char pt_fixed; } Aoi;
  #endif
#else //ANGLE_OF_INCIDENCE_PATCH
  #define <i class="parameter"><tt>AngleOfIncidenceDef</tt></i>
 #endif</pre><p xmlns="">
    and then add it to the <i xmlns="" class="parameter"><tt>TPATTERN_FIELDS</tt></i> definition like this:
 </p><pre xmlns="" class="programlisting">#define <i class="parameter"><tt>TPATTERN_FIELDS</tt></i>       \
 unsigned short Type, Wave_Type, Flags; \
 :            \
 union {                     \
   DENSITY_FILE *Density_File; \
   : \
   <i class="parameter"><tt>AngleOfIncidenceDef</tt></i> \
   : \
   ProjectionDef \
 } Vals;</pre><p xmlns=""> 
    <i xmlns="" class="parameter"><tt>AngleOfIncidenceDef</tt></i> is always defined to avoid two definitions
    for <i xmlns="" class="parameter"><tt>TPATTERN_FIELDS</tt></i>.
    If ANGLE_OF_INCIDENCE_PATCH isn't defined, <i xmlns="" class="parameter"><tt>AngleOfIncidenceDef</tt></i> 
    is empty and is ignored, if ANGLE_OF_INCIDENCE_PATCH is defined, <i xmlns="" class="parameter"><tt>AngleOfIncidenceDef
    </tt></i> is a pointer or a struct, depending on whether LESS_MEMORY_IN_PATTERNS_PATCH is 
    defined or not.
  </p><p xmlns="">
    This leaves us with the problem of accessing the members of the members of <i xmlns="" class="parameter"><tt>Vals</tt></i>.
    In <tt xmlns="" class="filename">frame.h</tt> LESS_MEMORY_PATCH_MO is defined like this:
</p><pre xmlns="" class="programlisting">#ifdef LESS_MEMORY_IN_PATTERNS_PATCH
  #define LESS_MEMORY_PATCH_MO -&gt;
#else
  #define LESS_MEMORY_PATCH_MO .
#endif</pre><p xmlns="">
    Whenever you access a member from an element of <i xmlns="" class="parameter"><tt>Vals</tt></i> you use
</p><pre xmlns="" class="programlisting">New-&gt;Vals.Crackle LESS_MEMORY_PATCH_MO lastseed = 0x8000000;</pre><p xmlns="">
    which results in 
</p><pre xmlns="" class="programlisting">New-&gt;Vals.Crackle.lastseed = 0x8000000;
or
New-&gt;Vals.Crackle-&gt;lastseed = 0x8000000;</pre><p xmlns="">
    depending on the state of the switch LESS_MEMORY_IN_PATTERNS_PATCH.
  </p><p xmlns="">
    For each pattern added, which uses a pointer, memory is allocated in the following functions:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="filename">parstxtr.cpp</tt> - Parse_Pattern();</li><li><tt class="filename">pattern.cpp</tt> - Copy_TPat_Fields();</li></ul></div><p xmlns="">
    Memory is freed for each new pattern in:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><tt class="filename">pattern.cpp</tt> - Destroy_TPat_Fields();</li></ul></div><p xmlns="">
    The best way to find all necessary changes is to find all occurrences of one patch and take a look on how
    it is implemented.
    </p></div></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="internals_expressions"></a>5.5. Expressions</h2></div></div><div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="internals_polynomials"></a>5.5.1. Polynomial solver</h3></div></div><div></div></div><p xmlns="">
    Since years there was a polynomial solver builded in the <span class="trademark">POV-Ray</span>&#8482; sources. Unfortunately
    this tool was only for the intersection calculations in the raytracing engine. My idea was to
    create a gate between SDL and this existing solver.
  </p><p xmlns="">
    All changes required for this feature are marked with <tt class="function">POLYNOMIAL_SOLVER_PATCH</tt>
  </p><p xmlns="">
    The polynomial solver in SDL was designed only as a gate to an already implemented feature.
    It was used previously only for the intersection point. Every next intersection point is almost
    always different from the previous one because it is calculated with different polynomial
    equations. In the case of the polynomial solver accessed via SDL in its proposed form it is
    possible that it is called several times: first for the number of roots and next for each root.
    That's why before the access to old solver polynomials are cached now (only for SDL usage). This
    is done with the function <tt xmlns="" class="function">buffered_polynomial_solver()</tt> in the
    <tt xmlns="" class="filename">polysolv.cpp</tt> file. The whole change was splitted into three parts:
    </p><div xmlns="" class="itemizedlist"><ul type="disc"><li>add two additional tokens to the parser (see <a href="#internals_tokens" title="5.3.1. Adding tokens">Section 5.3.1, &#8220;Adding tokens&#8221;</a>).</li><li>force parser to call <tt class="function">buffered_polynomial_solver()</tt> with
        the appropriate parameters from the script</li><li>force VM to call <tt class="function">buffered_polynomial_solver()</tt> with the
        appropriate parameters from the function engine</li></ul></div><p xmlns="">
  </p><p xmlns="">
    The complete operations within classic POV-Ray parser was placed inside 
    <tt class="function">Parse_Num_Factor()</tt> in <tt class="filename">express.cpp</tt>.
    The order of polynomial is read from the number of parameters there and then 
    <tt class="function">buffered_polynomial_solver()</tt> is called.
  </p><p xmlns="">
    In case of VM in function engine this was a much more difficult operation.
    <tt class="function">n_roots</tt> and <tt class="function">nth_root</tt> have variable number of parameters.
    It is different than other functions works and it required new handling.
    First new entries were added at beginning of <tt class="function">POVFPU_Opcodes</tt>
    structure in <tt class="filename">fnpovfpu.cpp</tt>. Then a gate between parser and
    precompiled opcodes was introduced to <tt class="function">FNCode::compile_call</tt>
    in <tt class="filename">fncode.cpp</tt> with appropriate calls to dedicated compilers
    for new functions. Finally runtime code for new opcodes was added to
    <tt class="function">POVFPU_RunDefault</tt> in <tt class="filename">fnpovfpu.cpp</tt>.
  </p></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="multiformat_documentation"></a>5.6. Multi-format Documentation with DocBook</h2></div></div><div></div></div><p xmlns="">
    DocBook is a set of definitions (DTD) for either
    <a href="http://www.oasis-open.org/committees/docbook/xml/" target="_top">XML</a> and
    <a href="http://www.oasis-open.org/committees/docbook/sgml/" target="_top">SGML</a>
    languages particularly well-suited for books and papers about computer hardware and software.
  </p><p xmlns="">
    Its over ten years long history proved its flexibility and usability in many projects.
    In particular DocBook is used in O'Reilly, xfree86, GNOME, KDE, FreeBSD,
    The Linux Documentation Project, PHP...
  </p><p xmlns="">
    DocBook format is platform independent, concerned on meaning and different parts can be developed
    independently so since MegaPOV 1.0 DocBook is also used for the MegaPOV documentation.
    Usually features included in MegaPOV are included in whole package together with original
    documentation delivered by the author of a particular patch. It would speedup MegaPOV creation if
    the authors of patches could deliver their documentation in DocBook format. Such documentation is free from decoration,
    Java Script effects and other additions. Following chapter is filled with guidelines for those authors who want to
    speedup our documentation creation. Our experience can also help you to create
    your own documentation for other projects.
  </p><p xmlns="">
    Before you will start work with DocBook it could be good to make review on:
    </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><a href="http://www.docbook.org/" target="_top">DocBook: The Definitive Guide.</a></li><li><a href="http://www.dpawson.co.uk/docbook/" target="_top">DocBook FAQ</a></li><li><a href="http://supportweb.cs.bham.ac.uk/documentation/tutorials/docsystem/build/tutorials/docbooksys/docbooksyshome.html" target="_top">Installing And Using DocBook</a></li></ul></div><p xmlns="">
    to recognize features of DocBook and its syntax.
    No doubts it is much easier to play with DocBook when you have some HTML experience.
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="docbook_environment"></a>5.6.1. Environment for DocBook documentation</h3></div></div><div></div></div><p xmlns="">
      To work with DocBook you have to setup your environment for it. First thing you may be interested
      is definition of DocBook (DTD). MegaPOV uses XML (http://www.oasis-open.org/committees/docbook/xml/4.2/docbook-xml-4.2.zip)
      version because SGML one will be dropped in the future. 
    </p><p xmlns="">
      In order to get good environment you have to collect tools for:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li><p>
            validating:
            </p><div class="itemizedlist"><ul type="circle" compact><li>XMLLINT - http://www.jclark.com/sp/nsgmls.htm</li><li>XMLLINT - http://xmlsoft.org/xmldtd.html</li><li>XMLVALID - http://www.elcel.com/products/xmlvalid.html</li></ul></div><p>
            In case of MegaPOV XMLVALID because it seems the most stable and fastest but it is available
            only for Windows console.
          </p></li><li><p>
            XSLT processing and converting into other formats:
            </p><div class="itemizedlist"><ul type="circle" compact><li>XSLTPROC - http://xmlsoft.org/XSLT/</li><li>SAXON - http://saxon.sourceforge.net/</li><li>XALAN - http://xml.apache.org/xalan-j/</li></ul></div><p>
            In case of MegaPOV either XSLTPROC and SAXON are used. In case of PDF output also
            FOP (http://xml.apache.org/fop/) was used.
          </p></li></ul></div><p xmlns="">
      Other free XML tools can be found at http://www.garshol.priv.no/download/xmltools/.
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="docbook_editing"></a>5.6.2. Editing DocBook documentation</h3></div></div><div></div></div><p xmlns="">
      You do not need any special tool to edit DocBook files. Any text or HTML editor is enough. Some
      editors has some support for XML files (like Win-POV) however it is not required.
    </p><p xmlns="">
      For simple examples of DocBook files please look at:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>http://www.docbook.org/tdg/en/html/ch04.html#simple.document</li><li>http://xslt-process.sourceforge.net/docbook-example.xml</li></ul></div><p xmlns="">
      It is not purpose of this documentation to describe how DocBook document should look like however
      in order to get better understanding of DocBook syntax complete sources of this documentation are
      available within MegaPOV site.
    </p><p xmlns="">
      For simpler usage <tt xmlns="" class="filename">book.xml</tt> introduces set of entities with:
      </p><div xmlns="" class="itemizedlist"><ul type="disc" compact><li>names of persons</li><li>names of keywords and options</li><li>references to main parts</li></ul></div><p xmlns="">
      Maintaining it that way makes editing easier because we can then simple change markup for
      all tokens in all places editing only one file. Also patch writer can use those entities to make it easier
      to connect various documentations from various patch writers into one documentation.
    </p></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="docbook_conversion"></a>5.6.3. Converting DocBook documents</h3></div></div><div></div></div><p xmlns="">
      In order to convert DocBook documentation into different formats you need ready for use style-sheets and templates
      available within http://docbook.sourceforge.net/projects/xsl/ repository. They delivers XSLT files to perform
      conversion into several formats. Conversion achieved this way is not perfect because authors can't decide what is
      your favorite appearance of documentation. You have to use so called "customization layer" over their files.
      MegaPOV has own customization layer. You can find it (<tt class="filename">*.xsl</tt>) where whole sources of documentation are.
    </p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="appendices"></a>Chapter 6. Appendices</h2></div></div><div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#megapov_authors">6.1. MegaPOV-Team</a></span></dt><dt><span class="section"><a href="#contribution">6.2. Contribution</a></span></dt><dt><span class="section"><a href="#old_megapov">6.3. MegaPOV before POV-Ray 3.6</a></span></dt><dd><dl><dt><span class="section"><a href="#id2600959">6.3.1. MegaPOV history</a></span></dt><dt><span class="section"><a href="#old_authors">6.3.2. Authors of patches in MegaPOV below version 1.0</a></span></dt></dl></dd></dl></div><p>
    Here is set of appendices
  </p><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="megapov_authors"></a>6.1. MegaPOV-Team</h2></div></div><div></div></div><p xmlns="">
      As long as we have to cooperate we can call ourselves The Team.
      So let's enumerate ourselves :-)
    </p><div xmlns="" class="table"><a name="id2598230"></a><p class="title"><b>Table 6.1. Current MegaPOV-Team Members</b></p><table summary="Current MegaPOV-Team Members" border="0" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">NAME</th><th style="border-bottom: 0.5pt solid ; ">PARTICIPATION</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><span class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></span></td><td style="border-bottom: 0.5pt solid ; ">Linux binaries, developer, documentation</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><span class="author"><span class="firstname">Nathan</span> <span class="surname">Kopp</span></span></td><td style="border-bottom: 0.5pt solid ; ">Win32 GUI binaries, good soul</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><span class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></span></td><td style="border-bottom: 0.5pt solid ; ">developer, documentation</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><span class="author"><span class="firstname">René</span> <span class="surname">Smellenbergh</span></span></td><td style="border-bottom: 0.5pt solid ; ">samples, documentation</td></tr><tr><td style="border-right: 0.5pt solid ; "><span class="author"><span class="firstname">Yvo</span> <span class="surname">Smellenbergh</span></span></td><td style="">Mac binaries, developer, documentation</td></tr></tbody></table></div><div xmlns="" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="icons/important.gif"></td><th align="left">Important</th></tr><tr><td colspan="2" align="left" valign="top"><p>
        Remember! We are not the authors of the <span class="trademark">POV-Ray</span>&#8482; package.
        <span class="trademark">POV-Ray</span>&#8482; was made and is maintained by the <span class="trademark">POV-Team</span>&#8482;.
        Do not bother them about MegaPOV features and do not ask us
        about <span class="trademark">POV-Ray</span>&#8482; itself.
      </p></td></tr></table></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="contribution"></a>6.2. Contribution</h2></div></div><div></div></div><p xmlns="">
      It would be impossible to create MegaPOV without the outstanding amount of work
      of all contributors listed below:
    </p><div xmlns="" class="variablelist"><dl><dt><span class="term"><span class="author"><span class="firstname">Michael</span> <span class="surname">Andrews</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>idea for randomized radiosity sample directions</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Christophe</span> <span class="surname">Bouffartigue</span></span></span></dt><dd><p>christophe.bouffartigue@nanterre.marelli.fr</p><p><a href="http://tofbouf.free.fr" target="_top">http://tofbouf.free.fr</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>cloth-ray module</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Chris</span> <span class="surname">Colefax</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>MegaPOV icon design</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">John</span> <span class="surname">Haggerty</span></span></span></dt><dd><p><a href="http://www.slimeland.com/" target="_top">http://www.slimeland.com/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>bug-fix for accuracy in normal statement</li><li>smooth height field bugfix</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Christoph</span> <span class="surname">Hormann</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:chris_hormann@gmx.de">chris_hormann@gmx.de</a>&gt;</tt></p><p><a href="http://www.tu-bs.de/~y0013390/" target="_top">http://www.tu-bs.de/~y0013390/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>mechanics simulation system</li><li>HDR (High Dynamic Range) image write support (see <a href="#hdr_write" title="2.1.2. HDR (High Dynamic Range) image output">Section 2.1.2, &#8220;HDR (High Dynamic Range) image output&#8221;</a>)</li><li>Radiosity improvements (see <a href="#radiosity" title="2.7.3. Radiosity">Section 2.7.3, &#8220;Radiosity&#8221;</a>)</li><li>Normal modifier for transforms (see <a href="#normal_transform" title="2.2.7.1. The normal modifier for transforms">Section 2.2.7.1, &#8220;The normal modifier for transforms&#8221;</a>)</li><li>Custom tone mapping (see <a href="#tone_mapping" title="2.7.2. Custom tone mapping function">Section 2.7.2, &#8220;Custom tone mapping function&#8221;</a>)</li><li>Area light max_trace_level control (see <a href="#area_light_mtl" title="2.4.5.1. Area Light max_trace_level">Section 2.4.5.1, &#8220;Area Light max_trace_level&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:cjameshuff@earthlink.net">cjameshuff@earthlink.net</a>&gt;</tt></p><p><a href="http://home.earthlink.net/~cjameshuff/" target="_top">http://home.earthlink.net/~cjameshuff/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>#set keyword (see <a href="#set" title="2.2.1.1. Set directive">Section 2.2.1.1, &#8220;Set directive&#8221;</a>)</li><li>glow (see <a href="#glow" title="2.5.1. Glow">Section 2.5.1, &#8220;Glow&#8221;</a>)</li><li>displace warp (see <a href="#displace_warp" title="2.6.4. Displace warp for patterns">Section 2.6.4, &#8220;Displace warp for patterns&#8221;</a>)</li><li>listed pattern (see <a href="#listed_pattern" title="2.6.2. Listed pattern">Section 2.6.2, &#8220;Listed pattern&#8221;</a>)</li><li>noise pigment (see <a href="#noisepigment" title="2.6.5. Noise pigment">Section 2.6.5, &#8220;Noise pigment&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term">Jurjen</span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>transparent inverted normals</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Kari</span> <span class="surname">Kivisalo</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>film exposure simulation (see <a href="#film_exposure" title="2.7.1. Film exposure simulation">Section 2.7.1, &#8220;Film exposure simulation&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Nathan</span> <span class="surname">Kopp</span></span></span></dt><dd><p>Nathan@Kopp.com</p><p><a href="http://www.nathan.kopp.com" target="_top">http://www.nathan.kopp.com</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>unofficial version blocking system</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Vahur</span> <span class="surname">Krouverk</span></span></span></dt><dd><p>vkrouverk at starman.ee</p><p><a href="http://www.profitsoftware.ee/fv/vkhomep.nsf/" target="_top">http://www.profitsoftware.ee/fv/vkhomep.nsf/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>minor additions for Borland compiler</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="surname">Mael</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>halton distribution for radiosity sampling</li><li>reading function for HDR (High Dynamic Range) images (see <a href="#hdr" title="2.6.6. HDR (High Dynamic Range) image type">Section 2.6.6, &#8220;HDR (High Dynamic Range) image type&#8221;</a>)</li><li>Angle of incidence pattern (see <a href="#aoi_pattern" title="2.6.1. Angle of incidence">Section 2.6.1, &#8220;Angle of incidence&#8221;</a>)</li><li>Projection pattern (see <a href="#projection_pattern" title="2.6.3. Projection pattern">Section 2.6.3, &#8220;Projection pattern&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Maciej</span> <span class="surname">Matysiak</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>hosting</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Micha</span> <span class="surname">Riser</span></span></span></dt><dd><p>mriser@gmx.net</p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>boundings in inside tests (see <a href="#inside_bounding" title="2.4.1.1. Bounding used in inside tests">Section 2.4.1.1, &#8220;Bounding used in inside tests&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:abx@abx.art.pl">abx@abx.art.pl</a>&gt;</tt></p><p><a href="http://www.abx.art.pl/pov/patches/" target="_top">http://www.abx.art.pl/pov/patches/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>warning free sources</li><li>shared gray calculations</li><li>minor changes in parametric sources</li><li>New spline types:
                <div class="itemizedlist"><ul type="circle" compact><li><tt class="function">sor_spline</tt> type in splines (see <a href="#sor_spline" title="2.2.6.1. spline follows sor">Section 2.2.6.1, &#8220;spline follows sor&#8221;</a>)</li><li><tt class="function">akima_spline</tt> (see <a href="#akima_spline" title="2.2.6.2. akima spline">Section 2.2.6.2, &#8220;akima spline&#8221;</a>)</li><li><tt class="function">tcb_spline</tt> (see <a href="#tcb_spline" title="2.2.6.3. tcb spline">Section 2.2.6.3, &#8220;tcb spline&#8221;</a>)</li><li>x splines: <tt class="function">basic_x_spline</tt>, <tt class="function">general_x_spline</tt> and
                                     <tt class="function">extended_x_spline</tt> (see <a href="#x_splines" title="2.2.6.4. x splines">Section 2.2.6.4, &#8220;x splines&#8221;</a>)</li></ul></div></li><li>spline accessed like array (see <a href="#spline_like_array" title="2.2.6.5. Spline accessed like array">Section 2.2.6.5, &#8220;Spline accessed like array&#8221;</a>)</li><li><tt class="function">f_triangle</tt> internal function (see <a href="#f_triangle" title="2.2.4.1. f_triangle">Section 2.2.4.1, &#8220;f_triangle&#8221;</a>)</li><li>additional tokens in function syntax (see <a href="#additional_tokens" title="2.2.2.1. Additional tokens in function syntax">Section 2.2.2.1, &#8220;Additional tokens in function syntax&#8221;</a>)</li><li>polynomial solver in parser (see <a href="#polynomial_solver" title="2.2.5. Polynomial solver in parser">Section 2.2.5, &#8220;Polynomial solver in parser&#8221;</a>)</li><li><tt class="function">Frame_Step</tt> feature (see <a href="#frame_step" title="2.1.1. Frame_Step">Section 2.1.1, &#8220;Frame_Step&#8221;</a>)</li><li>changed behavior of radiosity cache in animation (see <a href="#radiosity_cache" title="2.7.3.1. Cache file">Section 2.7.3.1, &#8220;Cache file&#8221;</a>)</li><li>string function with numbered output filename (see <a href="#output_filename" title="2.2.3.3. Filename with frame number">Section 2.2.3.3, &#8220;Filename with frame number&#8221;</a>)</li><li>new <tt class="function">user_defined</tt> camera projection type (see <a href="#user_defined_camera" title="2.3.1. user_defined camera type">Section 2.3.1, &#8220;user_defined camera type&#8221;</a>)</li><li>new <tt class="function">camera_view</tt> pigment type (see <a href="#camera_view" title="2.6.8. New camera_view pigment">Section 2.6.8, &#8220;New camera_view pigment&#8221;</a>)</li><li>sizes of images measurement (see <a href="#images_sizes" title="2.2.3.4. Sizes of images">Section 2.2.3.4, &#8220;Sizes of images&#8221;</a>)</li><li>measurement of dimensions in vectors (see <a href="#vectors_dimensions" title="2.2.3.5. Dimensions of vectors">Section 2.2.3.5, &#8220;Dimensions of vectors&#8221;</a>)</li><li>type checking (see <a href="#is" title="2.2.3.6. Type checking">Section 2.2.3.6, &#8220;Type checking&#8221;</a>)</li><li>post processing feature (see <a href="#post_processing" title="2.7.5. Post processing">Section 2.7.5, &#8220;Post processing&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Yvo &amp; René</span> <span class="surname">Smellenbergh</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:smellenbergh@skynet.be">smellenbergh@skynet.be</a>&gt;</tt></p><p><a href="http://users.skynet.be/smellenbergh/" target="_top">http://users.skynet.be/smellenbergh/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>multi-platform line feed</li><li>max_gradient message correction</li><li>time measurement</li><li>text object alignment</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Massimo</span> <span class="surname">Valentini</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>correct assign functions for colors in some cases</li><li>bugfix for Copy_Flag</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Thomas</span> <span class="surname">Willhalm</span></span></span></dt><dd><p><a href="http://www.thomas.willhalm.de/" target="_top">http://www.thomas.willhalm.de/</a></p><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>fur patch (see <a href="#fur" title="2.5.3. Fur">Section 2.5.3, &#8220;Fur&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd><dt><span class="term"><span class="author"><span class="firstname">Lutz</span> <span class="othername">Peter</span> <span class="surname">Hooge</span></span></span></dt><dd><p xmlns="">
            </p><div class="itemizedlist"><ul type="disc" compact><li>bicubic interpolation for images (see <a href="#bicubic_image" title="2.6.7. Bicubic interpolation for images">Section 2.6.7, &#8220;Bicubic interpolation for images&#8221;</a>)</li></ul></div><p xmlns="">
          </p></dd></dl></div></div><div xmlns="http://www.w3.org/1999/xhtml" class="section_1" lang="en"><div xmlns="" class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="old_megapov"></a>6.3. MegaPOV before <span class="trademark">POV-Ray</span>&#8482; 3.6</h2></div></div><div></div></div><p xmlns="">
  </p><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="id2600959"></a>6.3.1. MegaPOV history</h3></div></div><div></div></div><p xmlns="">
      Here is the history of previous MegaPOV versions, listed for historical reasons and to
      highlight the community character of this software.
    </p><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="changes_in_1_1"></a>6.3.1.1. 8 September 2004 - MegaPOV 1.1</h4></div></div><div></div></div><p xmlns="">
        MegaPOV 1.1 is an update to <span class="trademark">POV-Ray</span>&#8482; 3.6.  Development of <span class="trademark">POV-Ray</span>&#8482; 3.6 took longer than expected so
				MegaPOV 1.1 was delayed as well.  We regret this but on the other hand MegaPOV 1.1 now also comes
				with some useful new features:
      </p><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fur (see <a href="#fur" title="2.5.3. Fur">Section 2.5.3, &#8220;Fur&#8221;</a>)</li><li>Type checking (see <a href="#is" title="2.2.3.6. Type checking">Section 2.2.3.6, &#8220;Type checking&#8221;</a>)</li><li>Measurement of dimensions in vectors (see <a href="#vectors_dimensions" title="2.2.3.5. Dimensions of vectors">Section 2.2.3.5, &#8220;Dimensions of vectors&#8221;</a>)</li><li>New spline types:
        	<div class="itemizedlist"><ul type="disc" compact><li><tt class="function">akima_spline</tt> (see <a href="#akima_spline" title="2.2.6.2. akima spline">Section 2.2.6.2, &#8220;akima spline&#8221;</a>)</li><li><tt class="function">tcb_spline</tt> (see <a href="#tcb_spline" title="2.2.6.3. tcb spline">Section 2.2.6.3, &#8220;tcb spline&#8221;</a>)</li><li>x splines: <tt class="function">basic_x_spline</tt>, <tt class="function">general_x_spline</tt> and
        			<tt class="function">extended_x_spline</tt> (see <a href="#x_splines" title="2.2.6.4. x splines">Section 2.2.6.4, &#8220;x splines&#8221;</a>)</li></ul></div>
        	</li><li>Sizes of images measurement (see <a href="#images_sizes" title="2.2.3.4. Sizes of images">Section 2.2.3.4, &#8220;Sizes of images&#8221;</a>)</li><li>Reduced memory requirements for each object, depending on the type of pattern being
        	used (see <a href="#internals_mem_patterns" title="5.4.1. Reducing memory usage">Section 5.4.1, &#8220;Reducing memory usage&#8221;</a>)</li><li>HDR (High Dynamic Range) image type from MLPov (see <a href="#hdr" title="2.6.6. HDR (High Dynamic Range) image type">Section 2.6.6, &#8220;HDR (High Dynamic Range) image type&#8221;</a>)</li><li>HDR (High Dynamic Range) image write support (see <a href="#hdr_write" title="2.1.2. HDR (High Dynamic Range) image output">Section 2.1.2, &#8220;HDR (High Dynamic Range) image output&#8221;</a>)</li><li>Connection-connection collisions for mechsim patch (see <a href="#mechsim_collision" title="2.7.4.1.3. The collision settings">Section 2.7.4.1.3, &#8220;The collision settings&#8221;</a>)</li><li>Normal modifier for transforms (see <a href="#normal_transform" title="2.2.7.1. The normal modifier for transforms">Section 2.2.7.1, &#8220;The normal modifier for transforms&#8221;</a>)</li><li>String function with numbered output filename (see <a href="#output_filename" title="2.2.3.3. Filename with frame number">Section 2.2.3.3, &#8220;Filename with frame number&#8221;</a>)</li><li>New <tt class="function">user_defined</tt> camera projection type (see <a href="#user_defined_camera" title="2.3.1. user_defined camera type">Section 2.3.1, &#8220;user_defined camera type&#8221;</a>)</li><li>New <tt class="function">camera_view</tt> pigment type (see <a href="#camera_view" title="2.6.8. New camera_view pigment">Section 2.6.8, &#8220;New camera_view pigment&#8221;</a>)</li><li>Angle of incidence pattern from MLPov (see <a href="#aoi_pattern" title="2.6.1. Angle of incidence">Section 2.6.1, &#8220;Angle of incidence&#8221;</a>)</li><li>Projection pattern from MLPov (see <a href="#projection_pattern" title="2.6.3. Projection pattern">Section 2.6.3, &#8220;Projection pattern&#8221;</a>)</li><li>Custom radiosity sampling directions (see <a href="#radiosity_samples" title="2.7.3.2. Custom radiosity sampling directions">Section 2.7.3.2, &#8220;Custom radiosity sampling directions&#8221;</a>)</li><li>Randomized radiosity sampling directions (see <a href="#radiosity_randomize" title="2.7.3.3. Randomized radiosity sampling directions">Section 2.7.3.3, &#8220;Randomized radiosity sampling directions&#8221;</a>)</li><li>Reintroduced <tt class="function">motion_blur</tt> from MegaPOV 0.7 with new <tt class="function">type</tt> feature
        	(see <a href="#motion_blur" title="2.5.2. Motion blur">Section 2.5.2, &#8220;Motion blur&#8221;</a>)</li><li>New post processing feature (see <a href="#post_processing" title="2.7.5. Post processing">Section 2.7.5, &#8220;Post processing&#8221;</a>)</li><li>Fixed bug of MegaPOV 1.0 concerning spline identifiers </li></ol></div><p xmlns="">
        Some of the patches from MegaPOV 1.0 are now included in the <span class="trademark">POV-Ray</span>&#8482; 3.6 update, and some have become obsolete because of changes
        in <span class="trademark">POV-Ray</span>&#8482; 3.6. The parts concerning these changes have been removed from this manual, because they are no longer considered as
        "patches". Here is an overview:
      </p><div xmlns="" class="orderedlist"><ol type="1" compact><li>Option <tt class="function">End_Row</tt> with value <i class="parameter"><tt>1</tt></i></li><li>UV mapping in <tt class="function">torus</tt> object;</li><li>UV mapping in <tt class="function">parametric</tt> object;</li><li>Fix for using splines in function;</li><li>Fix for smooth height_field.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="changes_in_1_0"></a>6.3.1.2. 31 December 2002 - MegaPOV 1.0</h4></div></div><div></div></div><p xmlns="">
        MegaPOV 1.0 was a fresh start, based on the sources of <span class="trademark">POV-Ray</span>&#8482; 3.5. This means that not all features of MegaPOV 0.7
        were implemented. Another consequence was that for several features the new syntax of <span class="trademark">POV-Ray</span>&#8482; 3.5 is
        now used. Here is a list of added features:
      </p><div xmlns="" class="orderedlist"><ol type="1" compact><li><p xmlns="">
            Features in MegaPOV 0.7 that didn't make it in <span xmlns="" class="trademark">POV-Ray</span>&#8482; 3.5, but which are back in MegaPOV 1.0;
            </p><div class="itemizedlist"><ul type="disc" compact><li>Listed pattern (before solid pattern) (see <a href="#listed_pattern" title="2.6.2. Listed pattern">Section 2.6.2, &#8220;Listed pattern&#8221;</a>)</li><li>Displace warp for patterns (see <a href="#displace_warp" title="2.6.4. Displace warp for patterns">Section 2.6.4, &#8220;Displace warp for patterns&#8221;</a>)</li><li>Glow (see <a href="#glow" title="2.5.1. Glow">Section 2.5.1, &#8220;Glow&#8221;</a>)</li><li>Time and date functions (see <a href="#time_date" title="2.2.3.1. Time and date functions">Section 2.2.3.1, &#8220;Time and date functions&#8221;</a>)</li><li>Timer functions (see <a href="#timer" title="2.2.3.2. Timer function">Section 2.2.3.2, &#8220;Timer function&#8221;</a>)</li><li>Set directive (see <a href="#set" title="2.2.1.1. Set directive">Section 2.2.1.1, &#8220;Set directive&#8221;</a>)</li><li>Noise_pigment (see <a href="#noisepigment" title="2.6.5. Noise pigment">Section 2.6.5, &#8220;Noise pigment&#8221;</a>)</li></ul></div><p xmlns="">
          </p></li><li><p xmlns="">
            <a xmlns="" href="http://www.abx.art.pl/pov/popov" target="_top">PoPOV</a> has joined MegaPOV.
            </p><div class="itemizedlist"><ul type="disc" compact><li>Option <tt class="function">End_Row</tt> with value <i class="parameter"><tt>1</tt></i> (<span class="author"><span class="firstname">William</span> <span class="surname">Pokorny</span></span>), now in <span class="trademark">POV-Ray</span>&#8482;</li><li>Bounding is used in inside tests (see <a href="#inside_bounding" title="2.4.1.1. Bounding used in inside tests">Section 2.4.1.1, &#8220;Bounding used in inside tests&#8221;</a>)</li><li>Internal function <tt class="function">f_triangle</tt> (see <a href="#f_triangle" title="2.2.4.1. f_triangle">Section 2.2.4.1, &#8220;f_triangle&#8221;</a>)</li><li><tt class="function">sor_spline</tt> type in splines (see <a href="#sor_spline" title="2.2.6.1. spline follows sor">Section 2.2.6.1, &#8220;spline follows sor&#8221;</a>)</li><li>Spline accessed like array (see <a href="#spline_like_array" title="2.2.6.5. Spline accessed like array">Section 2.2.6.5, &#8220;Spline accessed like array&#8221;</a>)</li><li>UV mapping in <tt class="function">torus</tt> object (<span class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></span>), now in <span class="trademark">POV-Ray</span>&#8482;</li><li>UV mapping in <tt class="function">parametric</tt> object (<span class="author"><span class="firstname">W&#322;odzimierz</span> <span class="othername">ABX</span> <span class="surname">Skiba</span></span>), now in <span class="trademark">POV-Ray</span>&#8482;</li></ul></div><p xmlns="">
          </p></li><li>Additional tokens in function syntax (see <a href="#additional_tokens" title="2.2.2.1. Additional tokens in function syntax">Section 2.2.2.1, &#8220;Additional tokens in function syntax&#8221;</a>)</li><li>Text object alignment (horizontal and vertical) (see <a href="#text_align" title="2.4.2.1. Text enhancements">Section 2.4.2.1, &#8220;Text enhancements&#8221;</a>)</li><li>Polynomial solver in parser (see <a href="#polynomial_solver" title="2.2.5. Polynomial solver in parser">Section 2.2.5, &#8220;Polynomial solver in parser&#8221;</a>)</li><li>Message control for <tt class="function">max_gradient</tt> in <tt class="function">isosurface</tt> (see <a href="#iso_message" title="2.4.4.1. Control of max gradient message">Section 2.4.4.1, &#8220;Control of max gradient message&#8221;</a>)</li><li>Film exposure simulation (see <a href="#film_exposure" title="2.7.1. Film exposure simulation">Section 2.7.1, &#8220;Film exposure simulation&#8221;</a>)</li><li><tt class="function">Frame_Step</tt> feature (see <a href="#frame_step" title="2.1.1. Frame_Step">Section 2.1.1, &#8220;Frame_Step&#8221;</a>)</li><li>Changed behavior of radiosity cache in animation (see <a href="#radiosity_cache" title="2.7.3.1. Cache file">Section 2.7.3.1, &#8220;Cache file&#8221;</a>)</li><li>The Clothray cloth simulation patch (see <a href="#cloth" title="2.4.3. Cloth simulation">Section 2.4.3, &#8220;Cloth simulation&#8221;</a>)</li><li>The Sim-POV mechanics simulation patch (see <a href="#mechsim" title="2.7.4. Mechanics simulation patch">Section 2.7.4, &#8220;Mechanics simulation patch&#8221;</a>)</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2603131"></a>6.3.1.3. February 5, 2001 - MegaPOV 0.7</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fixed bug in media method 3 (by <span class="author"><span class="firstname">Jérôme</span> <span class="surname">Berger</span></span>) (9.2.9)</li><li>Fixed bug in isosurface causing a crash when parsing exp without braces (9.2.9)</li><li>Fixed bug in isosurface intersections. Spherical containers were not translated correctly (9.2.9)</li><li>Fixed bug in isosurface difference, where the differencing object enclosed the original completely: left a ghost shadow (9.2.9)</li><li>Fixed the stars post_process filter; it now adds to the background instead of replacing it (12.16)</li><li>Fixed bug with ellipsoid, removed artifacts that appeared in some cases (by <span class="author"><span class="firstname">Jérôme</span> <span class="surname">Grimbert</span></span>) (9.2.9)</li><li>Fixed a bug, reported by Nicolas Calimet, in the Transform Patch (9.2.9)</li><li>Fixed bug with uv_mapping when uv_vectors were not specified (9.2.9)</li><li>Input files for idat_3D can be in all library paths. Previously they had to be located in the same folder as the scene file. All paths are searched now just like it is done for any include file</li><li>Fixed memory problems when using functions in animations: They are now destroyed after every frame (9.2.9)</li><li>Fixed bug that caused a crash when PostProcess was running out of memory: error given now</li><li>Fixed bug in copy_splines</li><li>Fixed some bugs in spline, added SPLINE_IDENT(T, TYPE) syntax</li><li>Fixed some glow bugs("size" should work properly now).</li><li>Added the sample_spacing patch in media (by <span class="author"><span class="firstname">Jérôme</span> <span class="surname">Berger</span></span>) (4.2)</li><li>Added a new type of emitting media to be used on clear backgrounds (by <span class="author"><span class="firstname">Jérôme</span> <span class="surname">Berger</span></span>) (4.3)</li><li>Added new post_process filters: "curves" (12.4), "limit_brightness" (12.9) and "raw_color" (12.14)</li><li>Added a new directive #set to change variables (by <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>) (9.22)</li><li>Added ability to apply transforms to warps.</li><li>Added "spline_wave" waveform for patterns.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2603331"></a>6.3.1.4. October 15, 2000 - MegaPOV 0.6a</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Demo scene images are available on-line, so you can see what MegaPOV has to offer.   They can be viewed at <span class="author"><span class="surname">Smellenbergh</span></span>'s site.  Click on the "Demos" link in the navigation bar on the left.   Direct link is here.</li><li>Fixed a bug in the proximity patch. If no sample_weight vector was given it was filled with random values, giving different results for each rendering.</li><li>In isosurface statistics, max gradient is reported again</li><li>Fixed more memory leaks in isosurface</li><li>julia sqr and power (^) now allowed without version unofficial xx specifier: it is a legal keyword in <span class="trademark">POV-Ray</span>&#8482; 3.1</li><li>In the manual updated section 8.9 displace warp</li><li>In the manual corrected  9.20: the formula used is: Red*0.3+Green*0.59+Blue*0.11</li><li>In DoPostProcess() in postproc.c give an error if for some reason the input file could not be opened. Previously MegaPOV would crash.</li><li>density file is now positioned from 0 to 1 again. We changed that in 0.6 but obviously this was incorrect. It crashed MP often too. Files written by the df3 patch are now flipped so that the result is correct.</li><li>df3 in i_dat3d now works again. This was listed as fixed in MP 0.6 but only now in 0.6a this is really fixed!</li><li>Updated the displacement warp patch to MP+0.3.2. This adds the type keyword.</li><li>Fixed bug in transform when used like this:</li><li>transform { DeclaredMyTrans}</li><li>Fixed bug with photons+dispersion if no color_map specified for light_source</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2603464"></a>6.3.1.5. October 1, 2000 - MegaPOV 0.6</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Spline identifiers can now be passed as macro parameters.</li><li>Added Mike Hough's updated uv_mapping (takes now all four corners) for bicubic_patches (8.6.4).</li><li>Added keep_data_file for post processing to allow continue (12).</li><li>Added filter all and transmit all for 24 bit images (9.2.11).</li><li>Added possibility to use phase and frequency keywords in an image_map (8.10).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s PigmentWarpPatch (displacement warp) (8.9).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s noise_pigment (8.3.7).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s extensions to the blob pattern (8.3.1).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s extensions to the proximity pattern (sample_weighting and method 3) (8.3.11).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s new Math Post_process patches (12.8).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s atan_wave patch (8.11).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s vwarp() patch (9.18).</li><li>Added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s glow patch (9.21).</li><li>Added documentation for <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s solid pattern in the manual (8.3.15).</li><li>Added new keyword clock_on (1.0 is on, 0.0 is not on) (9.3).</li><li>Added Phil Carig's (Pod) df3 output patch (9.20).</li><li>Created a new chapter in the docs to list all authors with there e-mail address and URLs if available (14).</li><li>Fixed a bug in userio.c in Destroy_Text_Streams() to close text stream files</li><li>Fixed bug in image map when using 24 bit images.</li><li>Fixed bug in Compute_Disc_BBox().</li><li>Allowed nested macro's again.</li><li>Fixed bug in interior_texture with CSG.</li><li>Fixed bug with AxisRotFixPatch.</li><li>Fixed bug in idat 3d (isosurface).</li><li>Fixed bug in eval_pigment when declared. Crashed when no color map was specified.</li><li>Fixed bug in persistent variables.</li><li>Fixed cylinder cameras again.</li><li>Fixed scaling problem in blob.</li><li>Fixed a few things in blob pattern/pigment (threshold, strength, syntax, pigment, warnings).</li><li>Fixed occasional artifacts in superquadratic ellipsoid.</li><li>Fixed several memory leaks.</li><li>Fixed bug in corner-interpolated meshes (9.2.12)</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2603760"></a>6.3.1.6. June 1, 2000 - MegaPOV 0.5a</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>removed GIF support (potential legal issues regarding the Unisys patent)</li><li>fixed docs for pigment_pattern</li><li>fixed disc problems (removed fastdiscpatch)</li><li>fixed long filename support in the Windows version</li><li>fixed bug with photons on average texture</li><li>fixed bug with media method 3 when samples = 1</li><li>fixed bug with parsing backwards compatibility and unofficial version number</li><li>added fastspherepatch</li><li>added fastpolypatch</li><li>fixed "bug" with mesh (MegaPOV did not ignore degenerate triangles if uv mapping was used in the triangle)</li><li>fixed bug with ttf</li><li>fixed bug with csqr</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2603853"></a>6.3.1.7. May 15, 2000 - MegaPOV 0.5</h4></div><div><h5 class="subtitle">24 bug fixes, 5 new features, 6 enhancements, 5 speed optimizations, 1 removal</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>added new filters by <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span> for post processing: add, clip_colors, color_matrix, convolution_matrix, exponent, find_edges, invert, multiply, normal, patterned_blur, posterize, stars.</li><li>added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s inverse_transform patch</li><li>added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s parse-transform patch</li><li>added pigment pattern (no more need for reset_children)</li><li>added cross-section texturing (cutaway_texture)</li><li>enhanced focal_blur post process to allow anti-aliasing</li><li>enhanced motion blur to include support for lights</li><li>enhanced error for post_process if no output file is used</li><li>enhanced autostop</li><li>enhanced pass_through</li><li>enhanced post-processing to write to a separate file</li><li>optimized macro speed</li><li>optimized constant scattering media for speed</li><li>optimized for speed with memory allocation caches</li><li>optimized speed for planes, discs</li><li>optimized speed for area_light</li><li>removed #create (related to persistent scene objects - use 'label' instead)</li><li>fixed height-field lockup problem</li><li>fixed bug with photons on a texture_map</li><li>fixed media method 3 brightness bug</li><li>fixed a bug in orient area_lights</li><li>fixed cylinder cameras (up and right vectors work again)</li><li>fixed some photon gathering issues</li><li>fixed continued render with post_process</li><li>fixed smooth height field double illumination 'bug'</li><li>fixed pict+post_process (Macintosh) bug</li><li>fixed media transformation bug</li><li>fixed memory leak in eval_pat</li><li>fixed radiosity crash</li><li>fixed macro bug</li><li>fixed PNG+post_process bug</li><li>fixed problem using #fread with a file containing garbage</li><li>fixed Noise (this affects wrinkles, bozo, bumps, dents, turbulence, and noise3d)</li><li>fixed some speed problems</li><li>fixed #version precision errors problems</li><li>fixed macro speed problem (for unused macros)</li><li>fixed %s error line bug</li><li>fixed the cabs2,creal, and cimg bugs</li><li>fixed DOS macro problems (read files as binary)</li><li>fixed potential crash problem</li><li>fixed bug with global ini options for image width and height</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604149"></a>6.3.1.8. January 30, 2000 - MegaPOV 0.4</h4></div><div><h5 class="subtitle">many changes, new features, and bug fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>important: MegaPOV features DISABLED by default (language version set to 3.1)  Use #version unofficial megapov 0.4; in each POV and INC file to enable the unofficial features.</li><li>important: major changes to photon mapping syntax  To convert scenes from the old photon syntax, see the Photon Conversion Guide.</li><li>important: changed isosurface bounded_by and clipped_by to contained_by</li><li>added post-processing (currently includes depth, focal_blur, and soft_glow effects)</li><li>discontinued smooth_color_triangle in mesh, but added vertex-texture interpolation to replace it</li><li>torrance-sparrow-blinn-cook (blinn) "microfacet" highlighting</li><li>Fixed the normal bug-fix again (Do I sense a pattern here?)</li><li>fixed default{} bug</li><li>added Burton Radons' fast macro patch: macros parse twice as fast or faster (over five times as fast in one of my tests)</li><li>faster rendering of mesh and mesh2 (now same speed as the official version, this is a bug fix)</li><li>added several patches from <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>: noise3, cube, sqr, ^, blob pattern, solid pattern, eval_pattern, eval_pigment, proximity pattern</li><li>chrono (stopwatch for finding parse times) and date/time string</li><li>added several patches by &#9839;: initialize i_dat3d with array, rigid multifractal isosurface function library, other isosurface changes, hyperbolic and complex number functions</li><li>added save_file and load_file to radiosity</li><li>updated statistics output for photons, motion_blur, and post-processing</li><li>added pretrace_start and pretrace_end for configuring radiosity preview</li><li>added wavelength-dependence to fresnel reflectivity (uses dispersion properties, for producing realistic metals)</li><li>fixed bug with metallic</li><li>disabled reflection_blur and dispersion in radiosity pre-trace step</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604287"></a>6.3.1.9. December 21, 1999 - MegaPOV 0.3</h4></div><div><h5 class="subtitle">updates and bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fixed the buggy normal bug-fix.</li><li>Backwards compatibility for the normal bug-fix (through #version 3.1).</li><li>Added bump_scale_off option for normals</li><li>Added conserve_energy for reflection+transmit (or filter)</li><li>integrated i_dat_3d libraries (thanks to <span class="author"><span class="surname">Smellenbergh</span></span>)</li><li>fixed bug with ini_option and width/height</li><li>fixed FRAND range problem - crashed Linux</li><li>fixed ignore_photons and media problems</li><li>fixed light_groups and media problems</li><li>added <span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span>'s object pattern patch (thanks to <span class="author"><span class="surname">Smellenbergh</span></span>)</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604420"></a>6.3.1.10. December 12, 1999 - MegaPOV 0.2</h4></div><div><h5 class="subtitle">updates and bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Normal Bug-fix (this was in 0.1, and was documented, but I forgot to announce it)</li><li>fixed isosurface all_intersections bug</li><li>removed 'system' patch (was not announced before)</li><li>updated object pattern patch</li><li>fixed vector-to-color promotion bug</li><li>updated photons - fixed interaction with no_shadow, no_image, no_reflection, and light groups</li><li>fixed memory leak in smooth_color_triangle</li><li>fixed bugs with isosurfaces (thanks to <span class="author"><span class="surname">Smellenbergh</span></span> for these fixes)</li><li>fixed spline dot-notation bug</li><li>fixed pattern-height-field bug</li><li>fixed bug with normals and radiosity</li><li>updated demos (thanks to <span class="author"><span class="surname">Smellenbergh</span></span> for these)</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604529"></a>6.3.1.11. December 9, 1999 - MegaPOV</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>UVPov is no more.  It is now called MegaPOV.   UVPov+SuperPatch+MultiPatch=MegaPOV</li><li>Integrated the SuperPatch</li><li>Integrated the MultiPatch</li><li>fixed focal_blur gamma correction problem</li><li>crackle speedup (used lots of integer math)</li><li>fixed color/vector conversion bug</li><li>fixed surface normal bugs, added 'accuracy' keyword</li><li>added persistent variables, persistent scene objects, and object labels</li><li>added motion blur</li><li>by default, radiosity will not use perturbed surface normals.  Add 'normals on' to the radiosity{} block in global_settings to enable this feature.  This feature also now is now significantly faster and better than before.</li><li>fixed a bug related to slope_map that nobody ever reported and I never noticed (but it was really there)</li><li>fixed a bug with jitter and photons</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604626"></a>6.3.1.12. November 22, 1999 - alpha 6 update (6.2)</h4></div><div><h5 class="subtitle">bug fixes, etc</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>incorporated fractal patch - completely untested</li><li>radiosity uses perturbed surface normal (bumps, wrinkles, etc)</li><li>added realistic (exponential) attenuation (use a fade_power&gt;=1000 in interior)</li><li>added ability to put both smooth and flat triangles in the same mesh2 object</li><li>fixed problem with clear objects &amp; radiosity</li><li>fixed slope_map problems</li><li>fixed bug with media type 3 brightness problem</li><li>fixed bug with layered texture backwards compatibility</li><li>fixed filter+diffuse brightness bug</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604706"></a>6.3.1.13. November 5, 1999 - alpha 6 update (6.1)</h4></div><div><h5 class="subtitle">bug fixes &amp; volumetric photons</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>fixed jitter variable default initialization bug</li><li>fixed photons on a surface with a normal bug</li><li>fixed reflection brightness bug</li><li>fixed antialias+radiosity bug</li><li>incorporated smooth triangle transformed normals bug-fix</li><li>fixed method 3 attenuation bug</li><li>fixed method 3 brightness bug</li><li>fixed number-of-samples bug in method 3 (took 2x too many samples)</li><li>limited number of keywords available to "ini_option"</li><li>changed autostop to be a percentage of the object's bounding sphere</li><li>Added volumetric photons</li><li>Demo scenes updated (now they include volumetric photons).</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604803"></a>6.3.1.14. November 1, 1999 - alpha 6 update (6.05)</h4></div><div><h5 class="subtitle">bug-fix</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fixed one of the media/photons attenuation bugs. Just a binary release. Source will be released later with more features and bug fixes.</li><li>Demo scenes available.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604840"></a>6.3.1.15. October 26, 1999 - alpha 6 release (6.0)</h4></div><div><h5 class="subtitle">Added <span class="trademark">POV-Ray</span>&#8482; 3.1g, minipatch, radiosity, media, bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Long time between updates, huh?  Well, I've got a lot of goodies here for you.</li><li>Incorporated <span class="trademark">POV-Ray</span>&#8482; 3.1g (including bug-fixes)</li><li>Photons get attenuated by absorbing/scattering media.  (No photons are deposited in media yet.)</li><li>Fixed a refract bug related to dispersion.  Rendering some glass scenes is much faster now.</li><li>Big changes to radiosity - see the radiosity section - there may be more changes, so don't get too hooked on these.  This is still experimental (comments are welcome).</li><li>Added sample method 2 and method 3 to media - great results.</li><li>Incorporated the minipatch, including spherical camera and media sample method 2.</li><li>Incorporated colored attenuation patch.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604934"></a>6.3.1.16. July 10, 1999 - alpha 5 update (5.4)</h4></div><div><h5 class="subtitle">Bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>I'm satisfied with the "#declare" changes now</li><li>Use "#version 3.1;" to use old-style layered textures (where filter acts like transmit)</li><li>Use "#version 3.14159;" (yes, PI) to use filters in textures again in the same scene.</li><li>Fixed problem with automatic range_divider calculation</li><li>Added a better error message for zero vertices in mesh2</li><li>fix bug with spotlight</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2604994"></a>6.3.1.17. June 16, 1999 - alpha 5 update (5.3 again)</h4></div><div><h5 class="subtitle">Bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>OK. This time I really did fix the parser. (I think.)</li><li>I also fixed a <tt class="function">max_trace_level</tt> bug.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605038"></a>6.3.1.18. June 12, 1999 - alpha 5 update (5.3)</h4></div><div><h5 class="subtitle">Bug-fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fixed some problems problems with "#declare" changes.</li><li>note: To make the editors work, you should put uvpov.exe in the \bin directory of the POV-Ray home directory.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605073"></a>6.3.1.19. June 9, 1999 - alpha 5 update (5.2)</h4></div><div><h5 class="subtitle"><span class="trademark">POV-Ray</span>&#8482; 3.1e editor now works</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li><span class="trademark">POV-Ray</span>&#8482; 3.1e editor now works (at least as far as I've tested it).  :-)</li><li><span class="trademark">POV-Ray</span>&#8482; 3.1a editor still works, too.</li><li>Automatic determination of range_divider (if you don't know what I'm talking about, then ignore this).</li><li>New "save_file" and "load_file" commands in global_settings{photons{ } } can save and load photon map data.</li><li>Shortcuts ($ and %) for #declare and #local (e.g.  $a=100; instead of #declare a=100;)</li><li>Some of the various changes in this version have not been well tested (specifically the changes to #declare and #local), but if there are major problems I will fix them as quickly as possible.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605161"></a>6.3.1.20. June 2, 1999 - alpha 5 update (5.1)</h4></div><div><h5 class="subtitle">area light changes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Photon mapping treats area lights like point sources by default, use "photons{area_light}" in light_source to force photon mapping to use area light settings.</li><li>Enabling area light settings for a light's photons should not cause that light to shoot more photons.</li><li>Enabling area light settings for a light's photons might add a regular pattern of spots in the caustic.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605209"></a>6.3.1.21. May 23, 1999 - alpha 5 release</h4></div><div><h5 class="subtitle">photon mapping fixes</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>More documentation and a FAQ.</li><li>Memory optimization: Uses less than half of the memory that it used to (46%).</li><li>Syntax changes: "density" switched to "separation", other changes (see documentation).</li><li>Speed optimization: Probably not noticeable</li><li>New adaptive search: New thresholds employed. Read the documentation for more information.</li><li>added <tt class="function">max_trace_level</tt> for photons</li><li>added adc_bailout for photons</li><li>ability to turn union splitting on/off on a per-object basis (use split_union yes/no in the union)</li><li>no more crashes with gather greater than 300</li><li>shouldn't crash for animation anymore</li><li>area lights work as expected</li><li>spot lights work as expected</li><li>cylinder lights DO NOT work as expected - working on that</li><li><span class="trademark">POV-Ray</span>&#8482; 3.1a high-speed lathe code is incorporated (other <span class="trademark">POV-Ray</span>&#8482; 3.1e stuff is not in here yet)</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605339"></a>6.3.1.22. March 9, 1999 - alpha 4 release</h4></div><div><h5 class="subtitle">photon mapping</h5></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Going backwards in versions: used to be beta, now it's alpha.  Actually, it's probably permanently stuck on alpha now.  ;-)  But I did increase the version number to 4.</li><li>Photon Mapping!  Render real caustics!  And yes, it's still called UVPov, but it's got a new splash screen!</li><li>Many (all?) of my bug fixes are now part of <span class="trademark">POV-Ray</span>&#8482; 3.1e  (my custom compile does not contain all of the fixes found in <span class="trademark">POV-Ray</span>&#8482; 3.1e, however)</li><li>The POV-Team is currently working to add uv mapping to POV-Ray (version 3.5)!  It will not be exactly the same as what you see here, but Chris has been talking to me about his changes to the implementation, and it's only going to get better.  :-)</li><li>New conversion program: Poser OBJ to POV converter.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605416"></a>6.3.1.23. November 24, 1998</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>Fixed a bug so memory is freed correctly and POV shouldn't crash anymore.</li><li>I call this beta "3a" but I did not rename anything in the ZIP files... just a new executable and a new copy of mesh.c in the sources.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605451"></a>6.3.1.24. November 22, 1998</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>I'm working on a new feature, parallel light rays for cylinder lights.</li><li>Change in syntax of "uv_mapping".  The old rule was that you needed to specify "uv_mapping" as the first modifier.  Now the rule is that you can only specify "uv_mapping" if the object does not yet have a texture.</li><li>Fixed uv mapping to work with CSG objects.</li><li>New website layout.</li></ol></div></div><div class="section_3" lang="en"><div xmlns="" class="titlepage"><div><div><h4 class="title"><a name="id2605498"></a>6.3.1.25. Old News</h4></div></div><div></div></div><div xmlns="" class="orderedlist"><ol type="1" compact><li>My patched version of POV is ready for download.  Get it here!</li><li>Many of these changes are also part of the SuperPatch by Ron Parker, available at Twyst's PatchStation.</li><li>The primary reason for most of these changes is to give POV-Ray the same functionality as some high-end software packages (like 3D Studio). Thomas Baier has released a 3DS-to-POV converter that works only with this version of POV-Ray. You can find out more about it at his page. This utility (which is still in beta) does an excellent job of converting 3DS scenes into POV-Ray scenes, with lights, cameras, and textures intact! It also outputs to Moray MDL/UDO formats. Note: This was designed for the POV 3.02 version of my patch, but it should work with the SuperPatch and with my new version.</li></ol></div></div></div><div class="section_2" lang="en"><div xmlns="" class="titlepage"><div><div><h3 class="title"><a name="old_authors"></a>6.3.2. Authors of patches in MegaPOV below version 1.0</h3></div></div><div></div></div><div xmlns="" class="variablelist"><dl><dt><span class="term"><span class="author"><span class="firstname">Jérôme</span> <span class="surname">Berger</span></span></span></dt><dd><p>jberger at ifrance com</p></dd><dt><span class="term">Eric Brown</span></dt><dd><p><a href="http://www.stolaf.edu/people/brownen/wwwroot_new/research/index.html" target="_top">http://www.stolaf.edu/people/brownen/wwwroot_new/research/index.html</a></p></dd><dt><span class="term">Matthew Corey Brown</span></dt><dd><p><tt class="email">&lt;<a href="mailto:mcb@xenoarch.com">mcb@xenoarch.com</a>&gt;</tt></p></dd><dt><span class="term"><span class="author"><span class="firstname">Jamis</span> <span class="surname">Buck</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:jgb3@email.byu.edu">jgb3@email.byu.edu</a>&gt;</tt></p></dd><dt><span class="term">Noel Bundy</span></dt><dd><p><tt class="email">&lt;<a href="mailto:twyst@v-wave.com">twyst@v-wave.com</a>&gt;</tt></p></dd><dt><span class="term">Phil Carrig (PoD)</span></dt><dd><p><tt class="email">&lt;<a href="mailto:pod@merlin.net.au">pod@merlin.net.au</a>&gt;</tt></p></dd><dt><span class="term">Edward Coffey</span></dt><dd><p><tt class="email">&lt;<a href="mailto:edward_coffey@hotmail.com">edward_coffey@hotmail.com</a>&gt;</tt></p></dd><dt><span class="term">Gerald K. Dobiasovsky</span></dt><dd><p>-</p></dd><dt><span class="term">Alexander Enzmann</span></dt><dd><p>-</p></dd><dt><span class="term"><span class="author"><span class="firstname">Daniel</span> <span class="surname">Fenner</span></span></span></dt><dd><p>Daniel_fenner@web.de</p></dd><dt><span class="term">Hans-Detlev Fink</span></dt><dd><p><tt class="email">&lt;<a href="mailto:hdf@pecos.de">hdf@pecos.de</a>&gt;</tt></p><p><a href="ftp://user.pecos.de/pub/povray/slope/" target="_top">ftp://user.pecos.de/pub/povray/slope/</a></p></dd><dt><span class="term"><span class="author"><span class="firstname">Jérôme</span> <span class="surname">Grimbert</span></span></span></dt><dd><p><a href="http://jgrimbert.free.fr/" target="_top">http://jgrimbert.free.fr/</a></p></dd><dt><span class="term">Mike Hough</span></dt><dd><p><tt class="email">&lt;<a href="mailto:povray3@aol.com">povray3@aol.com</a>&gt;</tt></p></dd><dt><span class="term"><span class="author"><span class="firstname">Chris</span> <span class="surname">Huff</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:chrishuff_99@yahoo.com">chrishuff_99@yahoo.com</a>&gt;</tt></p><p><a href="http://chrishuff.dhs.org/povstuff.html" target="_top">http://chrishuff.dhs.org/povstuff.html</a></p></dd><dt><span class="term"><span class="author"><span class="firstname">Nathan</span> <span class="surname">Kopp</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:Nathan@kopp.com">Nathan@kopp.com</a>&gt;</tt></p><p><a href="http://nathan.kopp.com/patched.htm" target="_top">http://nathan.kopp.com/patched.htm</a></p></dd><dt><span class="term"><span class="author"><span class="firstname">Jochen</span> <span class="surname">Lippert</span></span></span></dt><dd><p>jl@artcom-gmbh.de</p></dd><dt><span class="term">Lummox JR</span></dt><dd><p><tt class="email">&lt;<a href="mailto:LummoxJR@aol.com">LummoxJR@aol.com</a>&gt;</tt></p></dd><dt><span class="term">Nieminen Juha</span></dt><dd><p>-</p></dd><dt><span class="term"><span class="author"><span class="firstname">Wolfgang</span> <span class="surname">Ortmann</span></span></span></dt><dd><p>noo@uni-jena.de</p><p><a href="http://pandora.inf.uni-jena.de/p/e/noo/povsp/povsp.html" target="_top">http://pandora.inf.uni-jena.de/p/e/noo/povsp/povsp.html</a></p></dd><dt><span class="term">Ronald L. Parker</span></dt><dd><p><tt class="email">&lt;<a href="mailto:parkerr@mail.fwi.com">parkerr@mail.fwi.com</a>&gt;</tt></p><p><a href="http://www2.fwi.com/%7Eparkerr/traces.html#objbound#objbound" target="_top">http://www2.fwi.com/%7Eparkerr/traces.html#objbound#objbound</a></p></dd><dt><span class="term"><span class="author"><span class="surname">Philippsen</span></span></span></dt><dd><p>ansgar.philippsen at gmx net</p><p><a href="http://www.dino3d.org" target="_top">http://www.dino3d.org</a></p></dd><dt><span class="term">Burton Radons</span></dt><dd><p>-</p></dd><dt><span class="term"><span class="author"><span class="firstname">David</span> <span class="surname">Sharp</span></span></span></dt><dd><p>davidsharp@rcn.com</p><p><a href="http://www.geocities.com/hacad" target="_top">http://www.geocities.com/hacad</a></p></dd><dt><span class="term"><span class="author"><span class="firstname">Daniel</span> <span class="surname">Skarda</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:0rfelyus@ucw.cz">0rfelyus@ucw.cz</a>&gt;</tt></p><p><a href="http://atrey.karlin.mff.cuni.cz/~0rfelyus" target="_top">http://atrey.karlin.mff.cuni.cz/~0rfelyus</a></p></dd><dt><span class="term"><span class="author"><span class="firstname">Yvo &amp; René</span> <span class="surname">Smellenbergh</span></span></span></dt><dd><p><tt class="email">&lt;<a href="mailto:smellenbergh@skynet.be">smellenbergh@skynet.be</a>&gt;</tt></p><p><a href="http://users.skynet.be/smellenbergh/" target="_top">http://users.skynet.be/smellenbergh/</a></p></dd><dt><span class="term">R. Suzuki</span></dt><dd><p><a href="http://www.public.usit.net/rsuzuki/e/povray/iso/" target="_top">http://www.public.usit.net/rsuzuki/e/povray/iso/</a></p></dd><dt><span class="term">John VanSickle</span></dt><dd><p><tt class="email">&lt;<a href="mailto:vansickl@erols.com">vansickl@erols.com</a>&gt;</tt></p></dd><dt><span class="term">Mark Wagner</span></dt><dd><p><tt class="email">&lt;<a href="mailto:mark.wagner17@gte.net">mark.wagner17@gte.net</a>&gt;</tt></p></dd><dt><span class="term"><span class="author"><span class="firstname">Daren</span> <span class="othername">Scot</span> <span class="surname">Wilson</span></span></span></dt><dd><p>darenw@pipeline.com</p><p><a href="http://darenw.home.pipeline.com/" target="_top">http://darenw.home.pipeline.com/</a></p></dd></dl></div></div></div></div><div class="index"><div class="titlepage"><div><div><h2 class="title"><a name="megapov_index"></a>Index</h2></div></div><div></div></div><div class="index"><div class="indexdiv"><h3>Symbols</h3><dl><dt>#set</dt><dd><dl><dt>Reference, Language directive, <a href="#set">Set directive</a></dt></dl></dd><dt>+STP</dt><dd><dl><dt>Reference, Animation options, <a href="#frame_step">Frame_Step</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>A</h3><dl><dt>accuracy</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_step_adaptive">adaptive time stepping</a></dt></dl></dd><dt>adaptive</dt><dd><dl><dt>Reference, Adaptive radiosity pretrace, <a href="#radiosity_adaptive_pretrace">Adaptive radiosity pretrace</a></dt><dt>Reference, Radiosity adaptive error_bound, <a href="#radiosity_error_bound_adaptive">Adaptive radiosity error_bound</a></dt></dl></dd><dt>akima_spline</dt><dd><dl><dt>Reference, Splines, <a href="#akima_spline">akima spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>aoi</dt><dd><dl><dt>Reference, Angle of incidence, <a href="#aoi_pattern">Angle of incidence</a></dt></dl></dd><dt>array</dt><dd><dl><dt>Reference, Spline accessed like array, <a href="#spline_like_array">Spline accessed like array</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>attach</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_attach">Attaching masses</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>B</h3><dl><dt>basic_x_spline</dt><dd><dl><dt>Reference, Splines, <a href="#basic_x_spline">basic x spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>bicubic</dt><dd><dl><dt>Reference, Bicubic interpolation for images, <a href="#bicubic_image">Bicubic interpolation for images</a></dt></dl></dd><dt>bicubic_patch</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>blob</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>bounding</dt><dd><dl><dt>Reference, Bounding used in inside test, <a href="#inside_bounding">Bounding used in inside tests</a></dt><dt>Reference, Mechanics simulation, <a href="#mechsim_bounding">bounding</a></dt></dl></dd><dt>box</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>Brightness_Contrast</dt><dd><dl><dt>Include files, tone_mapping.inc, <a href="#id2568630">The Brightness_Contrast() macro</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>C</h3><dl><dt>camera</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>camera_view</dt><dd><dl><dt>Reference, camera_view pigment, <a href="#camera_view">New camera_view pigment</a></dt></dl></dd><dt>Clip_Colors</dt><dd><dl><dt>Include files, tone_mapping.inc, <a href="#id2567246">The Clip_Colors() macro</a></dt></dl></dd><dt>clock_delta</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>clock_on</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>collision</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_collision">The collision settings</a></dt></dl></dd><dt>color</dt><dd><dl><dt>Reference, Glow, <a href="#glow">Glow</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>color_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>cone</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>connection</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_connection">Connections</a></dt></dl></dd><dt>connection_count</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_access">Accessing simulation data</a></dt></dl></dd><dt>cubic</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>cubic_spline</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>cylinder</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>D</h3><dl><dt>damping</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_env_properties">The environment properties</a>, <a href="#mechsim_collision">The collision settings</a></dt></dl></dd><dt>density</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>density_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>difference</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>diffuse</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>dimension_size</dt><dd><dl><dt>Reference, Dimensions of vectors, <a href="#vectors_dimensions">Dimensions of vectors</a></dt><dt>Reference, Spline accessed like array, <a href="#spline_like_array">Spline accessed like array</a></dt></dl></dd><dt>disc</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>displace</dt><dd><dl><dt>Reference, Displace warp, <a href="#displace_warp">Displace warp for patterns</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>E</h3><dl><dt>end_time</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_stepping">simulation stepping</a></dt></dl></dd><dt>environment</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_environment">The environments</a></dt></dl></dd><dt>environment map</dt><dd><dl><dt>Reference, HDR image type, <a href="#hdr">HDR (High Dynamic Range) image type</a></dt></dl></dd><dt>error_bound</dt><dd><dl><dt>Reference, Radiosity adaptive error_bound, <a href="#radiosity_error_bound_adaptive">Adaptive radiosity error_bound</a></dt></dl></dd><dt>exposure</dt><dd><dl><dt>Reference, Film exposure simulation, <a href="#film_exposure">Film exposure simulation</a></dt></dl></dd><dt>exposure_gain</dt><dd><dl><dt>Reference, Film exposure simulation, <a href="#film_exposure">Film exposure simulation</a></dt></dl></dd><dt>extended_x_spline</dt><dd><dl><dt>Reference, Splines, <a href="#extended_x_spline">extended x spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>F</h3><dl><dt>face</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_face">Faces</a></dt></dl></dd><dt>face_count</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_access">Accessing simulation data</a></dt></dl></dd><dt>fade_power</dt><dd><dl><dt>Reference, Glow, <a href="#glow">Glow</a></dt></dl></dd><dt>falloff</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>false</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>field</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_field">Field forces</a></dt></dl></dd><dt>Film_Exposure</dt><dd><dl><dt>Include files, tone_mapping.inc, <a href="#id2568434">The Film_Exposure() macro</a></dt></dl></dd><dt>Film_Exposure_Invert</dt><dd><dl><dt>Include files, tone_mapping.inc, <a href="#id2568502">The Film_Exposure_Invert() macro</a></dt></dl></dd><dt>final_clock</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>final_frame</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>finish</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>fisheye</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>fixed</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_fixed">global fixation</a></dt></dl></dd><dt>float</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>fn_Stress_CM</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>fog</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>force</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>frame_number</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>frame_step</dt><dd><dl><dt>Reference, Animation options, <a href="#frame_step">Frame_Step</a></dt><dt>Reference, frame_step built-in token, <a href="#frame_step_token">frame_step key-word</a></dt></dl></dd><dt>frequency</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>friction</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_env_properties">The environment properties</a>, <a href="#mechsim_collision">The collision settings</a></dt></dl></dd><dt>function</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>f_triangle</dt><dd><dl><dt>Reference, Internal functions, <a href="#f_triangle">f_triangle</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>G</h3><dl><dt>Gamma_Correct</dt><dd><dl><dt>Include files, tone_mapping.inc, <a href="#id2568567">The Gamma_Correct() macro</a></dt></dl></dd><dt>general_x_spline</dt><dd><dl><dt>Reference, Splines, <a href="#general_x_spline">general x spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>gravity</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_gravity">gravity</a></dt></dl></dd><dt>group</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_group">grouping elements</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>H</h3><dl><dt>hdr</dt><dd><dl><dt>Reference, HDR image output, <a href="#hdr_write">HDR (High Dynamic Range) image output</a></dt><dt>Reference, HDR image type, <a href="#hdr">HDR (High Dynamic Range) image type</a></dt></dl></dd><dt>hdri</dt><dd><dl><dt>Reference, HDR image type, <a href="#hdr">HDR (High Dynamic Range) image type</a></dt></dl></dd><dt>height_field</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>high dynamic range</dt><dd><dl><dt>Reference, HDR image output, <a href="#hdr_write">HDR (High Dynamic Range) image output</a></dt><dt>Reference, HDR image type, <a href="#hdr">HDR (High Dynamic Range) image type</a></dt></dl></dd><dt>h_align_center</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd><dt>h_align_left</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd><dt>h_align_right</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>I</h3><dl><dt>image_height</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt><dt>Reference, Sizes of images, <a href="#images_sizes">Sizes of images</a></dt></dl></dd><dt>image_width</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt><dt>Reference, Sizes of images, <a href="#images_sizes">Sizes of images</a></dt></dl></dd><dt>initial_clock</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>initial_frame</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>interaction</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_interaction">Mass interaction</a></dt></dl></dd><dt>interior</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>intersection</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>is</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>isosurface</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>J</h3><dl><dt>julia_fractal</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>L</h3><dl><dt>lathe</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>light_source</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>linear_spline</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>listed</dt><dd><dl><dt>Reference, Listed pattern, <a href="#listed_pattern">Listed pattern</a></dt></dl></dd><dt>load_file</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_save_load">saving and loading topology data</a>, <a href="#mechsim_file">The simulation data file format</a></dt></dl></dd><dt>location</dt><dd><dl><dt>Reference, Glow, <a href="#glow">Glow</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>M</h3><dl><dt>mass</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_mass">Point masses</a></dt></dl></dd><dt>mass_count</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_access">Accessing simulation data</a></dt></dl></dd><dt>material</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>max_trace_level</dt><dd><dl><dt>Reference, area light max_trace_level, <a href="#area_light_mtl">Area Light max_trace_level</a></dt></dl></dd><dt>mechsim</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_settings">The simulation settings</a>, <a href="#mechsim_access">Accessing simulation data</a></dt></dl></dd><dt>MECHSIM_COLLISION_ALL</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_BOUNDING_AUTO</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_BOUNDING_BOX</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_BOUNDING_HASH</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_BOUNDING_NO</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_GROUP</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_COLLISION_NONE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_ENV_METHOD_FORCE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_ENV_METHOD_IMPACT</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MechSim_Generate_Block</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Block">MechSim_Generate_Block()</a></dt></dl></dd><dt>MechSim_Generate_Block_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Block_VE">MechSim_Generate_Block_VE()</a></dt></dl></dd><dt>MechSim_Generate_Box</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Box">MechSim_Generate_Box()</a></dt></dl></dd><dt>MechSim_Generate_Box_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Box_VE">MechSim_Generate_Box_VE()</a></dt></dl></dd><dt>MechSim_Generate_Grid</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid">MechSim_Generate_Grid()</a></dt></dl></dd><dt>MechSim_Generate_Grid_Fn</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid_Fn">MechSim_Generate_Grid_Fn()</a></dt></dl></dd><dt>MechSim_Generate_Grid_Fn_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid_Fn_VE">MechSim_Generate_Grid_Fn_VE()</a></dt></dl></dd><dt>MechSim_Generate_Grid_Std</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid_Std">MechSim_Generate_Grid_Std()</a></dt></dl></dd><dt>MechSim_Generate_Grid_Std_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid_Std_VE">MechSim_Generate_Grid_Std_VE()</a></dt></dl></dd><dt>MechSim_Generate_Grid_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Grid_VE">MechSim_Generate_Grid_VE()</a></dt></dl></dd><dt>MechSim_Generate_Line</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Line">MechSim_Generate_Line()</a></dt></dl></dd><dt>MechSim_Generate_Line_Std</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Line_Std">MechSim_Generate_Line_Std()</a></dt></dl></dd><dt>MechSim_Generate_Patch</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Patch">MechSim_Generate_Patch()</a></dt></dl></dd><dt>MechSim_Generate_Patch_Std</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Patch_Std">MechSim_Generate_Patch_Std()</a></dt></dl></dd><dt>MechSim_Generate_Patch_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Patch_VE">MechSim_Generate_Patch_VE()</a></dt></dl></dd><dt>MechSim_Generate_Sphere</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Generate_Sphere">MechSim_Generate_Sphere()</a></dt></dl></dd><dt>MECHSIM_METHOD_EULER</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_METHOD_GRADIENT</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_METHOD_HEUN</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MECHSIM_METHOD_RUNGE_KUTTA4</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_const">constants</a></dt></dl></dd><dt>MechSim_Show_All_Default</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_All_Default">MechSim_Show_All_Default()</a></dt></dl></dd><dt>MechSim_Show_All_Objects</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_All_Objects">MechSim_Show_All_Objects()</a></dt></dl></dd><dt>MechSim_Show_Con</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Con">MechSim_Show_Con()</a></dt></dl></dd><dt>MechSim_Show_Con_VE</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Con_VE">MechSim_Show_Con_VE()</a></dt></dl></dd><dt>MechSim_Show_Grid</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Grid">MechSim_Show_Grid()</a></dt></dl></dd><dt>MechSim_Show_Objects</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Objects">MechSim_Show_Objects()</a></dt></dl></dd><dt>MechSim_Show_Patch</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Patch">MechSim_Show_Patch()</a></dt></dl></dd><dt>MechSim_Show_Sphere</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_MechSim_Show_Sphere">MechSim_Show_Sphere()</a></dt></dl></dd><dt>media</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>merge</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>mesh</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>mesh2</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>message</dt><dd><dl><dt>Reference, Isosurface, <a href="#iso_message">Control of max gradient message</a></dt></dl></dd><dt>method</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_method">method</a>, <a href="#mechsim_env_method">The environment calculation method</a></dt></dl></dd><dt>motion_blur</dt><dd><dl><dt>Reference, Motion blur, <a href="#motion_blur">Motion blur</a></dt></dl></dd><dt>MSim_File_Decimals</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>MSIM_INCLUDE_VERSION</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>MSim_Test_Render</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>MSim_Tex_C</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>MSim_Tex_Mesh</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>MSim_Tex_N</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>N</h3><dl><dt>natural_spline</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>no</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>noise pigment</dt><dd><dl><dt>Reference, Noise pigment, <a href="#noisepigment">Noise pigment</a></dt></dl></dd><dt>normal</dt><dd><dl><dt>Reference, Transforms, Normal modifier, <a href="#normal_transform">The normal modifier for transforms</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>normal_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>No_Attach</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>No_Fixed</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>No_Force</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>No_Trans</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_general">general aspects</a></dt></dl></dd><dt>nth_root</dt><dd><dl><dt>Reference, Polynomial solver, <a href="#polynomial_solver">Polynomial solver in parser</a></dt></dl></dd><dt>n_roots</dt><dd><dl><dt>Reference, Polynomial solver, <a href="#polynomial_solver">Polynomial solver in parser</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>O</h3><dl><dt>object</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>off</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>omnimax</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>on</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>orthographic</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>output</dt><dd><dl><dt>Reference, camera_view pigment, <a href="#camera_view">New camera_view pigment</a></dt></dl></dd><dt>output_filename</dt><dd><dl><dt>Reference, Filename with frame number, <a href="#output_filename">Filename with frame number</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>P</h3><dl><dt>panoramic</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>parametric</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>perspective</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>pigment</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>pigment_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>plane</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>poly</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>polygon</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>pretrace</dt><dd><dl><dt>Reference, Adaptive radiosity pretrace, <a href="#radiosity_adaptive_pretrace">Adaptive radiosity pretrace</a></dt></dl></dd><dt>prism</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>projection_pattern</dt><dd><dl><dt>Reference, Projection pattern, <a href="#projection_pattern">Projection pattern</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>Q</h3><dl><dt>quadratic_spline</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>quadric</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>quartic</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>R</h3><dl><dt>radiosity</dt><dd><dl><dt>Reference, Adaptive radiosity pretrace, <a href="#radiosity_adaptive_pretrace">Adaptive radiosity pretrace</a></dt><dt>Reference, Additional radiosity statistics, <a href="#radiosity_additional_statistics">Additional radiosity statistics</a></dt><dt>Reference, Radiosity adaptive error_bound, <a href="#radiosity_error_bound_adaptive">Adaptive radiosity error_bound</a></dt><dt>Reference, Radiosity cache, <a href="#radiosity_cache">Cache file</a></dt><dt>Reference, Radiosity sampling, <a href="#radiosity_samples">Custom radiosity sampling directions</a></dt><dt>Reference, Radiosity sampling randomization, <a href="#radiosity_randomize">Randomized radiosity sampling directions</a></dt><dt>Reference, Radiosity visualizations, <a href="#radiosity_visualize">Radiosity visualizations</a></dt></dl></dd><dt>radius</dt><dd><dl><dt>Reference, Glow, <a href="#glow">Glow</a></dt></dl></dd><dt>rainbow</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>randomize</dt><dd><dl><dt>Reference, Radiosity sampling randomization, <a href="#radiosity_randomize">Randomized radiosity sampling directions</a></dt></dl></dd><dt>ratio</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>reflection</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>reflection_exponent</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>S</h3><dl><dt>samples</dt><dd><dl><dt>Reference, Radiosity sampling, <a href="#radiosity_samples">Custom radiosity sampling directions</a></dt></dl></dd><dt>save_file</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topo_save_load">saving and loading topology data</a>, <a href="#mechsim_file">The simulation data file format</a></dt></dl></dd><dt>scattering</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>show_low_count</dt><dd><dl><dt>Reference, Radiosity visualizations, <a href="#radiosity_visualize">Radiosity visualizations</a></dt></dl></dd><dt>show_samples</dt><dd><dl><dt>Reference, Radiosity visualizations, <a href="#radiosity_visualize">Radiosity visualizations</a></dt></dl></dd><dt>size</dt><dd><dl><dt>Reference, Glow, <a href="#glow">Glow</a></dt></dl></dd><dt>sky_sphere</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>slope_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>smooth_triangle</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>sor</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>sor_spline</dt><dd><dl><dt>Reference, Splines, <a href="#sor_spline">spline follows sor</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>source</dt><dd><dl><dt>The POV-Ray source code, <a href="#sources">Sources</a></dt></dl></dd><dt>source files</dt><dd><dl><dt>The POV-Ray source structure, <a href="#architecture">Understanding the POV-Ray source structure</a></dt></dl></dd><dt>sphere</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>sphere_sweep</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>spherical</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>spline</dt><dd><dl><dt>Reference, akima_spline, <a href="#akima_spline">akima spline</a></dt><dt>Reference, basic_x_spline, <a href="#basic_x_spline">basic x spline</a></dt><dt>Reference, extended_x_spline, <a href="#extended_x_spline">extended x spline</a></dt><dt>Reference, general_x_spline, <a href="#general_x_spline">general x spline</a></dt><dt>Reference, SOR_spline, <a href="#sor_spline">spline follows sor</a></dt><dt>Reference, Spline accessed like array, <a href="#spline_like_array">Spline accessed like array</a></dt><dt>Reference, tcb_spline, <a href="#tcb_spline">tcb spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>start_time</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_stepping">simulation stepping</a></dt></dl></dd><dt>statistics</dt><dd><dl><dt>Reference, Additional radiosity statistics, <a href="#radiosity_additional_statistics">Additional radiosity statistics</a></dt></dl></dd><dt>step_count</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_stepping">simulation stepping</a></dt></dl></dd><dt>stiffness</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_env_properties">The environment properties</a>, <a href="#mechsim_collision">The collision settings</a></dt></dl></dd><dt>string</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>structure</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd><dt>superellipsoid</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>T</h3><dl><dt>tcb_spline</dt><dd><dl><dt>Reference, Splines, <a href="#tcb_spline">tcb spline</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>text</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>texture</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>texture_map</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>time</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_stepping">simulation stepping</a></dt></dl></dd><dt>time_step</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_stepping">simulation stepping</a></dt></dl></dd><dt>tone_mapping</dt><dd><dl><dt>Reference, Custom tone mapping function, <a href="#tone_mapping">Custom tone mapping function</a></dt></dl></dd><dt>topology</dt><dd><dl><dt>Reference, Mechanics simulation, <a href="#mechsim_topology">The topology</a></dt></dl></dd><dt>torus</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>transform</dt><dd><dl><dt>Reference, Transforms, Normal modifier, <a href="#normal_transform">The normal modifier for transforms</a></dt><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>triangle</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>true</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>type</dt><dd><dl><dt>Reference, Displace warp, <a href="#displace_warp">Displace warp for patterns</a></dt><dt>Reference, Glow, <a href="#glow">Glow</a></dt><dt>Reference, Motion blur, <a href="#motion_blur">Motion blur</a></dt></dl></dd><dt>Type_Of</dt><dd><dl><dt>Include files, mp_types.inc, <a href="#id2553742">The Type_Of(Id) macro</a></dt></dl></dd><dt>Type_Of_Camera</dt><dd><dl><dt>Include files, mp_types.inc, <a href="#id2555156">The Type_Of_Camera(Id) macro</a></dt></dl></dd><dt>Type_Of_Object</dt><dd><dl><dt>Include files, mp_types.inc, <a href="#id2555084">The Type_Of_Object(Id) macro</a></dt></dl></dd><dt>Type_Of_Spline</dt><dd><dl><dt>Include files, mp_types.inc, <a href="#id2555017">The Type_Of_Spline(Id) macro</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>U</h3><dl><dt>ultra_wide_angle</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>union</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>user_defined</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt><dt>Reference, user_defined camera type, <a href="#user_defined_camera">user_defined camera type</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>V</h3><dl><dt>vector</dt><dd><dl><dt>Reference, Type checking, <a href="#is">Type checking</a></dt></dl></dd><dt>Vector_Function</dt><dd><dl><dt>Include files, mechsim.inc, <a href="#mechsim_inc_vector_function">The Vector_Function() macro</a></dt></dl></dd><dt>version</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd><dt>v_align_bottom</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd><dt>v_align_center</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd><dt>v_align_top</dt><dd><dl><dt>Reference, Text enhancements, <a href="#text_align">Text enhancements</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>W</h3><dl><dt>waves</dt><dd><dl><dt>Reference, Fur, <a href="#fur">Fur</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>Y</h3><dl><dt>yes</dt><dd><dl><dt>Reference, Built-in tokens, <a href="#additional_tokens">Additional tokens in function syntax</a></dt></dl></dd></dl></div></div></div></div></body></html>
